(function(e,t){typeof define=="function"&&define.amd?define(["d3","../layout/Grid","./HipieDDLMixin"],t):e.marshaller_HTML=t(e.d3,e.layout_Grid,e.marshaller_HipieDDLMixin)})(this,function(e,t,n){function r(){t.call(this),n.call(this),this.surfacePadding(0)}return r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.prototype.mixin(n),r.prototype._class+=" marshaller_HTML",r.prototype.populateContent=function(){var e=0,t=0,n=this.cellDensity();for(var r in this._ddlDashboards){var i=Math.floor(Math.sqrt(this._ddlDashboards[r].visualizations.length));this._ddlDashboards[r].visualizations.forEach(function(r){if(r.newWidgetSurface){while(this.getCell(e*n,t*n)!==null)t++,t%i===0&&(e++,t=0);this.setContent(e,t,r.newWidgetSurface)}},this)}var s={};this.content().forEach(function(e){var t=e.widget();t&&t.classID()==="layout_Surface"&&(t=t.widget()),t&&(s[t.id()]=e)});for(r in this._ddlDashboards)this._ddlDashboards[r].visualizations.forEach(function(e,t){if(e.properties.flyout||e.parentVisualization)return;var n=e.events.getUpdatesVisualizations(),r=n.filter(function(e){return s[e.id]}).map(function(e){return s[e.id].id()});s[e.id].indicateTheseIds(r)})},r.prototype.enter=function(e,n){t.prototype.enter.apply(this,arguments)},r.prototype.render=function(e){return this._marshallerRender(t.prototype,e),this},r.prototype.commsError=function(e,t){alert("Comms Error:\n"+e+"\n"+t)},r});