!function(t,o){"function"==typeof define&&define.amd?define(["d3","../common/CanvasWidget","../common/Icon","../common/TextBox"],o):t.graph_VertexC=o(t.d3,t.common_CanvasWidget,t.common_Icon,t.common_TextBox)}(this,function(t,o,e,i){function l(){o.call(this),this.poly_arr=[],this._icon=new e,this._textBox=new i,this._annotationWidgets={}}return l.prototype=Object.create(o.prototype),l.prototype.constructor=l,l.prototype._class+=" graph_VertexC",l.prototype.publishProxy("faChar","_icon"),l.prototype.publishProxy("imageUrl","_icon"),l.prototype.publishProxy("icon_shape_diameter","_icon","diameter"),l.prototype.publishProxy("icon_shape_colorFill","_icon","shape_colorFill"),l.prototype.publishProxy("icon_shape_colorStroke","_icon","shape_colorStroke"),l.prototype.publishProxy("icon_image_colorFill","_icon","image_colorFill"),l.prototype.publish("centroid",!1,"boolean","Centroid Vertex"),l.prototype.publishProxy("text","_textBox"),l.prototype.publishProxy("anchor","_textBox"),l.prototype.publishProxy("textbox_shape_colorStroke","_textBox","shape_colorStroke"),l.prototype.publishProxy("textbox_shape_colorFill","_textBox","shape_colorFill"),l.prototype.publishProxy("textbox_text_colorFill","_textBox","text_colorFill"),l.prototype.publish("iconAnchor","start","set","Icon Anchor Position",["","start","middle","end"],{tags:["Basic"]}),l.prototype.publish("tooltip","","string","Tooltip",null,{tags:["Private"]}),l.prototype.publish("iconTooltip","","string","iconTooltip",null,{tags:["Private"]}),l.prototype.publish("annotationDiameter",14,"number","Annotation Diameter",null,{tags:["Private"]}),l.prototype.publish("annotationSpacing",3,"number","Annotation Spacing",null,{tags:["Private"]}),l.prototype.publish("annotationIcons",[],"array","Annotations",null,{tags:["Private"]}),l.prototype.drawOriginalLayout=function(t,o){},l.prototype.drawCenteredLayout=function(t,o){},l.prototype.drawKeyLayout=function(t,o){function e(o){var e={vertex:n,tooltip:n.iconTooltip()},i=f,l=r-i,p=a-f/2;t.font=c+"px "+_,t.beginPath(),t.font=c+"px "+_,t.rect(l-g,p,i,f),n.poly_arr.push([l-g,p,i,f,e]),t.strokeStyle=n.icon_shape_colorStroke()?n.icon_shape_colorStroke():"#777",t.stroke(),t.fillStyle=n.icon_shape_colorFill()?n.icon_shape_colorFill():"#fff",t.fill(),t.fillStyle=n.icon_image_colorFill()?n.icon_image_colorFill():"#fff",t.textAlign="center",t.fillText(o,l+i/2-g,p+h+y),t.closePath(),n.update_x_minmax(l),n.update_x_minmax(l+i),n.update_y_minmax(p),n.update_y_minmax(p+f)}function i(o){var e={vertex:n,tooltip:n.tooltip()},i=r,l=a-f/2;t.beginPath(),t.strokeStyle=n.textbox_shape_colorStroke()?n.textbox_shape_colorStroke():"#777",t.font=x+"px "+s,u=t.measureText(o).width,b=r-f+(f+u)/2,g=b-r,t.rect(i-g,l,u+2*h,m),n.poly_arr.push([i-g,l,u+2*h,m,e]),t.fillStyle=n.textbox_shape_colorFill()?n.textbox_shape_colorFill():"#fff",t.fill(),t.fillStyle=n.textbox_text_colorFill()?n.textbox_text_colorFill():"#000",t.textAlign="left",t.fillText(o,i+h-g,l+h),t.stroke(),t.closePath(),n.update_x_minmax(i),n.update_x_minmax(i+u+2*h),n.update_y_minmax(l),n.update_y_minmax(l+m)}function l(){var o=r+u+2*h-d,e=a,i=0;t.textAlign="left",t.font=x+"px FontAwesome",n.annotationIcons().forEach(function(l){var r={vertex:n,tooltip:l.tooltip,direction:"down"};t.font=x+"px "+l.font,t.beginPath(),t.strokeStyle="#777",t.rect(o-i-g,e,d,d),n.poly_arr.push([o-i-g,e,d,d,r]),t.stroke(),t.fillStyle=l.shape_colorFill?l.shape_colorFill:"#fff",t.fill(),t.fillStyle=l.image_colorFill?l.image_colorFill:"#000",t.fillText(l.faChar,o-i+h-g,e+h),t.closePath(),i+=d})}var n=this,r=this.x(),a=this.y(),p=1,s="Arial",_="FontAwesome",x=12*p,c=2*x,h=x/4,y=h,u=0,m=x+2*h,f=2*m,d=m,b=0,g=0;this.min_x=r,this.max_x=r,this.min_y=a,this.max_y=a,t.textBaseline="top",i(this.text()),e(this.faChar()),l(),this.size({height:this.max_y-this.min_y,width:this.max_x-this.min_x})},l.prototype.drawPolyTooltip=function(t,o){function e(t,e,i,l){o.textBaseline="bottom";var n=14;o.font=n+"px Arial";var r=4,a=o.measureText(i).width,p=16,s=10,_=a+2*r,x=n+2*r;l&&(s*=-1,x*=-1),o.fillStyle="#000",o.beginPath(),o.moveTo(t,e),o.lineTo(t-p/2,e-s),o.lineTo(t-_/2,e-s),o.lineTo(t-_/2,e-(s+x)),o.lineTo(t+_/2,e-(s+x)),o.lineTo(t+_/2,e-s),o.lineTo(t+p/2,e-s),o.lineTo(t,e),o.closePath(),o.fill(),o.fillStyle="#FFF",l?o.fillText(i,t-_/2+r,e-s+r+n):o.fillText(i,t-_/2+r,e-s-r)}if(t[4].tooltip){var i=t[0]+t[2]/2,l=t[1]+t[3]/2,n=t[4].direction?t[4].direction:"up";switch(n){case"up":e(i,l,t[4].tooltip);break;case"down":e(i,l,t[4].tooltip,!0)}}},l.prototype.drawSelf=function(t,o){this.poly_arr=[],this.drawKeyLayout(t,o)},l.prototype.getHoveredPolygons=function(t,o){return this.poly_arr.filter(function(e){var i=t>e[0]&&t<e[0]+e[2],l=o>e[1]&&o<e[1]+e[3];return i&&l})},l.prototype.update_x_minmax=function(t){this.min_x>t&&(this.min_x=t),this.max_x<t&&(this.max_x=t)},l.prototype.update_y_minmax=function(t){this.min_y>t&&(this.min_y=t),this.max_y<t&&(this.max_y=t)},l.prototype.getBBox=function(){return this.size()},l});