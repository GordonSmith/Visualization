!function(t,o){"function"==typeof define&&define.amd?define(["d3","../common/CanvasWidget","../common/Icon","../common/TextBox"],o):t.graph_VertexC=o(t.d3,t.common_CanvasWidget,t.common_Icon,t.common_TextBox)}(this,function(t,o,i,e){function l(){o.call(this),this.poly_arr=[],this._icon=new i,this._textBox=new e,this._annotationWidgets={}}return l.prototype=Object.create(o.prototype),l.prototype.constructor=l,l.prototype._class+=" graph_VertexC",l.prototype.publishProxy("faChar","_icon"),l.prototype.publishProxy("imageUrl","_icon"),l.prototype.publishProxy("icon_shape_diameter","_icon","diameter"),l.prototype.publishProxy("icon_shape_colorFill","_icon","shape_colorFill"),l.prototype.publishProxy("icon_shape_colorStroke","_icon","shape_colorStroke"),l.prototype.publishProxy("icon_image_colorFill","_icon","image_colorFill"),l.prototype.publish("centroid",!1,"boolean","Centroid Vertex"),l.prototype.publishProxy("text","_textBox"),l.prototype.publishProxy("anchor","_textBox"),l.prototype.publishProxy("textbox_shape_colorStroke","_textBox","shape_colorStroke"),l.prototype.publishProxy("textbox_shape_colorFill","_textBox","shape_colorFill"),l.prototype.publishProxy("textbox_text_colorFill","_textBox","text_colorFill"),l.prototype.publish("iconAnchor","start","set","Icon Anchor Position",["","start","middle","end"],{tags:["Basic"]}),l.prototype.publish("tooltip","","string","Tooltip",null,{tags:["Private"]}),l.prototype.publish("iconTooltip","","string","iconTooltip",null,{tags:["Private"]}),l.prototype.publish("annotationDiameter",14,"number","Annotation Diameter",null,{tags:["Private"]}),l.prototype.publish("annotationSpacing",3,"number","Annotation Spacing",null,{tags:["Private"]}),l.prototype.publish("annotationIcons",[],"array","Annotations",null,{tags:["Private"]}),l.prototype.drawOriginalLayout=function(t,o){},l.prototype.drawCenteredLayout=function(t,o){},l.prototype.drawKeyLayout=function(t,o){function i(o){var i={vertex:n,tooltip:n.iconTooltip()},e=f,l=r-e,p=a-f/2;t.font=x+"px "+_,t.beginPath(),t.font=x+"px "+_,t.rect(l-g,p,e,f),n.poly_arr.push([l-g,p,e,f,i]),t.strokeStyle=n.icon_shape_colorStroke()?n.icon_shape_colorStroke():"#777",t.stroke(),t.fillStyle=n.icon_shape_colorFill()?n.icon_shape_colorFill():"#fff",t.fill(),t.fillStyle=n.icon_image_colorFill()?n.icon_image_colorFill():"#fff",t.textAlign="center",t.fillText(o,l+e/2-g,p+h+y),t.closePath(),n.update_x_minmax(l),n.update_x_minmax(l+e),n.update_y_minmax(p),n.update_y_minmax(p+f)}function e(o){var i={vertex:n,tooltip:n.tooltip()},e=r,l=a-f/2;t.beginPath(),t.strokeStyle=n.textbox_shape_colorStroke()?n.textbox_shape_colorStroke():"#777",t.font=c+"px "+s,u=t.measureText(o).width,b=r-f+(f+u)/2,g=b-r,t.rect(e-g,l,u+2*h,m),n.poly_arr.push([e-g,l,u+2*h,m,i]),t.fillStyle=n.textbox_shape_colorFill()?n.textbox_shape_colorFill():"#fff",t.fill(),t.fillStyle=n.textbox_text_colorFill()?n.textbox_text_colorFill():"#000",t.textAlign="left",t.fillText(o,e+h-g,l+h),t.stroke(),t.closePath(),n.update_x_minmax(e),n.update_x_minmax(e+u+2*h),n.update_y_minmax(l),n.update_y_minmax(l+m)}function l(){var o=r+u+2*h-d,i=a,e=0;t.textAlign="left",n.annotationIcons().forEach(function(l){var r={vertex:n,tooltip:l.tooltip,direction:"down"};t.font=c+"px "+l.font,t.beginPath(),t.strokeStyle="#777",t.rect(o-e-g,i,d,d),n.poly_arr.push([o-e-g,i,d,d,r]),t.stroke(),t.fillStyle=l.shape_colorFill?l.shape_colorFill:"#fff",t.fill(),t.fillStyle=l.image_colorFill?l.image_colorFill:"#000",t.fillText(l.faChar,o-e+h-g,i+h),t.closePath(),e+=d})}var n=this,r=this.x(),a=this.y(),p=1,s="Arial",_="FontAwesome",c=12*p,x=2*c,h=c/4,y=h,u=0,m=c+2*h,f=2*m,d=m,b=0,g=0;this.min_x=r,this.max_x=r,this.min_y=a,this.max_y=a,t.textBaseline="top",e(this.text()),i(this.faChar()),l(),this.size({height:this.max_y-this.min_y,width:this.max_x-this.min_x})},l.prototype.drawPolyTooltip=function(t,o){function i(t,i,e,l){o.textBaseline="bottom";var n=14;o.font=n+"px Arial";var r=4,a=o.measureText(e).width,p=16,s=10,_=a+2*r,c=n+2*r;l&&(s*=-1,c*=-1),o.fillStyle="#000",o.beginPath(),o.moveTo(t,i),o.lineTo(t-p/2,i-s),o.lineTo(t-_/2,i-s),o.lineTo(t-_/2,i-(s+c)),o.lineTo(t+_/2,i-(s+c)),o.lineTo(t+_/2,i-s),o.lineTo(t+p/2,i-s),o.lineTo(t,i),o.closePath(),o.fill(),o.fillStyle="#FFF",l?o.fillText(e,t-_/2+r,i-s+r+n):o.fillText(e,t-_/2+r,i-s-r)}if(t[4].tooltip){var e=t[0]+t[2]/2,l=t[1]+t[3]/2,n=t[4].direction?t[4].direction:"up";switch(n){case"up":i(e,l,t[4].tooltip);break;case"down":i(e,l,t[4].tooltip,!0)}}},l.prototype.drawSelf=function(t,o){this.poly_arr=[],this.drawKeyLayout(t,o)},l.prototype.getHoveredPolygons=function(t,o){return this.poly_arr.filter(function(i){var e=t>i[0]&&t<i[0]+i[2],l=o>i[1]&&o<i[1]+i[3];return e&&l})},l.prototype.update_x_minmax=function(t){this.min_x>t&&(this.min_x=t),this.max_x<t&&(this.max_x=t)},l.prototype.update_y_minmax=function(t){this.min_y>t&&(this.min_y=t),this.max_y<t&&(this.max_y=t)},l.prototype.getBBox=function(){return this.size()},l});