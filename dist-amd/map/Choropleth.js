!function(t,e){"function"==typeof define&&define.amd?define(["d3","topojson","./Layer","../common/Palette","css!./Choropleth"],e):t.map_Choropleth=e(t.d3,t.topojson,t.map_Layer,t.common_Palette)}(this,function(t,e,o,a){function i(){o.call(this),this._dataMap={},this._path=t.select(null)}return i.prototype=Object.create(o.prototype),i.prototype.constructor=i,i.prototype._class+=" map_Choropleth",i.prototype._palette=a.rainbow("default"),i.prototype.publish("paletteID","YlOrRd","set","Palette ID",i.prototype._palette["switch"](),{tags:["Basic","Shared"]}),i.prototype.publish("useClonedPalette",!1,"boolean","Enable or disable using a cloned palette",null,{tags:["Intermediate","Shared"]}),i.prototype.publish("opacity",1,"number","Opacity",null,{tags:["Advanced"]}),i.prototype.publish("meshVisible",!0,"boolean","Mesh Visibility"),i.prototype.publish("meshColor",null,"html-color","Stroke Color",null,{optional:!0}),i.prototype.publish("meshStrokeWidth",.25,"number","Stroke Width"),i.prototype.publish("internalOnly",!1,"boolean","Internal mesh only"),i.prototype.publish("autoScaleMode","mesh","set","Auto Scale",["none","mesh","data"],{tags:["Basic"],override:!0}),i.prototype.data=function(t){var e=o.prototype.data.apply(this,arguments);if(arguments.length){this._dataMap={},this._dataMinWeight=null,this._dataMaxWeight=null;var a=this;this.data().forEach(function(t){a._dataMap[t[0]]=t,(!a._dataMinWeight||t[1]<a._dataMinWeight)&&(a._dataMinWeight=t[1]),(!a._dataMaxWeight||t[1]>a._dataMaxWeight)&&(a._dataMaxWeight=t[1])})}return e},i.prototype.getDataBounds=function(){var t=this._choroplethData.node().getBBox(),e={x:t.x,y:t.y,width:t.width,height:t.height},o=this._zoom.scale();e.x*=o,e.y*=o,e.width*=o,e.height*=o;var a=this._zoom.translate();return e.x+=a[0],e.y+=a[1],e},i.prototype.autoScale=function(){switch(this.autoScaleMode()){case"none":return;case"mesh":this.shrinkToFit(this.getBounds());break;case"data":this.shrinkToFit(this.getDataBounds())}},i.prototype.layerEnter=function(t,e,a){o.prototype.layerEnter.apply(this,arguments),this._choroplethTransform=e,this._choroplethData=this._choroplethTransform.append("g"),this._choropleth=this._choroplethTransform.append("path").attr("class","mesh")},i.prototype.layerUpdate=function(t,a){return o.prototype.layerUpdate.apply(this,arguments),this._palette=this._palette["switch"](this.paletteID()),this.useClonedPalette()&&(this._palette=this._palette.cloneNotExists(this.paletteID()+"_"+this.id())),this.visible()&&this.meshVisible()?((a||this._prevProjection!==t.projection()||this._prevInternalOnly!==this.internalOnly())&&(this._choropleth.attr("d",t._d3GeoPath(e.mesh(this._choroTopology,this._choroTopologyObjects,this.internalOnly()?function(t,e){return t!==e}:function(t,e){return!0}))),this._prevProjection=t.projection(),this._prevInternalOnly=this.internalOnly()),void this._choroplethTransform.style("opacity",this.opacity()).style("stroke",this.meshColor())):(this._choropleth.attr("d",""),void delete this._prevProjection)},i.prototype.layerExit=function(t){delete this._prevProjection,delete this._prevInternalOnly},i.prototype.layerZoomed=function(t){o.prototype.layerZoomed.apply(this,arguments),this._choroplethTransform.attr("transform","translate("+t._zoom.translate()+")scale("+t._zoom.scale()+")").style("stroke-width",this.meshStrokeWidth()/t._zoom.scale()+"px")},i.prototype.click=function(t,e,o){console.log("Click:  "+JSON.stringify(t)+", "+e+", "+o)},i});