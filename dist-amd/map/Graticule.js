(function(e,t){typeof define=="function"&&define.amd?define(["d3","topojson","./Layer","../common/Palette","css!./Graticule"],t):e.map_Graticule=t(e.d3,e.topojson,e.map_Layer,e.common_Palette)})(this,function(e,t,n,r){function i(){n.call(this),this._dataMap={},this._path=e.select(null)}return i.prototype=Object.create(n.prototype),i.prototype.constructor=i,i.prototype._class+=" map_Graticule",i.prototype.publish("opacity",1,"number","Opacity",null,{tags:["Advanced"]}),i.prototype.publish("meshColor",null,"html-color","Stroke Color",null,{optional:!0}),i.prototype.publish("meshStrokeWidth",.25,"number","Stroke Width"),i.prototype.layerEnter=function(t,r,i){n.prototype.layerEnter.apply(this,arguments),this._graticule=e.geo.graticule(),this._graticulePath=r.append("path").datum(this._graticule).attr("class","graticule"),this._graticuleOutlinePath=r.append("path").datum(this._graticule.outline).attr("class","graticuleOutline")},i.prototype.layerUpdate=function(e){if(!this.visible()){this._graticulePath.attr("d",""),this._graticuleOutlinePath.attr("d",""),delete this._prevProjection;return}this._prevProjection!==e.projection()&&(this._graticulePath.attr("d",e._d3GeoPath),this._graticuleOutlinePath.attr("d",e._d3GeoPath),this._prevProjection=e.projection()),this._graticulePath.style("stroke",this.meshColor()),this._graticuleOutlinePath.style("stroke",this.meshColor())},i.prototype.layerExit=function(e){delete this._prevProjection},i.prototype.layerZoomed=function(e){this._graticulePath.style("opacity",this.opacity()).attr("transform","translate("+e._zoom.translate()+")scale("+e._zoom.scale()+")").style("stroke-width",this.meshStrokeWidth()/e._zoom.scale()+"px"),this._graticuleOutlinePath.style("opacity",this.opacity()).attr("transform","translate("+e._zoom.translate()+")scale("+e._zoom.scale()+")").style("stroke-width",this.meshStrokeWidth()/e._zoom.scale()+"px")},i});