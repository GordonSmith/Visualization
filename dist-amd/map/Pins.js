!function(t,e){"function"==typeof define&&define.amd?define(["d3","./Layer","../common/Palette","../common/Utility","css!./Pins"],e):t.map_Pins=e(t.d3,t.map_Layer,t.common_Palette,t.common_Utility)}(this,function(t,e,o,i){function n(){e.call(this)}return n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.prototype._class+=" map_Pins",n.prototype.publish("opacity",1,"number","Opacity",null,{tags:["Advanced"]}),n.prototype.publish("fillColor","#006ccc","html-color","Pin Color",null,{optional:!0}),n.prototype.layerEnter=function(o,n,s){e.prototype.layerEnter.apply(this,arguments),this._pinsTransform=n,this._selection=new i.SimpleSelection(this._pinsTransform),this.pinsPaths=t.select(null)},n.prototype.layerUpdate=function(t){e.prototype.layerUpdate.apply(this,arguments),this._pinsTransform.style("opacity",this.opacity()),this.pinsPaths=this._pinsTransform.selectAll(".data").data(this.visible()?this.data():[],function(t){return t[0]});var o=this;this.pinsPaths.enter().append("path").attr("class","data").attr("d",function(t){return"M 0,0 C -2,-20 -10,-22 -10,-30 A 10,10 0 1,1 10,-30 C 10,-22 2,-20 0,0 z M -2,-30"}).call(this._selection.enter.bind(this._selection)).on("click",function(t){o.click(o.rowToObj(t),"weight",o._selection.selected(this))}).append("title"),this.pinsPaths.attr("stroke-width","1.5px").style("display",function(e){var o=t.project(e[0],e[1]);return o?null:"none"}).style("fill",function(t){return t[2]&&t[2].fillColor?t[2].fillColor:o.fillColor()}),this.pinsPaths.select("title").text(function(t){return t[2]&&t[2].tooltip?t[2].tooltip:""}),this.pinsPaths.exit().remove()},n.prototype.layerZoomed=function(t){e.prototype.layerZoomed.apply(this,arguments),this.pinsPaths.attr("transform",function(e){var o=t.project(e[0],e[1]);return o||(o=[0,0]),"translate("+o[0]+", "+o[1]+")scale(0.5)"})},n.prototype.click=function(t,e,o){console.log("Click:  "+JSON.stringify(t)+", "+e+", "+o)},n});