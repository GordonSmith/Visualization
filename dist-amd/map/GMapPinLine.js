!function(t,o){"function"==typeof define&&define.amd?define(["d3","./GMapLayered","./Lines","./Pins"],o):t.map_GMapPinLine=o(t.d3,t.map_GMapLayered,t.map_Lines,t.map_Pins)}(this,function(t,o,i,n){function e(t){o.call(this);var e=this;this._lines=new i,this._pins=(new n).columns(["lat","long","ext"]).on("click",function(t,o,i){e.click(e.rowToObj(t.ext.origRow),"",i)})}return e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.prototype._class+=" map_GMapPinLine",e.prototype.publish("fromPinColor","green","color","From Pin Color"),e.prototype.publish("fromLatitudeColumn",null,"set","From Latitude",function(){return this.columns()},{optional:!0}),e.prototype.publish("fromLongtitudeColumn",null,"set","From Longtitude",function(){return this.columns()},{optional:!0}),e.prototype.publish("fromColorColumn",null,"set","From Color",function(){return this.columns()},{optional:!0}),e.prototype.publish("fromTooltipColumn",null,"set","From Tooltip",function(){return this.columns()},{optional:!0}),e.prototype.publish("toPinColor","red","color","To Pin Color"),e.prototype.publish("toLatitudeColumn",null,"set","To Latitude",function(){return this.columns()},{optional:!0}),e.prototype.publish("toLongtitudeColumn",null,"set","To Longtitude",function(){return this.columns()},{optional:!0}),e.prototype.publish("toColorColumn",null,"set","To Color",function(){return this.columns()},{optional:!0}),e.prototype.publish("toTooltipColumn",null,"set","To Tooltip",function(){return this.columns()},{optional:!0}),e.prototype.pinsData=function(){var t=this.columns();this._fromView=this._db.rollupView([this.fromLatitudeColumn(),this.fromLongtitudeColumn()]),this._toView=this._db.rollupView([this.toLatitudeColumn(),this.toLongtitudeColumn()]);var o=this._fromView.entries().map(function(o){var i=o.values[0].values[0];return[o.key,o.values[0].key,{fillColor:i[t.indexOf(this.fromColorColumn())]||this.fromPinColor(),tooltip:i[t.indexOf(this.fromTooltipColumn())],origRow:i}]},this),i=this._toView.entries().map(function(o){var i=o.values[0].values[0];return[o.key,o.values[0].key,{fillColor:i[t.indexOf(this.toColorColumn())]||this.toPinColor(),tooltip:i[t.indexOf(this.toTooltipColumn())],origRow:i}]},this);return o.concat(i)},e.prototype.linesData=function(){return this._linesView=this._db.rollupView([this.fromLatitudeColumn(),this.fromLongtitudeColumn(),this.toLatitudeColumn(),this.toLongtitudeColumn()]),this._linesView.data()},e.prototype.enter=function(t,i){o.prototype.enter.apply(this,arguments),this.layers([this._lines,this._pins])},e.prototype.update=function(t,i){o.prototype.update.apply(this,arguments),this._pins.data(this.pinsData()),this._lines.data(this.linesData())},e.prototype.exit=function(t,i){o.prototype.exit.apply(this,arguments)},e.prototype.click=function(t,o,i){console.log("Click:  "+JSON.stringify(t)+", "+o+","+i)},e});