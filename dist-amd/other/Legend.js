(function(e,t){typeof define=="function"&&define.amd?define(["d3","./Table","../common/Palette","css!./Legend"],t):e.other_Legend=t(e.d3,e.other_Table,e.common_Palette)})(this,function(e,t,n){function r(){t.call(this),this.showHeader(!1)}function i(e){return'<div class="colorBlock" style="background-color:'+e+';"></div>'}return r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.prototype._class+=" other_Legend",r.prototype.publish("dataFamily","ND","set","Type of data",["1D","2D","ND","map","any"],{tags:["Private"]}),r.prototype.publish("orientation","vertical","set","Orientation of Legend rows",["vertical","horizontal"],{tags:["Private"]}),r.prototype.publish("rainbowFormat",",","string","Rainbow number formatting",null,{tags:["Private"],optional:!0,disable:function(e){return!e.isRainbow()}}),r.prototype.publish("rainbowBins",8,"number","Number of rainbow bins",null,{tags:["Private"],disable:function(e){return!e.isRainbow()}}),r.prototype.isRainbow=function(){var e=this.getWidget();return e&&e._palette&&e._palette.type()==="rainbow"},r.prototype.targetWidget=function(e){if(!arguments.length)return this._targetWidget;this._targetWidget=e,this._targetWidgetMonitor&&(this._targetWidgetMonitor.remove(),delete this._targetWidgetMonitor);var t=this;return this._targetWidgetMonitor=this._targetWidget.monitor(function(e,n,r,i){switch(e){case"chart":case"columns":case"data":case"paletteID":t.lazyRender()}}),this},r.prototype.getWidget=function(){if(this._targetWidget)switch(this._targetWidget.classID()){case"chart_MultiChart":return this._targetWidget.chart()}return this._targetWidget},r.prototype.getPalette=function(){var e=this.getWidget();if(e&&e._palette)switch(e._palette.type()){case"ordinal":return n.ordinal(e._palette.id());case"rainbow":return n.rainbow(e._palette.id())}return n.ordinal("default")},r.prototype.enter=function(n,r){t.prototype.enter.apply(this,arguments),e.select(n.parentNode).style("overflow-y","auto"),this.renderHtmlDataCells(!0),this.fixedHeader(!1),this.fixedSize(!0),r.classed("other_Legend",!0)},r.prototype.update=function(n,r){var s=["Key","Label"],o=[];if(this._targetWidget){var u=this.getPalette();switch(u.type()){case"ordinal":switch(this.dataFamily()){case"2D":o=this._targetWidget.data().map(function(e){return[i(u(e[0])),e[0]]},this);break;case"ND":var a=this._targetWidget.columns();o=a.filter(function(e,t){return t>0}).map(function(e){return[i(u(e)),e]},this)}break;case"rainbow":var f=e.format(this.rainbowFormat()),l=this.getWidget(),c=this.rainbowBins(),h=l._dataMinWeight,p=l._dataMaxWeight,d=(p-h)/(c-1);o.push([i(u(h,h,p)),f(h)]);for(var v=1;v<c-1;++v){var m=d*v;o.push([i(u(m,h,p)),f(Math.floor(m))])}o.push([i(u(p,h,p)),f(p)])}}this.columns(s),this.data(o),t.prototype.update.apply(this,arguments),r.classed("horiz-legend",this.orientation()==="horizontal");var g=r.select(".tableDiv > table"),y=g.node().getBoundingClientRect(),b=this._parentElement.node().getBoundingClientRect();r.select(".tableDiv").style({overflow:"visible"});var w=b.height/2-y.height/2,E=b.width/2-y.width/2;g.style({position:"absolute",top:w+"px",left:E+"px"});var S=this.pageNumber()-1,x=this.itemsPerPage(),T=S*x,N=parseInt(S*x)+parseInt(x),C=null;this.pagination()?C=this.data().slice(T,N):C=this.data();var k=this.tbody.selectAll("tr").data(C),L=this;k.on("click",function(e,t){L.onClick(e,t)}).on("mouseover",function(e,t){L.onMouseOver(e,t)})},r.prototype.exit=function(e,n){this._targetWidgetMonitor&&(this._targetWidgetMonitor.remove(),delete this._targetWidgetMonitor),t.prototype.exit.apply(this,arguments)},r.prototype.onClick=function(e,t){console.log("Legend onClick method"),console.log("rowData: "+e),console.log("rowIdx: "+t)},r.prototype.onMouseOver=function(e,t){console.log("Legend onMouseOver method"),console.log("rowData: "+e),console.log("rowIdx: "+t)},r});