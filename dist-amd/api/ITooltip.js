(function(e,t){typeof define=="function"&&define.amd?define(["d3","d3-tip","../common/Widget","css!./ITooltip"],t):e.api_ITooltip=t(e.d3,e.d3.tip,e.common_Widget)})(this,function(e,t,n,r,i){function s(){n.call(this),this._valueFormatter=e.format(this.tooltipValueFormat());if(this.layerEnter){var t=this.layerEnter;this.layerEnter=function(e,n,r){this.tooltipEnter(n),t.apply(this,arguments)};var r=this.layerUpdate;this.layerUpdate=function(e){r.apply(this,arguments),this.tooltipUpdate()};var i=this.layerExit;this.layerExit=function(e){i.apply(this,arguments),this.tooltipExit()}}else{var s=this.enter;this.enter=function(e,t){this.tooltipEnter(t),s.apply(this,arguments)};var o=this.update;this.update=function(e,t){o.apply(this,arguments),this.tooltipUpdate()};var u=this.exit;this.exit=function(e,t){u.apply(this,arguments),this.tooltipExit()}}}s.prototype=Object.create(n.prototype),s.prototype.publish("tooltipStyle","default","set","Style",["default","none"],{}),s.prototype.publish("tooltipValueFormat",",.2f","string","Value Format",null,{}),s.prototype.publish("tooltipSeriesColor","#EAFFFF","html-color","Series Color",null,{}),s.prototype.publish("tooltipLabelColor","#CCFFFF","html-color","Label Color",null,{}),s.prototype.publish("tooltipValueColor","white","html-color","Value Color",null,{}),s.prototype.publish("tooltipTick",!0,"boolean","Show tooltip tick",null,{}),s.prototype.publish("tooltipOffset",8,"number","Offset from the cursor",null,{}),s.prototype.tooltipEnter=function(e){var n=this;this.tooltip=t().attr("class","d3-tip").offset(function(e){switch(n.tooltip.direction()()){case"e":return[0,n.tooltipOffset()];default:return[-n.tooltipOffset(),0]}}),e.call(this.tooltip)},s.prototype.tooltipUpdate=function(){var e=this.tooltip.attr("class");e=e.split(" notick").join("")+(this.tooltipTick()?"":" notick")+(this.tooltipStyle()==="none"?" hidden":""),this.tooltip.attr("class",e)},s.prototype.tooltipExit=function(){this.tooltip&&this.tooltip.destroy()};var o=s.prototype.tooltipValueFormat;return s.prototype.tooltipValueFormat=function(t){var n=o.apply(this,arguments);return arguments.length&&(this._valueFormatter=e.format(t)),n},s.prototype._tooltipHTML=function(e){return e},s.prototype.tooltipHTML=function(e){return this.tooltip.html(e)},s.prototype.tooltipFormat=function(e){e=e||{},e.label=e.label||"",e.series=e.series||"",e.value instanceof Date?e.value=e.value||"":e.value=this._valueFormatter(e.value)||"";switch(this.tooltipStyle()){case"none":break;default:if(e.series)return"<span style='color:"+this.tooltipSeriesColor()+"'>"+e.series+"</span> / <span style='color:"+this.tooltipLabelColor()+"'>"+e.label+"</span>:  <span style='color:"+this.tooltipValueColor()+"'>"+e.value+"</span>";return"<span style='color:"+this.tooltipLabelColor()+"'>"+e.label+"</span>:  <span style='color:"+this.tooltipValueColor()+"'>"+e.value+"</span>"}},s});