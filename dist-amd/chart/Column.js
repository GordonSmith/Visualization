(function(e,t){typeof define=="function"&&define.amd?define(["d3","./XYAxis","../api/INDChart","../api/ITooltip","css!./Column"],t):e.chart_Column=t(e.d3,e.chart_XYAxis,e.api_INDChart,e.api_ITooltip)})(this,function(e,t,n,r){function i(e){t.call(this),n.call(this),r.call(this),this._linearGap=25}return i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.prototype._class+=" chart_Column",i.prototype.implements(n.prototype),i.prototype.implements(r.prototype),i.prototype.publish("paletteID","default","set","Palette ID",i.prototype._palette.switch(),{tags:["Basic","Shared"]}),i.prototype.publish("stacked",!1,"boolean","Stacked Bars",null,{tags:["Basic"]}),i.prototype.publish("stackedOpacity",.66,"number","Fill Stacked Opacity",null,{tags:["Basic"]}),i.prototype.publish("useClonedPalette",!1,"boolean","Enable or disable using a cloned palette",null,{tags:["Intermediate","Shared"]}),i.prototype.enter=function(e,n){t.prototype.enter.apply(this,arguments);var r=this;this.tooltipHTML(function(e){return r.tooltipFormat({label:e.row[0],series:r.columns()[e.idx],value:e.row[e.idx]})})},i.prototype.updateChart=function(t,n,r,i,s,o,u){var a=this;this._palette=this._palette.switch(this.paletteID()),this.useClonedPalette()&&(this._palette=this._palette.cloneNotExists(this.paletteID()+"_"+this.id()));var f=10,l=0;switch(this.xAxisType()){case"ordinal":f=this.domainAxis.d3Scale.rangeBand(),l=-f/2;break;case"linear":case"time":f=Math.max(Math.abs(this.dataPos(2)-this.dataPos(1))*(100-this._linearGap)/100,f),l=-f/2}var c=e.scale.ordinal().domain(a.columns().filter(function(e,t){return t>0})).rangeRoundBands(o?[0,f]:[f,0]),h=this.svgData.selectAll(".dataRow").data(this.data());h.enter().append("g").attr("class","dataRow"),this.tooltip.direction(o?"n":"e"),h.each(function(t,n){var r=e.select(this),i=r.selectAll("rect").data(t.filter(function(e,t){return t<a.columns().length}).map(function(e,n){return{column:a.columns()[n],row:t,value:e,idx:n}}).filter(function(e,t){return e.value!==null&&e.idx>0}));i.enter().append("rect").attr("class","columnRect").call(a._selection.enter.bind(a._selection)).on("mouseout.tooltip",a.tooltip.hide).on("mousemove.tooltip",a.tooltip.show).on("click",function(e,t){a.click(a.rowToObj(e.row),e.column,a._selection.selected(this))}),o?i.transition().duration(u).attr("x",function(e){return a.dataPos(t[0])+(a.stacked()?0:c(e.column))+l}).attr("width",a.stacked()?f:c.rangeBand()).attr("y",function(e){return e.value instanceof Array?a.valuePos(e.value[1]):a.valuePos(e.value)}).attr("height",function(e){return e.value instanceof Array?a.valuePos(e.value[0])-a.valuePos(e.value[1]):s-a.valuePos(e.value)}).style("opacity",a.stacked()?a.stackedOpacity():1).style("fill",function(e){return a._palette(e.column)}):i.transition().duration(u).attr("y",function(e){return a.dataPos(t[0])+(a.stacked()?0:c(e.column))+l}).attr("height",a.stacked()?f:c.rangeBand()).attr("x",function(e){return e.value instanceof Array?a.valuePos(e.value[0]):0}).attr("width",function(e){return e.value instanceof Array?a.valuePos(e.value[1])-a.valuePos(e.value[0]):a.valuePos(e.value)}).style("opacity",a.stacked()?a.stackedOpacity():1).style("fill",function(e){return a._palette(e.column)}),a.stacked()&&i.sort(function(e,t){return t-e}),i.exit().transition().duration(u).remove()}),h.exit().transition().duration(u).remove()},i});