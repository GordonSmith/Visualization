!function(t,e){"function"==typeof define&&define.amd?define(["d3","./XYAxis","../api/INDChart","../api/ITooltip","css!./Column"],e):t.chart_Column=e(t.d3,t.chart_XYAxis,t.api_INDChart,t.api_ITooltip)}(this,function(t,e,a,o){function n(t){e.call(this),a.call(this),o.call(this),this._linearGap=25}return n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.prototype._class+=" chart_Column",n.prototype["implements"](a.prototype),n.prototype["implements"](o.prototype),n.prototype.publish("paletteID","default","set","Palette ID",n.prototype._palette["switch"](),{tags:["Basic","Shared"]}),n.prototype.publish("stacked",!1,"boolean","Stacked Bars",null,{tags:["Basic"]}),n.prototype.publish("stackedOpacity",.66,"number","Fill Stacked Opacity",null,{tags:["Basic"]}),n.prototype.publish("useClonedPalette",!1,"boolean","Enable or disable using a cloned palette",null,{tags:["Intermediate","Shared"]}),n.prototype.enter=function(t,a){e.prototype.enter.apply(this,arguments);var o=this;this.tooltipHTML(function(t){return o.tooltipFormat({label:t.row[0],series:o.columns()[t.idx],value:t.row[t.idx]})})},n.prototype.updateChart=function(e,a,o,n,i,l,s){var r=this;this._palette=this._palette["switch"](this.paletteID()),this.useClonedPalette()&&(this._palette=this._palette.cloneNotExists(this.paletteID()+"_"+this.id()));var c=10,u=0;switch(this.xAxisType()){case"ordinal":c=this.domainAxis.d3Scale.rangeBand(),u=-c/2;break;case"linear":case"time":c=Math.max(Math.abs(this.dataPos(2)-this.dataPos(1))*(100-this._linearGap)/100,c),u=-c/2}var p=t.scale.ordinal().domain(r.columns().filter(function(t,e){return e>0})).rangeRoundBands(l?[0,c]:[c,0]),d=this.svgData.selectAll(".dataRow").data(this.data());d.enter().append("g").attr("class","dataRow"),this.tooltip.direction(l?"n":"e"),d.each(function(e,a){var o=t.select(this),n=o.selectAll("rect").data(e.filter(function(t,e){return e<r.columns().length}).map(function(t,a){return{column:r.columns()[a],row:e,value:t,idx:a}}).filter(function(t,e){return null!==t.value&&t.idx>0}));n.enter().append("rect").attr("class","columnRect").call(r._selection.enter.bind(r._selection)).on("mouseout.tooltip",r.tooltip.hide).on("mousemove.tooltip",r.tooltip.show).on("click",function(t,e){r.click(r.rowToObj(t.row),t.column,r._selection.selected(this))}),l?n.transition().duration(s).attr("x",function(t){return r.dataPos(e[0])+(r.stacked()?0:p(t.column))+u}).attr("width",r.stacked()?c:p.rangeBand()).attr("y",function(t){return t.value instanceof Array?r.valuePos(t.value[1]):r.valuePos(t.value)}).attr("height",function(t){return t.value instanceof Array?r.valuePos(t.value[0])-r.valuePos(t.value[1]):i-r.valuePos(t.value)}).style("opacity",r.stacked()?r.stackedOpacity():1).style("fill",function(t){return r._palette(t.column)}):n.transition().duration(s).attr("y",function(t){return r.dataPos(e[0])+(r.stacked()?0:p(t.column))+u}).attr("height",r.stacked()?c:p.rangeBand()).attr("x",function(t){return t.value instanceof Array?r.valuePos(t.value[0]):0}).attr("width",function(t){return t.value instanceof Array?r.valuePos(t.value[1])-r.valuePos(t.value[0]):r.valuePos(t.value)}).style("opacity",r.stacked()?r.stackedOpacity():1).style("fill",function(t){return r._palette(t.column)}),r.stacked()&&n.sort(function(t,e){return e-t}),n.exit().transition().duration(s).remove()}),d.exit().transition().duration(s).remove()},n});