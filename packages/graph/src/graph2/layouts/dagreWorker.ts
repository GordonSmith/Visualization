export interface Subgraph {
    id: string;
    text: string;
}

export interface Node {
    id: string;
    text: string;
}

export interface Link {
    id: string;
    source: Node;
    target: Node;
}

export interface Hierarchy {
    parent: string;
    child: string;
}

export interface Data {
    subgraphs: Subgraph[];
    nodes: Node[];
    links: Link[];
    hierarchy: Hierarchy[];
}

export interface Options {
    rankdir: "TB" | "BT" | "LR" | "RL";
    nodesep: number;
    edgesep: number;
    ranksep: number;
    digraph: boolean;
}

export function dagre(data: Data, options: Options) {
    return new Promise(resolve => {
        // tslint:disable-next-line
        const workerCode = `!function(){"use strict";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function n(e,n){return e(n={exports:{}},n.exports),n.exports}var r=function(){this.__data__=[],this.size=0};var t=function(e,n){return e===n||e!=e&&n!=n};var o=function(e,n){for(var r=e.length;r--;)if(t(e[r][0],n))return r;return-1},i=Array.prototype.splice;var a=function(e){var n=this.__data__,r=o(n,e);return!(r<0||(r==n.length-1?n.pop():i.call(n,r,1),--this.size,0))};var u=function(e){var n=this.__data__,r=o(n,e);return r<0?void 0:n[r][1]};var c=function(e){return o(this.__data__,e)>-1};var s=function(e,n){var r=this.__data__,t=o(r,e);return t<0?(++this.size,r.push([e,n])):r[t][1]=n,this};function f(e){var n=-1,r=null==e?0:e.length;for(this.clear();++n<r;){var t=e[n];this.set(t[0],t[1])}}f.prototype.clear=r,f.prototype.delete=a,f.prototype.get=u,f.prototype.has=c,f.prototype.set=s;var d=f;var h=function(){this.__data__=new d,this.size=0};var v=function(e){var n=this.__data__,r=n.delete(e);return this.size=n.size,r};var l=function(e){return this.__data__.get(e)};var p=function(e){return this.__data__.has(e)},g="object"==typeof e&&e&&e.Object===Object&&e,y="object"==typeof self&&self&&self.Object===Object&&self,b=g||y||Function("return this")(),m=b.Symbol,_=Object.prototype,w=_.hasOwnProperty,E=_.toString,j=m?m.toStringTag:void 0;var k=function(e){var n=w.call(e,j),r=e[j];try{e[j]=void 0;var t=!0}catch(e){}var o=E.call(e);return t&&(n?e[j]=r:delete e[j]),o},x=Object.prototype.toString;var N=function(e){return x.call(e)},O="[object Null]",I="[object Undefined]",A=m?m.toStringTag:void 0;var C=function(e){return null==e?void 0===e?I:O:A&&A in Object(e)?k(e):N(e)};var M=function(e){var n=typeof e;return null!=e&&("object"==n||"function"==n)},S="[object AsyncFunction]",P="[object Function]",L="[object GeneratorFunction]",T="[object Proxy]";var F,R=function(e){if(!M(e))return!1;var n=C(e);return n==P||n==L||n==S||n==T},z=b["__core-js_shared__"],D=(F=/[^.]+$/.exec(z&&z.keys&&z.keys.IE_PROTO||""))?"Symbol(src)_1."+F:"";var U=function(e){return!!D&&D in e},B=Function.prototype.toString;var G=function(e){if(null!=e){try{return B.call(e)}catch(e){}try{return e+""}catch(e){}}return""},V=/^\\[object .+?Constructor\\]$/,q=Function.prototype,Y=Object.prototype,$=q.toString,W=Y.hasOwnProperty,K=RegExp("^"+$.call(W).replace(/[\\\\^$.*+?()[\\]{}|]/g,"\\\\$&").replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g,"$1.*?")+"$");var J=function(e){return!(!M(e)||U(e))&&(R(e)?K:V).test(G(e))};var Q=function(e,n){return null==e?void 0:e[n]};var H=function(e,n){var r=Q(e,n);return J(r)?r:void 0},X=H(b,"Map"),Z=H(Object,"create");var ee=function(){this.__data__=Z?Z(null):{},this.size=0};var ne=function(e){var n=this.has(e)&&delete this.__data__[e];return this.size-=n?1:0,n},re="__lodash_hash_undefined__",te=Object.prototype.hasOwnProperty;var oe=function(e){var n=this.__data__;if(Z){var r=n[e];return r===re?void 0:r}return te.call(n,e)?n[e]:void 0},ie=Object.prototype.hasOwnProperty;var ae=function(e){var n=this.__data__;return Z?void 0!==n[e]:ie.call(n,e)},ue="__lodash_hash_undefined__";var ce=function(e,n){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Z&&void 0===n?ue:n,this};function se(e){var n=-1,r=null==e?0:e.length;for(this.clear();++n<r;){var t=e[n];this.set(t[0],t[1])}}se.prototype.clear=ee,se.prototype.delete=ne,se.prototype.get=oe,se.prototype.has=ae,se.prototype.set=ce;var fe=se;var de=function(){this.size=0,this.__data__={hash:new fe,map:new(X||d),string:new fe}};var he=function(e){var n=typeof e;return"string"==n||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==e:null===e};var ve=function(e,n){var r=e.__data__;return he(n)?r["string"==typeof n?"string":"hash"]:r.map};var le=function(e){var n=ve(this,e).delete(e);return this.size-=n?1:0,n};var pe=function(e){return ve(this,e).get(e)};var ge=function(e){return ve(this,e).has(e)};var ye=function(e,n){var r=ve(this,e),t=r.size;return r.set(e,n),this.size+=r.size==t?0:1,this};function be(e){var n=-1,r=null==e?0:e.length;for(this.clear();++n<r;){var t=e[n];this.set(t[0],t[1])}}be.prototype.clear=de,be.prototype.delete=le,be.prototype.get=pe,be.prototype.has=ge,be.prototype.set=ye;var me=be,_e=200;var we=function(e,n){var r=this.__data__;if(r instanceof d){var t=r.__data__;if(!X||t.length<_e-1)return t.push([e,n]),this.size=++r.size,this;r=this.__data__=new me(t)}return r.set(e,n),this.size=r.size,this};function Ee(e){var n=this.__data__=new d(e);this.size=n.size}Ee.prototype.clear=h,Ee.prototype.delete=v,Ee.prototype.get=l,Ee.prototype.has=p,Ee.prototype.set=we;var je=Ee;var ke=function(e,n){for(var r=-1,t=null==e?0:e.length;++r<t&&!1!==n(e[r],r,e););return e},xe=function(){try{var e=H(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();var Ne=function(e,n,r){"__proto__"==n&&xe?xe(e,n,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[n]=r},Oe=Object.prototype.hasOwnProperty;var Ie=function(e,n,r){var o=e[n];Oe.call(e,n)&&t(o,r)&&(void 0!==r||n in e)||Ne(e,n,r)};var Ae=function(e,n,r,t){var o=!r;r||(r={});for(var i=-1,a=n.length;++i<a;){var u=n[i],c=t?t(r[u],e[u],u,r,e):void 0;void 0===c&&(c=e[u]),o?Ne(r,u,c):Ie(r,u,c)}return r};var Ce=function(e,n){for(var r=-1,t=Array(e);++r<e;)t[r]=n(r);return t};var Me=function(e){return null!=e&&"object"==typeof e},Se="[object Arguments]";var Pe=function(e){return Me(e)&&C(e)==Se},Le=Object.prototype,Te=Le.hasOwnProperty,Fe=Le.propertyIsEnumerable,Re=Pe(function(){return arguments}())?Pe:function(e){return Me(e)&&Te.call(e,"callee")&&!Fe.call(e,"callee")},ze=Array.isArray;var De=function(){return!1},Ue=n(function(e,n){var r=n&&!n.nodeType&&n,t=r&&e&&!e.nodeType&&e,o=t&&t.exports===r?b.Buffer:void 0,i=(o?o.isBuffer:void 0)||De;e.exports=i}),Be=9007199254740991,Ge=/^(?:0|[1-9]\\d*)$/;var Ve=function(e,n){var r=typeof e;return!!(n=null==n?Be:n)&&("number"==r||"symbol"!=r&&Ge.test(e))&&e>-1&&e%1==0&&e<n},qe=9007199254740991;var Ye=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=qe},$e={};$e["[object Float32Array]"]=$e["[object Float64Array]"]=$e["[object Int8Array]"]=$e["[object Int16Array]"]=$e["[object Int32Array]"]=$e["[object Uint8Array]"]=$e["[object Uint8ClampedArray]"]=$e["[object Uint16Array]"]=$e["[object Uint32Array]"]=!0,$e["[object Arguments]"]=$e["[object Array]"]=$e["[object ArrayBuffer]"]=$e["[object Boolean]"]=$e["[object DataView]"]=$e["[object Date]"]=$e["[object Error]"]=$e["[object Function]"]=$e["[object Map]"]=$e["[object Number]"]=$e["[object Object]"]=$e["[object RegExp]"]=$e["[object Set]"]=$e["[object String]"]=$e["[object WeakMap]"]=!1;var We=function(e){return Me(e)&&Ye(e.length)&&!!$e[C(e)]};var Ke=function(e){return function(n){return e(n)}},Je=n(function(e,n){var r=n&&!n.nodeType&&n,t=r&&e&&!e.nodeType&&e,o=t&&t.exports===r&&g.process,i=function(){try{var e=t&&t.require&&t.require("util").types;return e||o&&o.binding&&o.binding("util")}catch(e){}}();e.exports=i}),Qe=Je&&Je.isTypedArray,He=Qe?Ke(Qe):We,Xe=Object.prototype.hasOwnProperty;var Ze=function(e,n){var r=ze(e),t=!r&&Re(e),o=!r&&!t&&Ue(e),i=!r&&!t&&!o&&He(e),a=r||t||o||i,u=a?Ce(e.length,String):[],c=u.length;for(var s in e)!n&&!Xe.call(e,s)||a&&("length"==s||o&&("offset"==s||"parent"==s)||i&&("buffer"==s||"byteLength"==s||"byteOffset"==s)||Ve(s,c))||u.push(s);return u},en=Object.prototype;var nn=function(e){var n=e&&e.constructor;return e===("function"==typeof n&&n.prototype||en)};var rn=function(e,n){return function(r){return e(n(r))}},tn=rn(Object.keys,Object),on=Object.prototype.hasOwnProperty;var an=function(e){if(!nn(e))return tn(e);var n=[];for(var r in Object(e))on.call(e,r)&&"constructor"!=r&&n.push(r);return n};var un=function(e){return null!=e&&Ye(e.length)&&!R(e)};var cn=function(e){return un(e)?Ze(e):an(e)};var sn=function(e,n){return e&&Ae(n,cn(n),e)};var fn=function(e){var n=[];if(null!=e)for(var r in Object(e))n.push(r);return n},dn=Object.prototype.hasOwnProperty;var hn=function(e){if(!M(e))return fn(e);var n=nn(e),r=[];for(var t in e)("constructor"!=t||!n&&dn.call(e,t))&&r.push(t);return r};var vn=function(e){return un(e)?Ze(e,!0):hn(e)};var ln=function(e,n){return e&&Ae(n,vn(n),e)},pn=n(function(e,n){var r=n&&!n.nodeType&&n,t=r&&e&&!e.nodeType&&e,o=t&&t.exports===r?b.Buffer:void 0,i=o?o.allocUnsafe:void 0;e.exports=function(e,n){if(n)return e.slice();var r=e.length,t=i?i(r):new e.constructor(r);return e.copy(t),t}});var gn=function(e,n){var r=-1,t=e.length;for(n||(n=Array(t));++r<t;)n[r]=e[r];return n};var yn=function(e,n){for(var r=-1,t=null==e?0:e.length,o=0,i=[];++r<t;){var a=e[r];n(a,r,e)&&(i[o++]=a)}return i};var bn=function(){return[]},mn=Object.prototype.propertyIsEnumerable,_n=Object.getOwnPropertySymbols,wn=_n?function(e){return null==e?[]:(e=Object(e),yn(_n(e),function(n){return mn.call(e,n)}))}:bn;var En=function(e,n){return Ae(e,wn(e),n)};var jn=function(e,n){for(var r=-1,t=n.length,o=e.length;++r<t;)e[o+r]=n[r];return e},kn=rn(Object.getPrototypeOf,Object),xn=Object.getOwnPropertySymbols?function(e){for(var n=[];e;)jn(n,wn(e)),e=kn(e);return n}:bn;var Nn=function(e,n){return Ae(e,xn(e),n)};var On=function(e,n,r){var t=n(e);return ze(e)?t:jn(t,r(e))};var In=function(e){return On(e,cn,wn)};var An=function(e){return On(e,vn,xn)},Cn=H(b,"DataView"),Mn=H(b,"Promise"),Sn=H(b,"Set"),Pn=H(b,"WeakMap"),Ln=G(Cn),Tn=G(X),Fn=G(Mn),Rn=G(Sn),zn=G(Pn),Dn=C;(Cn&&"[object DataView]"!=Dn(new Cn(new ArrayBuffer(1)))||X&&"[object Map]"!=Dn(new X)||Mn&&"[object Promise]"!=Dn(Mn.resolve())||Sn&&"[object Set]"!=Dn(new Sn)||Pn&&"[object WeakMap]"!=Dn(new Pn))&&(Dn=function(e){var n=C(e),r="[object Object]"==n?e.constructor:void 0,t=r?G(r):"";if(t)switch(t){case Ln:return"[object DataView]";case Tn:return"[object Map]";case Fn:return"[object Promise]";case Rn:return"[object Set]";case zn:return"[object WeakMap]"}return n});var Un=Dn,Bn=Object.prototype.hasOwnProperty;var Gn=function(e){var n=e.length,r=new e.constructor(n);return n&&"string"==typeof e[0]&&Bn.call(e,"index")&&(r.index=e.index,r.input=e.input),r},Vn=b.Uint8Array;var qn=function(e){var n=new e.constructor(e.byteLength);return new Vn(n).set(new Vn(e)),n};var Yn=function(e,n){var r=n?qn(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)},$n=/\\w*$/;var Wn=function(e){var n=new e.constructor(e.source,$n.exec(e));return n.lastIndex=e.lastIndex,n},Kn=m?m.prototype:void 0,Jn=Kn?Kn.valueOf:void 0;var Qn=function(e){return Jn?Object(Jn.call(e)):{}};var Hn=function(e,n){var r=n?qn(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)},Xn="[object Boolean]",Zn="[object Date]",er="[object Map]",nr="[object Number]",rr="[object RegExp]",tr="[object Set]",or="[object String]",ir="[object Symbol]",ar="[object ArrayBuffer]",ur="[object DataView]",cr="[object Float32Array]",sr="[object Float64Array]",fr="[object Int8Array]",dr="[object Int16Array]",hr="[object Int32Array]",vr="[object Uint8Array]",lr="[object Uint8ClampedArray]",pr="[object Uint16Array]",gr="[object Uint32Array]";var yr=function(e,n,r){var t=e.constructor;switch(n){case ar:return qn(e);case Xn:case Zn:return new t(+e);case ur:return Yn(e,r);case cr:case sr:case fr:case dr:case hr:case vr:case lr:case pr:case gr:return Hn(e,r);case er:return new t;case nr:case or:return new t(e);case rr:return Wn(e);case tr:return new t;case ir:return Qn(e)}},br=Object.create,mr=function(){function e(){}return function(n){if(!M(n))return{};if(br)return br(n);e.prototype=n;var r=new e;return e.prototype=void 0,r}}();var _r=function(e){return"function"!=typeof e.constructor||nn(e)?{}:mr(kn(e))},wr="[object Map]";var Er=function(e){return Me(e)&&Un(e)==wr},jr=Je&&Je.isMap,kr=jr?Ke(jr):Er,xr="[object Set]";var Nr=function(e){return Me(e)&&Un(e)==xr},Or=Je&&Je.isSet,Ir=Or?Ke(Or):Nr,Ar=1,Cr=2,Mr=4,Sr="[object Arguments]",Pr="[object Function]",Lr="[object GeneratorFunction]",Tr="[object Object]",Fr={};Fr[Sr]=Fr["[object Array]"]=Fr["[object ArrayBuffer]"]=Fr["[object DataView]"]=Fr["[object Boolean]"]=Fr["[object Date]"]=Fr["[object Float32Array]"]=Fr["[object Float64Array]"]=Fr["[object Int8Array]"]=Fr["[object Int16Array]"]=Fr["[object Int32Array]"]=Fr["[object Map]"]=Fr["[object Number]"]=Fr[Tr]=Fr["[object RegExp]"]=Fr["[object Set]"]=Fr["[object String]"]=Fr["[object Symbol]"]=Fr["[object Uint8Array]"]=Fr["[object Uint8ClampedArray]"]=Fr["[object Uint16Array]"]=Fr["[object Uint32Array]"]=!0,Fr["[object Error]"]=Fr[Pr]=Fr["[object WeakMap]"]=!1;var Rr=function e(n,r,t,o,i,a){var u,c=r&Ar,s=r&Cr,f=r&Mr;if(t&&(u=i?t(n,o,i,a):t(n)),void 0!==u)return u;if(!M(n))return n;var d=ze(n);if(d){if(u=Gn(n),!c)return gn(n,u)}else{var h=Un(n),v=h==Pr||h==Lr;if(Ue(n))return pn(n,c);if(h==Tr||h==Sr||v&&!i){if(u=s||v?{}:_r(n),!c)return s?Nn(n,ln(u,n)):En(n,sn(u,n))}else{if(!Fr[h])return i?n:{};u=yr(n,h,c)}}a||(a=new je);var l=a.get(n);if(l)return l;a.set(n,u),Ir(n)?n.forEach(function(o){u.add(e(o,r,t,o,n,a))}):kr(n)&&n.forEach(function(o,i){u.set(i,e(o,r,t,i,n,a))});var p=f?s?An:In:s?keysIn:cn,g=d?void 0:p(n);return ke(g||n,function(o,i){g&&(o=n[i=o]),Ie(u,i,e(o,r,t,i,n,a))}),u},zr=4;var Dr=function(e){return Rr(e,zr)};var Ur=function(e){return function(){return e}};var Br=function(e){return function(n,r,t){for(var o=-1,i=Object(n),a=t(n),u=a.length;u--;){var c=a[e?u:++o];if(!1===r(i[c],c,i))break}return n}}();var Gr=function(e,n){return e&&Br(e,n,cn)};var Vr=function(e,n){return function(r,t){if(null==r)return r;if(!un(r))return e(r,t);for(var o=r.length,i=n?o:-1,a=Object(r);(n?i--:++i<o)&&!1!==t(a[i],i,a););return r}}(Gr);var qr=function(e){return e};var Yr=function(e){return"function"==typeof e?e:qr};var $r=function(e,n){return(ze(e)?ke:Vr)(e,Yr(n))},Wr=$r;var Kr=function(e,n){var r=[];return Vr(e,function(e,t,o){n(e,t,o)&&r.push(e)}),r},Jr="__lodash_hash_undefined__";var Qr=function(e){return this.__data__.set(e,Jr),this};var Hr=function(e){return this.__data__.has(e)};function Xr(e){var n=-1,r=null==e?0:e.length;for(this.__data__=new me;++n<r;)this.add(e[n])}Xr.prototype.add=Xr.prototype.push=Qr,Xr.prototype.has=Hr;var Zr=Xr;var et=function(e,n){for(var r=-1,t=null==e?0:e.length;++r<t;)if(n(e[r],r,e))return!0;return!1};var nt=function(e,n){return e.has(n)},rt=1,tt=2;var ot=function(e,n,r,t,o,i){var a=r&rt,u=e.length,c=n.length;if(u!=c&&!(a&&c>u))return!1;var s=i.get(e);if(s&&i.get(n))return s==n;var f=-1,d=!0,h=r&tt?new Zr:void 0;for(i.set(e,n),i.set(n,e);++f<u;){var v=e[f],l=n[f];if(t)var p=a?t(l,v,f,n,e,i):t(v,l,f,e,n,i);if(void 0!==p){if(p)continue;d=!1;break}if(h){if(!et(n,function(e,n){if(!nt(h,n)&&(v===e||o(v,e,r,t,i)))return h.push(n)})){d=!1;break}}else if(v!==l&&!o(v,l,r,t,i)){d=!1;break}}return i.delete(e),i.delete(n),d};var it=function(e){var n=-1,r=Array(e.size);return e.forEach(function(e,t){r[++n]=[t,e]}),r};var at=function(e){var n=-1,r=Array(e.size);return e.forEach(function(e){r[++n]=e}),r},ut=1,ct=2,st="[object Boolean]",ft="[object Date]",dt="[object Error]",ht="[object Map]",vt="[object Number]",lt="[object RegExp]",pt="[object Set]",gt="[object String]",yt="[object Symbol]",bt="[object ArrayBuffer]",mt="[object DataView]",_t=m?m.prototype:void 0,wt=_t?_t.valueOf:void 0;var Et=function(e,n,r,o,i,a,u){switch(r){case mt:if(e.byteLength!=n.byteLength||e.byteOffset!=n.byteOffset)return!1;e=e.buffer,n=n.buffer;case bt:return!(e.byteLength!=n.byteLength||!a(new Vn(e),new Vn(n)));case st:case ft:case vt:return t(+e,+n);case dt:return e.name==n.name&&e.message==n.message;case lt:case gt:return e==n+"";case ht:var c=it;case pt:var s=o&ut;if(c||(c=at),e.size!=n.size&&!s)return!1;var f=u.get(e);if(f)return f==n;o|=ct,u.set(e,n);var d=ot(c(e),c(n),o,i,a,u);return u.delete(e),d;case yt:if(wt)return wt.call(e)==wt.call(n)}return!1},jt=1,kt=Object.prototype.hasOwnProperty;var xt=function(e,n,r,t,o,i){var a=r&jt,u=In(e),c=u.length;if(c!=In(n).length&&!a)return!1;for(var s=c;s--;){var f=u[s];if(!(a?f in n:kt.call(n,f)))return!1}var d=i.get(e);if(d&&i.get(n))return d==n;var h=!0;i.set(e,n),i.set(n,e);for(var v=a;++s<c;){var l=e[f=u[s]],p=n[f];if(t)var g=a?t(p,l,f,n,e,i):t(l,p,f,e,n,i);if(!(void 0===g?l===p||o(l,p,r,t,i):g)){h=!1;break}v||(v="constructor"==f)}if(h&&!v){var y=e.constructor,b=n.constructor;y!=b&&"constructor"in e&&"constructor"in n&&!("function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b)&&(h=!1)}return i.delete(e),i.delete(n),h},Nt=1,Ot="[object Arguments]",It="[object Array]",At="[object Object]",Ct=Object.prototype.hasOwnProperty;var Mt=function(e,n,r,t,o,i){var a=ze(e),u=ze(n),c=a?It:Un(e),s=u?It:Un(n),f=(c=c==Ot?At:c)==At,d=(s=s==Ot?At:s)==At,h=c==s;if(h&&Ue(e)){if(!Ue(n))return!1;a=!0,f=!1}if(h&&!f)return i||(i=new je),a||He(e)?ot(e,n,r,t,o,i):Et(e,n,c,r,t,o,i);if(!(r&Nt)){var v=f&&Ct.call(e,"__wrapped__"),l=d&&Ct.call(n,"__wrapped__");if(v||l){var p=v?e.value():e,g=l?n.value():n;return i||(i=new je),o(p,g,r,t,i)}}return!!h&&(i||(i=new je),xt(e,n,r,t,o,i))};var St=function e(n,r,t,o,i){return n===r||(null==n||null==r||!Me(n)&&!Me(r)?n!=n&&r!=r:Mt(n,r,t,o,e,i))},Pt=1,Lt=2;var Tt=function(e,n,r,t){var o=r.length,i=o,a=!t;if(null==e)return!i;for(e=Object(e);o--;){var u=r[o];if(a&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++o<i;){var c=(u=r[o])[0],s=e[c],f=u[1];if(a&&u[2]){if(void 0===s&&!(c in e))return!1}else{var d=new je;if(t)var h=t(s,f,c,e,n,d);if(!(void 0===h?St(f,s,Pt|Lt,t,d):h))return!1}}return!0};var Ft=function(e){return e==e&&!M(e)};var Rt=function(e){for(var n=cn(e),r=n.length;r--;){var t=n[r],o=e[t];n[r]=[t,o,Ft(o)]}return n};var zt=function(e,n){return function(r){return null!=r&&r[e]===n&&(void 0!==n||e in Object(r))}};var Dt=function(e){var n=Rt(e);return 1==n.length&&n[0][2]?zt(n[0][0],n[0][1]):function(r){return r===e||Tt(r,e,n)}},Ut="[object Symbol]";var Bt=function(e){return"symbol"==typeof e||Me(e)&&C(e)==Ut},Gt=/\\.|\\[(?:[^[\\]]*|(["'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,Vt=/^\\w*$/;var qt=function(e,n){if(ze(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!Bt(e))||Vt.test(e)||!Gt.test(e)||null!=n&&e in Object(n)},Yt="Expected a function";function $t(e,n){if("function"!=typeof e||null!=n&&"function"!=typeof n)throw new TypeError(Yt);var r=function(){var t=arguments,o=n?n.apply(this,t):t[0],i=r.cache;if(i.has(o))return i.get(o);var a=e.apply(this,t);return r.cache=i.set(o,a)||i,a};return r.cache=new($t.Cache||me),r}$t.Cache=me;var Wt=$t,Kt=500;var Jt=/[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|(["'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g,Qt=/\\\\(\\\\)?/g,Ht=function(e){var n=Wt(e,function(e){return r.size===Kt&&r.clear(),e}),r=n.cache;return n}(function(e){var n=[];return 46===e.charCodeAt(0)&&n.push(""),e.replace(Jt,function(e,r,t,o){n.push(t?o.replace(Qt,"$1"):r||e)}),n});var Xt=function(e,n){for(var r=-1,t=null==e?0:e.length,o=Array(t);++r<t;)o[r]=n(e[r],r,e);return o},Zt=1/0,eo=m?m.prototype:void 0,no=eo?eo.toString:void 0;var ro=function e(n){if("string"==typeof n)return n;if(ze(n))return Xt(n,e)+"";if(Bt(n))return no?no.call(n):"";var r=n+"";return"0"==r&&1/n==-Zt?"-0":r};var to=function(e){return null==e?"":ro(e)};var oo=function(e,n){return ze(e)?e:qt(e,n)?[e]:Ht(to(e))},io=1/0;var ao=function(e){if("string"==typeof e||Bt(e))return e;var n=e+"";return"0"==n&&1/e==-io?"-0":n};var uo=function(e,n){for(var r=0,t=(n=oo(n,e)).length;null!=e&&r<t;)e=e[ao(n[r++])];return r&&r==t?e:void 0};var co=function(e,n,r){var t=null==e?void 0:uo(e,n);return void 0===t?r:t};var so=function(e,n){return null!=e&&n in Object(e)};var fo=function(e,n,r){for(var t=-1,o=(n=oo(n,e)).length,i=!1;++t<o;){var a=ao(n[t]);if(!(i=null!=e&&r(e,a)))break;e=e[a]}return i||++t!=o?i:!!(o=null==e?0:e.length)&&Ye(o)&&Ve(a,o)&&(ze(e)||Re(e))};var ho=function(e,n){return null!=e&&fo(e,n,so)},vo=1,lo=2;var po=function(e,n){return qt(e)&&Ft(n)?zt(ao(e),n):function(r){var t=co(r,e);return void 0===t&&t===n?ho(r,e):St(n,t,vo|lo)}};var go=function(e){return function(n){return null==n?void 0:n[e]}};var yo=function(e){return function(n){return uo(n,e)}};var bo=function(e){return qt(e)?go(ao(e)):yo(e)};var mo=function(e){return"function"==typeof e?e:null==e?qr:"object"==typeof e?ze(e)?po(e[0],e[1]):Dt(e):bo(e)};var _o=function(e,n){return(ze(e)?yn:Kr)(e,mo(n))},wo=Object.prototype.hasOwnProperty;var Eo=function(e,n){return null!=e&&wo.call(e,n)};var jo=function(e,n){return null!=e&&fo(e,n,Eo)},ko="[object Map]",xo="[object Set]",No=Object.prototype.hasOwnProperty;var Oo=function(e){if(null==e)return!0;if(un(e)&&(ze(e)||"string"==typeof e||"function"==typeof e.splice||Ue(e)||He(e)||Re(e)))return!e.length;var n=Un(e);if(n==ko||n==xo)return!e.size;if(nn(e))return!an(e).length;for(var r in e)if(No.call(e,r))return!1;return!0};var Io=function(e){return void 0===e};var Ao=function(e,n){var r=-1,t=un(e)?Array(e.length):[];return Vr(e,function(e,o,i){t[++r]=n(e,o,i)}),t};var Co=function(e,n){return(ze(e)?Xt:Ao)(e,mo(n))};var Mo=function(e,n,r,t){var o=-1,i=null==e?0:e.length;for(t&&i&&(r=e[++o]);++o<i;)r=n(r,e[o],o,e);return r};var So=function(e,n,r,t,o){return o(e,function(e,o,i){r=t?(t=!1,e):n(r,e,o,i)}),r};var Po=function(e,n,r){var t=ze(e)?Mo:So,o=arguments.length<3;return t(e,mo(n),r,o,Vr)},Lo="[object String]";var To=function(e){return"string"==typeof e||!ze(e)&&Me(e)&&C(e)==Lo},Fo=go("length"),Ro=RegExp("[\\\\u200d\\\\ud800-\\\\udfff\\\\u0300-\\\\u036f\\\\ufe20-\\\\ufe2f\\\\u20d0-\\\\u20ff\\\\ufe0e\\\\ufe0f]");var zo=function(e){return Ro.test(e)},Do="[\\\\ud800-\\\\udfff]",Uo="[\\\\u0300-\\\\u036f\\\\ufe20-\\\\ufe2f\\\\u20d0-\\\\u20ff]",Bo="\\\\ud83c[\\\\udffb-\\\\udfff]",Go="[^\\\\ud800-\\\\udfff]",Vo="(?:\\\\ud83c[\\\\udde6-\\\\uddff]){2}",qo="[\\\\ud800-\\\\udbff][\\\\udc00-\\\\udfff]",Yo="(?:"+Uo+"|"+Bo+")"+"?",$o="[\\\\ufe0e\\\\ufe0f]?"+Yo+("(?:\\\\u200d(?:"+[Go,Vo,qo].join("|")+")[\\\\ufe0e\\\\ufe0f]?"+Yo+")*"),Wo="(?:"+[Go+Uo+"?",Uo,Vo,qo,Do].join("|")+")",Ko=RegExp(Bo+"(?="+Bo+")|"+Wo+$o,"g");var Jo=function(e){for(var n=Ko.lastIndex=0;Ko.test(e);)++n;return n};var Qo=function(e){return zo(e)?Jo(e):Fo(e)},Ho="[object Map]",Xo="[object Set]";var Zo=function(e){if(null==e)return 0;if(un(e))return To(e)?Qo(e):e.length;var n=Un(e);return n==Ho||n==Xo?e.size:an(e).length};var ei=function(e,n,r){var t=ze(e),o=t||Ue(e)||He(e);if(n=mo(n),null==r){var i=e&&e.constructor;r=o?t?new i:[]:M(e)&&R(i)?mr(kn(e)):{}}return(o?ke:Gr)(e,function(e,t,o){return n(r,e,t,o)}),r},ni=m?m.isConcatSpreadable:void 0;var ri=function(e){return ze(e)||Re(e)||!!(ni&&e&&e[ni])};var ti=function e(n,r,t,o,i){var a=-1,u=n.length;for(t||(t=ri),i||(i=[]);++a<u;){var c=n[a];r>0&&t(c)?r>1?e(c,r-1,t,o,i):jn(i,c):o||(i[i.length]=c)}return i};var oi=function(e,n,r){switch(r.length){case 0:return e.call(n);case 1:return e.call(n,r[0]);case 2:return e.call(n,r[0],r[1]);case 3:return e.call(n,r[0],r[1],r[2])}return e.apply(n,r)},ii=Math.max;var ai=function(e,n,r){return n=ii(void 0===n?e.length-1:n,0),function(){for(var t=arguments,o=-1,i=ii(t.length-n,0),a=Array(i);++o<i;)a[o]=t[n+o];o=-1;for(var u=Array(n+1);++o<n;)u[o]=t[o];return u[n]=r(a),oi(e,this,u)}},ui=xe?function(e,n){return xe(e,"toString",{configurable:!0,enumerable:!1,value:Ur(n),writable:!0})}:qr,ci=800,si=16,fi=Date.now;var di=function(e){var n=0,r=0;return function(){var t=fi(),o=si-(t-r);if(r=t,o>0){if(++n>=ci)return arguments[0]}else n=0;return e.apply(void 0,arguments)}}(ui);var hi=function(e,n){return di(ai(e,n,qr),e+"")};var vi=function(e,n,r,t){for(var o=e.length,i=r+(t?1:-1);t?i--:++i<o;)if(n(e[i],i,e))return i;return-1};var li=function(e){return e!=e};var pi=function(e,n,r){for(var t=r-1,o=e.length;++t<o;)if(e[t]===n)return t;return-1};var gi=function(e,n,r){return n==n?pi(e,n,r):vi(e,li,r)};var yi=function(e,n){return!(null==e||!e.length)&&gi(e,n,0)>-1};var bi=function(e,n,r){for(var t=-1,o=null==e?0:e.length;++t<o;)if(r(n,e[t]))return!0;return!1};var mi=function(){},_i=Sn&&1/at(new Sn([,-0]))[1]==1/0?function(e){return new Sn(e)}:mi,wi=200;var Ei=function(e,n,r){var t=-1,o=yi,i=e.length,a=!0,u=[],c=u;if(r)a=!1,o=bi;else if(i>=wi){var s=n?null:_i(e);if(s)return at(s);a=!1,o=nt,c=new Zr}else c=n?[]:u;e:for(;++t<i;){var f=e[t],d=n?n(f):f;if(f=r||0!==f?f:0,a&&d==d){for(var h=c.length;h--;)if(c[h]===d)continue e;n&&c.push(d),u.push(f)}else o(c,d,r)||(c!==u&&c.push(d),u.push(f))}return u};var ji=function(e){return Me(e)&&un(e)},ki=hi(function(e){return Ei(ti(e,1,ji,!0))});var xi=function(e,n){return Xt(n,function(n){return e[n]})};var Ni,Oi=function(e){return null==e?[]:xi(e,cn(e))};try{Ni={clone:Dr,constant:Ur,each:Wr,filter:_o,has:jo,isArray:ze,isEmpty:Oo,isFunction:R,isUndefined:Io,keys:cn,map:Co,reduce:Po,size:Zo,transform:ei,union:ki,values:Oi}}catch(e){}Ni||(Ni=window._);var Ii=Ni,Ai=Pi,Ci="\\0",Mi="\\0",Si="";function Pi(e){this._isDirected=!Ii.has(e,"directed")||e.directed,this._isMultigraph=!!Ii.has(e,"multigraph")&&e.multigraph,this._isCompound=!!Ii.has(e,"compound")&&e.compound,this._label=void 0,this._defaultNodeLabelFn=Ii.constant(void 0),this._defaultEdgeLabelFn=Ii.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[Mi]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function Li(e,n){e[n]?e[n]++:e[n]=1}function Ti(e,n){--e[n]||delete e[n]}function Fi(e,n,r,t){var o=""+n,i=""+r;if(!e&&o>i){var a=o;o=i,i=a}return o+Si+i+Si+(Ii.isUndefined(t)?Ci:t)}function Ri(e,n){return Fi(e,n.v,n.w,n.name)}Pi.prototype._nodeCount=0,Pi.prototype._edgeCount=0,Pi.prototype.isDirected=function(){return this._isDirected},Pi.prototype.isMultigraph=function(){return this._isMultigraph},Pi.prototype.isCompound=function(){return this._isCompound},Pi.prototype.setGraph=function(e){return this._label=e,this},Pi.prototype.graph=function(){return this._label},Pi.prototype.setDefaultNodeLabel=function(e){return Ii.isFunction(e)||(e=Ii.constant(e)),this._defaultNodeLabelFn=e,this},Pi.prototype.nodeCount=function(){return this._nodeCount},Pi.prototype.nodes=function(){return Ii.keys(this._nodes)},Pi.prototype.sources=function(){var e=this;return Ii.filter(this.nodes(),function(n){return Ii.isEmpty(e._in[n])})},Pi.prototype.sinks=function(){var e=this;return Ii.filter(this.nodes(),function(n){return Ii.isEmpty(e._out[n])})},Pi.prototype.setNodes=function(e,n){var r=arguments,t=this;return Ii.each(e,function(e){r.length>1?t.setNode(e,n):t.setNode(e)}),this},Pi.prototype.setNode=function(e,n){return Ii.has(this._nodes,e)?(arguments.length>1&&(this._nodes[e]=n),this):(this._nodes[e]=arguments.length>1?n:this._defaultNodeLabelFn(e),this._isCompound&&(this._parent[e]=Mi,this._children[e]={},this._children[Mi][e]=!0),this._in[e]={},this._preds[e]={},this._out[e]={},this._sucs[e]={},++this._nodeCount,this)},Pi.prototype.node=function(e){return this._nodes[e]},Pi.prototype.hasNode=function(e){return Ii.has(this._nodes,e)},Pi.prototype.removeNode=function(e){var n=this;if(Ii.has(this._nodes,e)){var r=function(e){n.removeEdge(n._edgeObjs[e])};delete this._nodes[e],this._isCompound&&(this._removeFromParentsChildList(e),delete this._parent[e],Ii.each(this.children(e),function(e){n.setParent(e)}),delete this._children[e]),Ii.each(Ii.keys(this._in[e]),r),delete this._in[e],delete this._preds[e],Ii.each(Ii.keys(this._out[e]),r),delete this._out[e],delete this._sucs[e],--this._nodeCount}return this},Pi.prototype.setParent=function(e,n){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(Ii.isUndefined(n))n=Mi;else{for(var r=n+="";!Ii.isUndefined(r);r=this.parent(r))if(r===e)throw new Error("Setting "+n+" as parent of "+e+" would create a cycle");this.setNode(n)}return this.setNode(e),this._removeFromParentsChildList(e),this._parent[e]=n,this._children[n][e]=!0,this},Pi.prototype._removeFromParentsChildList=function(e){delete this._children[this._parent[e]][e]},Pi.prototype.parent=function(e){if(this._isCompound){var n=this._parent[e];if(n!==Mi)return n}},Pi.prototype.children=function(e){if(Ii.isUndefined(e)&&(e=Mi),this._isCompound){var n=this._children[e];if(n)return Ii.keys(n)}else{if(e===Mi)return this.nodes();if(this.hasNode(e))return[]}},Pi.prototype.predecessors=function(e){var n=this._preds[e];if(n)return Ii.keys(n)},Pi.prototype.successors=function(e){var n=this._sucs[e];if(n)return Ii.keys(n)},Pi.prototype.neighbors=function(e){var n=this.predecessors(e);if(n)return Ii.union(n,this.successors(e))},Pi.prototype.isLeaf=function(e){return 0===(this.isDirected()?this.successors(e):this.neighbors(e)).length},Pi.prototype.filterNodes=function(e){var n=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});n.setGraph(this.graph());var r=this;Ii.each(this._nodes,function(r,t){e(t)&&n.setNode(t,r)}),Ii.each(this._edgeObjs,function(e){n.hasNode(e.v)&&n.hasNode(e.w)&&n.setEdge(e,r.edge(e))});var t={};return this._isCompound&&Ii.each(n.nodes(),function(e){n.setParent(e,function e(o){var i=r.parent(o);return void 0===i||n.hasNode(i)?(t[o]=i,i):i in t?t[i]:e(i)}(e))}),n},Pi.prototype.setDefaultEdgeLabel=function(e){return Ii.isFunction(e)||(e=Ii.constant(e)),this._defaultEdgeLabelFn=e,this},Pi.prototype.edgeCount=function(){return this._edgeCount},Pi.prototype.edges=function(){return Ii.values(this._edgeObjs)},Pi.prototype.setPath=function(e,n){var r=this,t=arguments;return Ii.reduce(e,function(e,o){return t.length>1?r.setEdge(e,o,n):r.setEdge(e,o),o}),this},Pi.prototype.setEdge=function(){var e,n,r,t,o=!1,i=arguments[0];"object"==typeof i&&null!==i&&"v"in i?(e=i.v,n=i.w,r=i.name,2===arguments.length&&(t=arguments[1],o=!0)):(e=i,n=arguments[1],r=arguments[3],arguments.length>2&&(t=arguments[2],o=!0)),e=""+e,n=""+n,Ii.isUndefined(r)||(r=""+r);var a=Fi(this._isDirected,e,n,r);if(Ii.has(this._edgeLabels,a))return o&&(this._edgeLabels[a]=t),this;if(!Ii.isUndefined(r)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(e),this.setNode(n),this._edgeLabels[a]=o?t:this._defaultEdgeLabelFn(e,n,r);var u=function(e,n,r,t){var o=""+n,i=""+r;if(!e&&o>i){var a=o;o=i,i=a}var u={v:o,w:i};t&&(u.name=t);return u}(this._isDirected,e,n,r);return e=u.v,n=u.w,Object.freeze(u),this._edgeObjs[a]=u,Li(this._preds[n],e),Li(this._sucs[e],n),this._in[n][a]=u,this._out[e][a]=u,this._edgeCount++,this},Pi.prototype.edge=function(e,n,r){var t=1===arguments.length?Ri(this._isDirected,arguments[0]):Fi(this._isDirected,e,n,r);return this._edgeLabels[t]},Pi.prototype.hasEdge=function(e,n,r){var t=1===arguments.length?Ri(this._isDirected,arguments[0]):Fi(this._isDirected,e,n,r);return Ii.has(this._edgeLabels,t)},Pi.prototype.removeEdge=function(e,n,r){var t=1===arguments.length?Ri(this._isDirected,arguments[0]):Fi(this._isDirected,e,n,r),o=this._edgeObjs[t];return o&&(e=o.v,n=o.w,delete this._edgeLabels[t],delete this._edgeObjs[t],Ti(this._preds[n],e),Ti(this._sucs[e],n),delete this._in[n][t],delete this._out[e][t],this._edgeCount--),this},Pi.prototype.inEdges=function(e,n){var r=this._in[e];if(r){var t=Ii.values(r);return n?Ii.filter(t,function(e){return e.v===n}):t}},Pi.prototype.outEdges=function(e,n){var r=this._out[e];if(r){var t=Ii.values(r);return n?Ii.filter(t,function(e){return e.w===n}):t}},Pi.prototype.nodeEdges=function(e,n){var r=this.inEdges(e,n);if(r)return r.concat(this.outEdges(e,n))};var zi={Graph:Ai,version:"2.1.8"},Di={write:function(e){var n={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:Ui(e),edges:Bi(e)};Ii.isUndefined(e.graph())||(n.value=Ii.clone(e.graph()));return n},read:function(e){var n=new Ai(e.options).setGraph(e.value);return Ii.each(e.nodes,function(e){n.setNode(e.v,e.value),e.parent&&n.setParent(e.v,e.parent)}),Ii.each(e.edges,function(e){n.setEdge({v:e.v,w:e.w,name:e.name},e.value)}),n}};function Ui(e){return Ii.map(e.nodes(),function(n){var r=e.node(n),t=e.parent(n),o={v:n};return Ii.isUndefined(r)||(o.value=r),Ii.isUndefined(t)||(o.parent=t),o})}function Bi(e){return Ii.map(e.edges(),function(n){var r=e.edge(n),t={v:n.v,w:n.w};return Ii.isUndefined(n.name)||(t.name=n.name),Ii.isUndefined(r)||(t.value=r),t})}var Gi=function(e){var n,r={},t=[];function o(t){Ii.has(r,t)||(r[t]=!0,n.push(t),Ii.each(e.successors(t),o),Ii.each(e.predecessors(t),o))}return Ii.each(e.nodes(),function(e){n=[],o(e),n.length&&t.push(n)}),t};var Vi=qi;function qi(){this._arr=[],this._keyIndices={}}qi.prototype.size=function(){return this._arr.length},qi.prototype.keys=function(){return this._arr.map(function(e){return e.key})},qi.prototype.has=function(e){return Ii.has(this._keyIndices,e)},qi.prototype.priority=function(e){var n=this._keyIndices[e];if(void 0!==n)return this._arr[n].priority},qi.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},qi.prototype.add=function(e,n){var r=this._keyIndices;if(e=String(e),!Ii.has(r,e)){var t=this._arr,o=t.length;return r[e]=o,t.push({key:e,priority:n}),this._decrease(o),!0}return!1},qi.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var e=this._arr.pop();return delete this._keyIndices[e.key],this._heapify(0),e.key},qi.prototype.decrease=function(e,n){var r=this._keyIndices[e];if(n>this._arr[r].priority)throw new Error("New priority is greater than current priority. Key: "+e+" Old: "+this._arr[r].priority+" New: "+n);this._arr[r].priority=n,this._decrease(r)},qi.prototype._heapify=function(e){var n=this._arr,r=2*e,t=r+1,o=e;r<n.length&&(o=n[r].priority<n[o].priority?r:o,t<n.length&&(o=n[t].priority<n[o].priority?t:o),o!==e&&(this._swap(e,o),this._heapify(o)))},qi.prototype._decrease=function(e){for(var n,r=this._arr,t=r[e].priority;0!==e&&!(r[n=e>>1].priority<t);)this._swap(e,n),e=n},qi.prototype._swap=function(e,n){var r=this._arr,t=this._keyIndices,o=r[e],i=r[n];r[e]=i,r[n]=o,t[i.key]=e,t[o.key]=n};var Yi=function(e,n,r,t){return function(e,n,r,t){var o,i,a={},u=new Vi,c=function(e){var n=e.v!==o?e.v:e.w,t=a[n],c=r(e),s=i.distance+c;if(c<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+e+" Weight: "+c);s<t.distance&&(t.distance=s,t.predecessor=o,u.decrease(n,s))};e.nodes().forEach(function(e){var r=e===n?0:Number.POSITIVE_INFINITY;a[e]={distance:r},u.add(e,r)});for(;u.size()>0&&(o=u.removeMin(),(i=a[o]).distance!==Number.POSITIVE_INFINITY);)t(o).forEach(c);return a}(e,String(n),r||$i,t||function(n){return e.outEdges(n)})},$i=Ii.constant(1);var Wi=function(e,n,r){return Ii.transform(e.nodes(),function(t,o){t[o]=Yi(e,o,n,r)},{})};var Ki=function(e){var n=0,r=[],t={},o=[];return e.nodes().forEach(function(i){Ii.has(t,i)||function i(a){var u=t[a]={onStack:!0,lowlink:n,index:n++};if(r.push(a),e.successors(a).forEach(function(e){Ii.has(t,e)?t[e].onStack&&(u.lowlink=Math.min(u.lowlink,t[e].index)):(i(e),u.lowlink=Math.min(u.lowlink,t[e].lowlink))}),u.lowlink===u.index){var c,s=[];do{c=r.pop(),t[c].onStack=!1,s.push(c)}while(a!==c);o.push(s)}}(i)}),o};var Ji=function(e){return Ii.filter(Ki(e),function(n){return n.length>1||1===n.length&&e.hasEdge(n[0],n[0])})};var Qi=function(e,n,r){return function(e,n,r){var t={},o=e.nodes();return o.forEach(function(e){t[e]={},t[e][e]={distance:0},o.forEach(function(n){e!==n&&(t[e][n]={distance:Number.POSITIVE_INFINITY})}),r(e).forEach(function(r){var o=r.v===e?r.w:r.v,i=n(r);t[e][o]={distance:i,predecessor:e}})}),o.forEach(function(e){var n=t[e];o.forEach(function(r){var i=t[r];o.forEach(function(r){var t=i[e],o=n[r],a=i[r],u=t.distance+o.distance;u<a.distance&&(a.distance=u,a.predecessor=o.predecessor)})})}),t}(e,n||Hi,r||function(n){return e.outEdges(n)})},Hi=Ii.constant(1);var Xi=Zi;function Zi(e){var n={},r={},t=[];if(Ii.each(e.sinks(),function o(i){if(Ii.has(r,i))throw new ea;Ii.has(n,i)||(r[i]=!0,n[i]=!0,Ii.each(e.predecessors(i),o),delete r[i],t.push(i))}),Ii.size(n)!==e.nodeCount())throw new ea;return t}function ea(){}Zi.CycleException=ea,ea.prototype=new Error;var na=function(e,n,r){Ii.isArray(n)||(n=[n]);var t=(e.isDirected()?e.successors:e.neighbors).bind(e),o=[],i={};return Ii.each(n,function(n){if(!e.hasNode(n))throw new Error("Graph does not have node: "+n);!function e(n,r,t,o,i,a){Ii.has(o,r)||(o[r]=!0,t||a.push(r),Ii.each(i(r),function(r){e(n,r,t,o,i,a)}),t&&a.push(r))}(e,n,"post"===r,i,t,o)}),o};var ra,ta={Graph:zi.Graph,json:Di,alg:{components:Gi,dijkstra:Yi,dijkstraAll:Wi,findCycles:Ji,floydWarshall:Qi,isAcyclic:function(e){try{Xi(e)}catch(e){if(e instanceof Xi.CycleException)return!1;throw e}return!0},postorder:function(e,n){return na(e,n,"post")},preorder:function(e,n){return na(e,n,"pre")},prim:function(e,n){var r,t=new Ai,o={},i=new Vi;function a(e){var t=e.v===r?e.w:e.v,a=i.priority(t);if(void 0!==a){var u=n(e);u<a&&(o[t]=r,i.decrease(t,u))}}if(0===e.nodeCount())return t;Ii.each(e.nodes(),function(e){i.add(e,Number.POSITIVE_INFINITY),t.setNode(e)}),i.decrease(e.nodes()[0],0);var u=!1;for(;i.size()>0;){if(r=i.removeMin(),Ii.has(o,r))t.setEdge(r,o[r]);else{if(u)throw new Error("Input graph is not connected: "+e);u=!0}e.nodeEdges(r).forEach(a)}return t},tarjan:Ki,topsort:Xi},version:zi.version};try{ra=ta}catch(e){}ra||(ra=window.graphlib);var oa=ra,ia=1,aa=4;var ua=function(e){return Rr(e,ia|aa)};var ca=function(e,n,r){if(!M(r))return!1;var o=typeof n;return!!("number"==o?un(r)&&Ve(n,r.length):"string"==o&&n in r)&&t(r[n],e)},sa=Object.prototype,fa=sa.hasOwnProperty,da=hi(function(e,n){e=Object(e);var r=-1,o=n.length,i=o>2?n[2]:void 0;for(i&&ca(n[0],n[1],i)&&(o=1);++r<o;)for(var a=n[r],u=vn(a),c=-1,s=u.length;++c<s;){var f=u[c],d=e[f];(void 0===d||t(d,sa[f])&&!fa.call(e,f))&&(e[f]=a[f])}return e});var ha=function(e){return function(n,r,t){var o=Object(n);if(!un(n)){var i=mo(r);n=cn(n),r=function(e){return i(o[e],e,o)}}var a=e(n,r,t);return a>-1?o[i?n[a]:a]:void 0}},va=NaN,la=/^\\s+|\\s+$/g,pa=/^[-+]0x[0-9a-f]+$/i,ga=/^0b[01]+$/i,ya=/^0o[0-7]+$/i,ba=parseInt;var ma=function(e){if("number"==typeof e)return e;if(Bt(e))return va;if(M(e)){var n="function"==typeof e.valueOf?e.valueOf():e;e=M(n)?n+"":n}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(la,"");var r=ga.test(e);return r||ya.test(e)?ba(e.slice(2),r?2:8):pa.test(e)?va:+e},_a=1/0,wa=1.7976931348623157e308;var Ea=function(e){return e?(e=ma(e))===_a||e===-_a?(e<0?-1:1)*wa:e==e?e:0:0===e?e:0};var ja=function(e){var n=Ea(e),r=n%1;return n==n?r?n-r:n:0},ka=Math.max;var xa=ha(function(e,n,r){var t=null==e?0:e.length;if(!t)return-1;var o=null==r?0:ja(r);return o<0&&(o=ka(t+o,0)),vi(e,mo(n),o)});var Na=function(e){return null!=e&&e.length?ti(e,1):[]};var Oa=function(e,n){return null==e?e:Br(e,Yr(n),vn)};var Ia=function(e){var n=null==e?0:e.length;return n?e[n-1]:void 0};var Aa=function(e,n){var r={};return n=mo(n),Gr(e,function(e,t,o){Ne(r,t,n(e,t,o))}),r};var Ca=function(e,n,r){for(var t=-1,o=e.length;++t<o;){var i=e[t],a=n(i);if(null!=a&&(void 0===u?a==a&&!Bt(a):r(a,u)))var u=a,c=i}return c};var Ma=function(e,n){return e>n};var Sa=function(e){return e&&e.length?Ca(e,qr,Ma):void 0};var Pa=function(e,n,r){(void 0===r||t(e[n],r))&&(void 0!==r||n in e)||Ne(e,n,r)},La="[object Object]",Ta=Function.prototype,Fa=Object.prototype,Ra=Ta.toString,za=Fa.hasOwnProperty,Da=Ra.call(Object);var Ua=function(e){if(!Me(e)||C(e)!=La)return!1;var n=kn(e);if(null===n)return!0;var r=za.call(n,"constructor")&&n.constructor;return"function"==typeof r&&r instanceof r&&Ra.call(r)==Da};var Ba=function(e,n){if(("constructor"!==n||"function"!=typeof e[n])&&"__proto__"!=n)return e[n]};var Ga=function(e){return Ae(e,vn(e))};var Va=function(e,n,r,t,o,i,a){var u=Ba(e,r),c=Ba(n,r),s=a.get(c);if(s)Pa(e,r,s);else{var f=i?i(u,c,r+"",e,n,a):void 0,d=void 0===f;if(d){var h=ze(c),v=!h&&Ue(c),l=!h&&!v&&He(c);f=c,h||v||l?ze(u)?f=u:ji(u)?f=gn(u):v?(d=!1,f=pn(c,!0)):l?(d=!1,f=Hn(c,!0)):f=[]:Ua(c)||Re(c)?(f=u,Re(u)?f=Ga(u):M(u)&&!R(u)||(f=_r(c))):d=!1}d&&(a.set(c,f),o(f,c,t,i,a),a.delete(c)),Pa(e,r,f)}};var qa=function e(n,r,t,o,i){n!==r&&Br(r,function(a,u){if(i||(i=new je),M(a))Va(n,r,u,t,e,o,i);else{var c=o?o(Ba(n,u),a,u+"",n,r,i):void 0;void 0===c&&(c=a),Pa(n,u,c)}},vn)};var Ya=function(e){return hi(function(n,r){var t=-1,o=r.length,i=o>1?r[o-1]:void 0,a=o>2?r[2]:void 0;for(i=e.length>3&&"function"==typeof i?(o--,i):void 0,a&&ca(r[0],r[1],a)&&(i=o<3?void 0:i,o=1),n=Object(n);++t<o;){var u=r[t];u&&e(n,u,t,i)}return n})}(function(e,n,r){qa(e,n,r)});var $a=function(e,n){return e<n};var Wa=function(e){return e&&e.length?Ca(e,qr,$a):void 0};var Ka=function(e,n){return e&&e.length?Ca(e,mo(n),$a):void 0},Ja=function(){return b.Date.now()};var Qa=function(e,n,r,t){if(!M(e))return e;for(var o=-1,i=(n=oo(n,e)).length,a=i-1,u=e;null!=u&&++o<i;){var c=ao(n[o]),s=r;if(o!=a){var f=u[c];void 0===(s=t?t(f,c,u):void 0)&&(s=M(f)?f:Ve(n[o+1])?[]:{})}Ie(u,c,s),u=u[c]}return e};var Ha=function(e,n,r){for(var t=-1,o=n.length,i={};++t<o;){var a=n[t],u=uo(e,a);r(u,a)&&Qa(i,oo(a,e),u)}return i};var Xa=function(e,n){return Ha(e,n,function(n,r){return ho(e,r)})};var Za=function(e){return di(ai(e,void 0,Na),e+"")}(function(e,n){return null==e?{}:Xa(e,n)}),eu=Math.ceil,nu=Math.max;var ru=function(e,n,r,t){for(var o=-1,i=nu(eu((n-e)/(r||1)),0),a=Array(i);i--;)a[t?i:++o]=e,e+=r;return a};var tu=function(e){return function(n,r,t){return t&&"number"!=typeof t&&ca(n,r,t)&&(r=t=void 0),n=Ea(n),void 0===r?(r=n,n=0):r=Ea(r),t=void 0===t?n<r?1:-1:Ea(t),ru(n,r,t,e)}}();var ou=function(e,n){var r=e.length;for(e.sort(n);r--;)e[r]=e[r].value;return e};var iu=function(e,n){if(e!==n){var r=void 0!==e,t=null===e,o=e==e,i=Bt(e),a=void 0!==n,u=null===n,c=n==n,s=Bt(n);if(!u&&!s&&!i&&e>n||i&&a&&c&&!u&&!s||t&&a&&c||!r&&c||!o)return 1;if(!t&&!i&&!s&&e<n||s&&r&&o&&!t&&!i||u&&r&&o||!a&&o||!c)return-1}return 0};var au=function(e,n,r){for(var t=-1,o=e.criteria,i=n.criteria,a=o.length,u=r.length;++t<a;){var c=iu(o[t],i[t]);if(c)return t>=u?c:c*("desc"==r[t]?-1:1)}return e.index-n.index};var uu=function(e,n,r){var t=-1;n=Xt(n.length?n:[qr],Ke(mo));var o=Ao(e,function(e,r,o){return{criteria:Xt(n,function(n){return n(e)}),index:++t,value:e}});return ou(o,function(e,n){return au(e,n,r)})},cu=hi(function(e,n){if(null==e)return[];var r=n.length;return r>1&&ca(e,n[0],n[1])?n=[]:r>2&&ca(n[0],n[1],n[2])&&(n=[n[0]]),uu(e,ti(n,1),[])}),su=0;var fu=function(e){var n=++su;return to(e)+n};var du=function(e,n,r){for(var t=-1,o=e.length,i=n.length,a={};++t<o;){var u=t<i?n[t]:void 0;r(a,e[t],u)}return a};var hu,vu=function(e,n){return du(e||[],n||[],Ie)};try{hu={cloneDeep:ua,constant:Ur,defaults:da,each:Wr,filter:_o,find:xa,flatten:Na,forEach:$r,forIn:Oa,has:jo,isUndefined:Io,last:Ia,map:Co,mapValues:Aa,max:Sa,merge:Ya,min:Wa,minBy:Ka,now:Ja,pick:Za,range:tu,reduce:Po,sortBy:cu,uniqueId:fu,values:Oi,zipObject:vu}}catch(e){}hu||(hu=window._);var lu=hu,pu=gu;function gu(){var e={};e._next=e._prev=e,this._sentinel=e}function yu(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function bu(e,n){if("_next"!==e&&"_prev"!==e)return n}gu.prototype.dequeue=function(){var e=this._sentinel,n=e._prev;if(n!==e)return yu(n),n},gu.prototype.enqueue=function(e){var n=this._sentinel;e._prev&&e._next&&yu(e),e._next=n._next,n._next._prev=e,n._next=e,e._prev=n},gu.prototype.toString=function(){for(var e=[],n=this._sentinel,r=n._prev;r!==n;)e.push(JSON.stringify(r,bu)),r=r._prev;return"["+e.join(", ")+"]"};var mu=oa.Graph,_u=function(e,n){if(e.nodeCount()<=1)return[];var r=function(e,n){var r=new mu,t=0,o=0;lu.forEach(e.nodes(),function(e){r.setNode(e,{v:e,in:0,out:0})}),lu.forEach(e.edges(),function(e){var i=r.edge(e.v,e.w)||0,a=n(e),u=i+a;r.setEdge(e.v,e.w,u),o=Math.max(o,r.node(e.v).out+=a),t=Math.max(t,r.node(e.w).in+=a)});var i=lu.range(o+t+3).map(function(){return new pu}),a=t+1;return lu.forEach(r.nodes(),function(e){ju(i,a,r.node(e))}),{graph:r,buckets:i,zeroIdx:a}}(e,n||wu),t=function(e,n,r){var t,o=[],i=n[n.length-1],a=n[0];for(;e.nodeCount();){for(;t=a.dequeue();)Eu(e,n,r,t);for(;t=i.dequeue();)Eu(e,n,r,t);if(e.nodeCount())for(var u=n.length-2;u>0;--u)if(t=n[u].dequeue()){o=o.concat(Eu(e,n,r,t,!0));break}}return o}(r.graph,r.buckets,r.zeroIdx);return lu.flatten(lu.map(t,function(n){return e.outEdges(n.v,n.w)}),!0)},wu=lu.constant(1);function Eu(e,n,r,t,o){var i=o?[]:void 0;return lu.forEach(e.inEdges(t.v),function(t){var a=e.edge(t),u=e.node(t.v);o&&i.push({v:t.v,w:t.w}),u.out-=a,ju(n,r,u)}),lu.forEach(e.outEdges(t.v),function(t){var o=e.edge(t),i=t.w,a=e.node(i);a.in-=o,ju(n,r,a)}),e.removeNode(t.v),i}function ju(e,n,r){r.out?r.in?e[r.out-r.in+n].enqueue(r):e[e.length-1].enqueue(r):e[0].enqueue(r)}var ku={run:function(e){var n="greedy"===e.graph().acyclicer?_u(e,function(e){return function(n){return e.edge(n).weight}}(e)):function(e){var n=[],r={},t={};return lu.forEach(e.nodes(),function o(i){lu.has(t,i)||(t[i]=!0,r[i]=!0,lu.forEach(e.outEdges(i),function(e){lu.has(r,e.w)?n.push(e):o(e.w)}),delete r[i])}),n}(e);lu.forEach(n,function(n){var r=e.edge(n);e.removeEdge(n),r.forwardName=n.name,r.reversed=!0,e.setEdge(n.w,n.v,r,lu.uniqueId("rev"))})},undo:function(e){lu.forEach(e.edges(),function(n){var r=e.edge(n);if(r.reversed){e.removeEdge(n);var t=r.forwardName;delete r.reversed,delete r.forwardName,e.setEdge(n.w,n.v,r,t)}})}};var xu=oa.Graph,Nu={addDummyNode:Ou,simplify:function(e){var n=(new xu).setGraph(e.graph());return lu.forEach(e.nodes(),function(r){n.setNode(r,e.node(r))}),lu.forEach(e.edges(),function(r){var t=n.edge(r.v,r.w)||{weight:0,minlen:1},o=e.edge(r);n.setEdge(r.v,r.w,{weight:t.weight+o.weight,minlen:Math.max(t.minlen,o.minlen)})}),n},asNonCompoundGraph:function(e){var n=new xu({multigraph:e.isMultigraph()}).setGraph(e.graph());return lu.forEach(e.nodes(),function(r){e.children(r).length||n.setNode(r,e.node(r))}),lu.forEach(e.edges(),function(r){n.setEdge(r,e.edge(r))}),n},successorWeights:function(e){var n=lu.map(e.nodes(),function(n){var r={};return lu.forEach(e.outEdges(n),function(n){r[n.w]=(r[n.w]||0)+e.edge(n).weight}),r});return lu.zipObject(e.nodes(),n)},predecessorWeights:function(e){var n=lu.map(e.nodes(),function(n){var r={};return lu.forEach(e.inEdges(n),function(n){r[n.v]=(r[n.v]||0)+e.edge(n).weight}),r});return lu.zipObject(e.nodes(),n)},intersectRect:function(e,n){var r,t,o=e.x,i=e.y,a=n.x-o,u=n.y-i,c=e.width/2,s=e.height/2;if(!a&&!u)throw new Error("Not possible to find intersection inside of the rectangle");Math.abs(u)*c>Math.abs(a)*s?(u<0&&(s=-s),r=s*a/u,t=s):(a<0&&(c=-c),r=c,t=c*u/a);return{x:o+r,y:i+t}},buildLayerMatrix:function(e){var n=lu.map(lu.range(Iu(e)+1),function(){return[]});return lu.forEach(e.nodes(),function(r){var t=e.node(r),o=t.rank;lu.isUndefined(o)||(n[o][t.order]=r)}),n},normalizeRanks:function(e){var n=lu.min(lu.map(e.nodes(),function(n){return e.node(n).rank}));lu.forEach(e.nodes(),function(r){var t=e.node(r);lu.has(t,"rank")&&(t.rank-=n)})},removeEmptyRanks:function(e){var n=lu.min(lu.map(e.nodes(),function(n){return e.node(n).rank})),r=[];lu.forEach(e.nodes(),function(t){var o=e.node(t).rank-n;r[o]||(r[o]=[]),r[o].push(t)});var t=0,o=e.graph().nodeRankFactor;lu.forEach(r,function(n,r){lu.isUndefined(n)&&r%o!=0?--t:t&&lu.forEach(n,function(n){e.node(n).rank+=t})})},addBorderNode:function(e,n,r,t){var o={width:0,height:0};arguments.length>=4&&(o.rank=r,o.order=t);return Ou(e,"border",o,n)},maxRank:Iu,partition:function(e,n){var r={lhs:[],rhs:[]};return lu.forEach(e,function(e){n(e)?r.lhs.push(e):r.rhs.push(e)}),r},time:function(e,n){var r=lu.now();try{return n()}finally{console.log(e+" time: "+(lu.now()-r)+"ms")}},notime:function(e,n){return n()}};function Ou(e,n,r,t){var o;do{o=lu.uniqueId(t)}while(e.hasNode(o));return r.dummy=n,e.setNode(o,r),o}function Iu(e){return lu.max(lu.map(e.nodes(),function(n){var r=e.node(n).rank;if(!lu.isUndefined(r))return r}))}var Au={run:function(e){e.graph().dummyChains=[],lu.forEach(e.edges(),function(n){!function(e,n){var r,t,o,i=n.v,a=e.node(i).rank,u=n.w,c=e.node(u).rank,s=n.name,f=e.edge(n),d=f.labelRank;if(c===a+1)return;for(e.removeEdge(n),o=0,++a;a<c;++o,++a)f.points=[],t={width:0,height:0,edgeLabel:f,edgeObj:n,rank:a},r=Nu.addDummyNode(e,"edge",t,"_d"),a===d&&(t.width=f.width,t.height=f.height,t.dummy="edge-label",t.labelpos=f.labelpos),e.setEdge(i,r,{weight:f.weight},s),0===o&&e.graph().dummyChains.push(r),i=r;e.setEdge(i,u,{weight:f.weight},s)}(e,n)})},undo:function(e){lu.forEach(e.graph().dummyChains,function(n){var r,t=e.node(n),o=t.edgeLabel;for(e.setEdge(t.edgeObj,o);t.dummy;)r=e.successors(n)[0],e.removeNode(n),o.points.push({x:t.x,y:t.y}),"edge-label"===t.dummy&&(o.x=t.x,o.y=t.y,o.width=t.width,o.height=t.height),n=r,t=e.node(n)})}};var Cu=function(e){var n={};lu.forEach(e.sources(),function r(t){var o=e.node(t);if(lu.has(n,t))return o.rank;n[t]=!0;var i=lu.min(lu.map(e.outEdges(t),function(n){return r(n.w)-e.edge(n).minlen}));i!==Number.POSITIVE_INFINITY&&null!=i||(i=0);return o.rank=i})},Mu=function(e,n){return e.node(n.w).rank-e.node(n.v).rank-e.edge(n).minlen};var Su=oa.Graph,Pu=Mu,Lu=function(e){var n,r,t=new Su({directed:!1}),o=e.nodes()[0],i=e.nodeCount();t.setNode(o,{});for(;Tu(t,e)<i;)n=Fu(t,e),r=t.hasNode(n.v)?Pu(e,n):-Pu(e,n),Ru(t,e,r);return t};function Tu(e,n){return lu.forEach(e.nodes(),function r(t){lu.forEach(n.nodeEdges(t),function(o){var i=o.v,a=t===i?o.w:i;e.hasNode(a)||Pu(n,o)||(e.setNode(a,{}),e.setEdge(t,a,{}),r(a))})}),e.nodeCount()}function Fu(e,n){return lu.minBy(n.edges(),function(r){if(e.hasNode(r.v)!==e.hasNode(r.w))return Pu(n,r)})}function Ru(e,n,r){lu.forEach(e.nodes(),function(e){n.node(e).rank+=r})}var zu=Mu,Du=Cu,Uu=oa.alg.preorder,Bu=oa.alg.postorder,Gu=Nu.simplify,Vu=qu;function qu(e){e=Gu(e),Du(e);var n,r=Lu(e);for(Wu(r),Yu(r,e);n=Ku(r);)Qu(r,e,n,Ju(r,e,n))}function Yu(e,n){var r=Bu(e,e.nodes());r=r.slice(0,r.length-1),lu.forEach(r,function(r){!function(e,n,r){var t=e.node(r).parent;e.edge(r,t).cutvalue=$u(e,n,r)}(e,n,r)})}function $u(e,n,r){var t=e.node(r).parent,o=!0,i=n.edge(r,t),a=0;return i||(o=!1,i=n.edge(t,r)),a=i.weight,lu.forEach(n.nodeEdges(r),function(i){var u,c,s=i.v===r,f=s?i.w:i.v;if(f!==t){var d=s===o,h=n.edge(i).weight;if(a+=d?h:-h,u=r,c=f,e.hasEdge(u,c)){var v=e.edge(r,f).cutvalue;a+=d?-v:v}}}),a}function Wu(e,n){arguments.length<2&&(n=e.nodes()[0]),function e(n,r,t,o,i){var a=t;var u=n.node(o);r[o]=!0;lu.forEach(n.neighbors(o),function(i){lu.has(r,i)||(t=e(n,r,t,i,o))});u.low=a;u.lim=t++;i?u.parent=i:delete u.parent;return t}(e,{},1,n)}function Ku(e){return lu.find(e.edges(),function(n){return e.edge(n).cutvalue<0})}function Ju(e,n,r){var t=r.v,o=r.w;n.hasEdge(t,o)||(t=r.w,o=r.v);var i=e.node(t),a=e.node(o),u=i,c=!1;i.lim>a.lim&&(u=a,c=!0);var s=lu.filter(n.edges(),function(n){return c===Hu(e,e.node(n.v),u)&&c!==Hu(e,e.node(n.w),u)});return lu.minBy(s,function(e){return zu(n,e)})}function Qu(e,n,r,t){var o=r.v,i=r.w;e.removeEdge(o,i),e.setEdge(t.v,t.w,{}),Wu(e),Yu(e,n),function(e,n){var r=lu.find(e.nodes(),function(e){return!n.node(e).parent}),t=Uu(e,r);t=t.slice(1),lu.forEach(t,function(r){var t=e.node(r).parent,o=n.edge(r,t),i=!1;o||(o=n.edge(t,r),i=!0),n.node(r).rank=n.node(t).rank+(i?o.minlen:-o.minlen)})}(e,n)}function Hu(e,n,r){return r.low<=n.lim&&n.lim<=r.lim}qu.initLowLimValues=Wu,qu.initCutValues=Yu,qu.calcCutValue=$u,qu.leaveEdge=Ku,qu.enterEdge=Ju,qu.exchangeEdges=Qu;var Xu=Cu,Zu=function(e){switch(e.graph().ranker){case"network-simplex":nc(e);break;case"tight-tree":!function(e){Xu(e),Lu(e)}(e);break;case"longest-path":ec(e);break;default:nc(e)}};var ec=Xu;function nc(e){Vu(e)}var rc=function(e){var n=function(e){var n={},r=0;return lu.forEach(e.children(),function t(o){var i=r;lu.forEach(e.children(o),t),n[o]={low:i,lim:r++}}),n}(e);lu.forEach(e.graph().dummyChains,function(r){for(var t=e.node(r),o=t.edgeObj,i=function(e,n,r,t){var o,i,a=[],u=[],c=Math.min(n[r].low,n[t].low),s=Math.max(n[r].lim,n[t].lim);o=r;do{o=e.parent(o),a.push(o)}while(o&&(n[o].low>c||s>n[o].lim));i=o,o=t;for(;(o=e.parent(o))!==i;)u.push(o);return{path:a.concat(u.reverse()),lca:i}}(e,n,o.v,o.w),a=i.path,u=i.lca,c=0,s=a[c],f=!0;r!==o.w;){if(t=e.node(r),f){for(;(s=a[c])!==u&&e.node(s).maxRank<t.rank;)c++;s===u&&(f=!1)}if(!f){for(;c<a.length-1&&e.node(s=a[c+1]).minRank<=t.rank;)c++;s=a[c]}e.setParent(r,s),r=e.successors(r)[0]}})};var tc={run:function(e){var n=Nu.addDummyNode(e,"root",{},"_root"),r=function(e){var n={};return lu.forEach(e.children(),function(r){!function r(t,o){var i=e.children(t);i&&i.length&&lu.forEach(i,function(e){r(e,o+1)}),n[t]=o}(r,1)}),n}(e),t=lu.max(lu.values(r))-1,o=2*t+1;e.graph().nestingRoot=n,lu.forEach(e.edges(),function(n){e.edge(n).minlen*=o});var i=function(e){return lu.reduce(e.edges(),function(n,r){return n+e.edge(r).weight},0)}(e)+1;lu.forEach(e.children(),function(a){!function e(n,r,t,o,i,a,u){var c=n.children(u);if(!c.length)return void(u!==r&&n.setEdge(r,u,{weight:0,minlen:t}));var s=Nu.addBorderNode(n,"_bt");var f=Nu.addBorderNode(n,"_bb");var d=n.node(u);n.setParent(s,u);d.borderTop=s;n.setParent(f,u);d.borderBottom=f;lu.forEach(c,function(c){e(n,r,t,o,i,a,c);var d=n.node(c),h=d.borderTop?d.borderTop:c,v=d.borderBottom?d.borderBottom:c,l=d.borderTop?o:2*o,p=h!==v?1:i-a[u]+1;n.setEdge(s,h,{weight:l,minlen:p,nestingEdge:!0}),n.setEdge(v,f,{weight:l,minlen:p,nestingEdge:!0})});n.parent(u)||n.setEdge(r,s,{weight:0,minlen:i+a[u]})}(e,n,o,i,t,r,a)}),e.graph().nodeRankFactor=o},cleanup:function(e){var n=e.graph();e.removeNode(n.nestingRoot),delete n.nestingRoot,lu.forEach(e.edges(),function(n){var r=e.edge(n);r.nestingEdge&&e.removeEdge(n)})}};var oc=function(e){lu.forEach(e.children(),function n(r){var t=e.children(r);var o=e.node(r);t.length&&lu.forEach(t,n);if(lu.has(o,"minRank")){o.borderLeft=[],o.borderRight=[];for(var i=o.minRank,a=o.maxRank+1;i<a;++i)ic(e,"borderLeft","_bl",r,o,i),ic(e,"borderRight","_br",r,o,i)}})};function ic(e,n,r,t,o,i){var a={width:0,height:0,rank:i,borderType:n},u=o[n][i-1],c=Nu.addDummyNode(e,"border",a,r);o[n][i]=c,e.setParent(c,t),u&&e.setEdge(u,c,{weight:1})}var ac={adjust:function(e){var n=e.graph().rankdir.toLowerCase();"lr"!==n&&"rl"!==n||uc(e)},undo:function(e){var n=e.graph().rankdir.toLowerCase();"bt"!==n&&"rl"!==n||function(e){lu.forEach(e.nodes(),function(n){sc(e.node(n))}),lu.forEach(e.edges(),function(n){var r=e.edge(n);lu.forEach(r.points,sc),lu.has(r,"y")&&sc(r)})}(e);"lr"!==n&&"rl"!==n||(!function(e){lu.forEach(e.nodes(),function(n){fc(e.node(n))}),lu.forEach(e.edges(),function(n){var r=e.edge(n);lu.forEach(r.points,fc),lu.has(r,"x")&&fc(r)})}(e),uc(e))}};function uc(e){lu.forEach(e.nodes(),function(n){cc(e.node(n))}),lu.forEach(e.edges(),function(n){cc(e.edge(n))})}function cc(e){var n=e.width;e.width=e.height,e.height=n}function sc(e){e.y=-e.y}function fc(e){var n=e.x;e.x=e.y,e.y=n}var dc=function(e){var n={},r=lu.filter(e.nodes(),function(n){return!e.children(n).length}),t=lu.max(lu.map(r,function(n){return e.node(n).rank})),o=lu.map(lu.range(t+1),function(){return[]});var i=lu.sortBy(r,function(n){return e.node(n).rank});return lu.forEach(i,function r(t){if(!lu.has(n,t)){n[t]=!0;var i=e.node(t);o[i.rank].push(t),lu.forEach(e.successors(t),r)}}),o};var hc=function(e,n){for(var r=0,t=1;t<n.length;++t)r+=vc(e,n[t-1],n[t]);return r};function vc(e,n,r){for(var t=lu.zipObject(r,lu.map(r,function(e,n){return n})),o=lu.flatten(lu.map(n,function(n){return lu.sortBy(lu.map(e.outEdges(n),function(n){return{pos:t[n.w],weight:e.edge(n).weight}}),"pos")}),!0),i=1;i<r.length;)i<<=1;var a=2*i-1;i-=1;var u=lu.map(new Array(a),function(){return 0}),c=0;return lu.forEach(o.forEach(function(e){var n=e.pos+i;u[n]+=e.weight;for(var r=0;n>0;)n%2&&(r+=u[n+1]),u[n=n-1>>1]+=e.weight;c+=e.weight*r})),c}var lc=function(e,n){return lu.map(n,function(n){var r=e.inEdges(n);if(r.length){var t=lu.reduce(r,function(n,r){var t=e.edge(r),o=e.node(r.v);return{sum:n.sum+t.weight*o.order,weight:n.weight+t.weight}},{sum:0,weight:0});return{v:n,barycenter:t.sum/t.weight,weight:t.weight}}return{v:n}})};var pc=function(e,n){var r={};return lu.forEach(e,function(e,n){var t=r[e.v]={indegree:0,in:[],out:[],vs:[e.v],i:n};lu.isUndefined(e.barycenter)||(t.barycenter=e.barycenter,t.weight=e.weight)}),lu.forEach(n.edges(),function(e){var n=r[e.v],t=r[e.w];lu.isUndefined(n)||lu.isUndefined(t)||(t.indegree++,n.out.push(r[e.w]))}),function(e){var n=[];function r(e){return function(n){var r,t,o,i;n.merged||(lu.isUndefined(n.barycenter)||lu.isUndefined(e.barycenter)||n.barycenter>=e.barycenter)&&(t=n,o=0,i=0,(r=e).weight&&(o+=r.barycenter*r.weight,i+=r.weight),t.weight&&(o+=t.barycenter*t.weight,i+=t.weight),r.vs=t.vs.concat(r.vs),r.barycenter=o/i,r.weight=i,r.i=Math.min(t.i,r.i),t.merged=!0)}}function t(n){return function(r){r.in.push(n),0==--r.indegree&&e.push(r)}}for(;e.length;){var o=e.pop();n.push(o),lu.forEach(o.in.reverse(),r(o)),lu.forEach(o.out,t(o))}return lu.map(lu.filter(n,function(e){return!e.merged}),function(e){return lu.pick(e,["vs","i","barycenter","weight"])})}(lu.filter(r,function(e){return!e.indegree}))};var gc=function(e,n){var r=Nu.partition(e,function(e){return lu.has(e,"barycenter")}),t=r.lhs,o=lu.sortBy(r.rhs,function(e){return-e.i}),i=[],a=0,u=0,c=0;t.sort((s=!!n,function(e,n){return e.barycenter<n.barycenter?-1:e.barycenter>n.barycenter?1:s?n.i-e.i:e.i-n.i})),c=yc(i,o,c),lu.forEach(t,function(e){c+=e.vs.length,i.push(e.vs),a+=e.barycenter*e.weight,u+=e.weight,c=yc(i,o,c)});var s;var f={vs:lu.flatten(i,!0)};u&&(f.barycenter=a/u,f.weight=u);return f};function yc(e,n,r){for(var t;n.length&&(t=lu.last(n)).i<=r;)n.pop(),e.push(t.vs),r++;return r}var bc=function e(n,r,t,o){var i=n.children(r);var a=n.node(r);var u=a?a.borderLeft:void 0;var c=a?a.borderRight:void 0;var s={};u&&(i=lu.filter(i,function(e){return e!==u&&e!==c}));var f=lc(n,i);lu.forEach(f,function(r){if(n.children(r.v).length){var i=e(n,r.v,t,o);s[r.v]=i,lu.has(i,"barycenter")&&(a=r,u=i,lu.isUndefined(a.barycenter)?(a.barycenter=u.barycenter,a.weight=u.weight):(a.barycenter=(a.barycenter*a.weight+u.barycenter*u.weight)/(a.weight+u.weight),a.weight+=u.weight))}var a,u});var d=pc(f,t);!function(e,n){lu.forEach(e,function(e){e.vs=lu.flatten(e.vs.map(function(e){return n[e]?n[e].vs:e}),!0)})}(d,s);var h=gc(d,o);if(u&&(h.vs=lu.flatten([u,h.vs,c],!0),n.predecessors(u).length)){var v=n.node(n.predecessors(u)[0]),l=n.node(n.predecessors(c)[0]);lu.has(h,"barycenter")||(h.barycenter=0,h.weight=0),h.barycenter=(h.barycenter*h.weight+v.order+l.order)/(h.weight+2),h.weight+=2}return h};var mc=oa.Graph,_c=function(e,n,r){var t=function(e){var n;for(;e.hasNode(n=lu.uniqueId("_root")););return n}(e),o=new mc({compound:!0}).setGraph({root:t}).setDefaultNodeLabel(function(n){return e.node(n)});return lu.forEach(e.nodes(),function(i){var a=e.node(i),u=e.parent(i);(a.rank===n||a.minRank<=n&&n<=a.maxRank)&&(o.setNode(i),o.setParent(i,u||t),lu.forEach(e[r](i),function(n){var r=n.v===i?n.w:n.v,t=o.edge(r,i),a=lu.isUndefined(t)?0:t.weight;o.setEdge(r,i,{weight:e.edge(n).weight+a})}),lu.has(a,"minRank")&&o.setNode(i,{borderLeft:a.borderLeft[n],borderRight:a.borderRight[n]}))}),o};var wc=function(e,n,r){var t,o={};lu.forEach(r,function(r){for(var i,a,u=e.parent(r);u;){if((i=e.parent(u))?(a=o[i],o[i]=u):(a=t,t=u),a&&a!==u)return void n.setEdge(a,u);u=i}})};var Ec=oa.Graph,jc=function(e){var n=Nu.maxRank(e),r=kc(e,lu.range(1,n+1),"inEdges"),t=kc(e,lu.range(n-1,-1,-1),"outEdges"),o=dc(e);Nc(e,o);for(var i,a=Number.POSITIVE_INFINITY,u=0,c=0;c<4;++u,++c){xc(u%2?r:t,u%4>=2),o=Nu.buildLayerMatrix(e);var s=hc(e,o);s<a&&(c=0,i=lu.cloneDeep(o),a=s)}Nc(e,i)};function kc(e,n,r){return lu.map(n,function(n){return _c(e,n,r)})}function xc(e,n){var r=new Ec;lu.forEach(e,function(e){var t=e.graph().root,o=bc(e,t,r,n);lu.forEach(o.vs,function(n,r){e.node(n).order=r}),wc(e,r,o.vs)})}function Nc(e,n){lu.forEach(n,function(n){lu.forEach(n,function(n,r){e.node(n).order=r})})}var Oc=oa.Graph,Ic=function(e){var n,r=Nu.buildLayerMatrix(e),t=lu.merge(Ac(e,r),Cc(e,r)),o={};lu.forEach(["u","d"],function(i){n="u"===i?r:lu.values(r).reverse(),lu.forEach(["l","r"],function(r){"r"===r&&(n=lu.map(n,function(e){return lu.values(e).reverse()}));var a=("u"===i?e.predecessors:e.successors).bind(e),u=Pc(e,n,t,a),c=Lc(e,n,u.root,u.align,"r"===r);"r"===r&&(c=lu.mapValues(c,function(e){return-e})),o[i+r]=c})});var i=Tc(e,o);return Fc(o,i),Rc(o,e.graph().align)};function Ac(e,n){var r={};return lu.reduce(n,function(n,t){var o=0,i=0,a=n.length,u=lu.last(t);return lu.forEach(t,function(n,c){var s=function(e,n){if(e.node(n).dummy)return lu.find(e.predecessors(n),function(n){return e.node(n).dummy})}(e,n),f=s?e.node(s).order:a;(s||n===u)&&(lu.forEach(t.slice(i,c+1),function(n){lu.forEach(e.predecessors(n),function(t){var i=e.node(t),a=i.order;!(a<o||f<a)||i.dummy&&e.node(n).dummy||Mc(r,t,n)})}),i=c+1,o=f)}),t}),r}function Cc(e,n){var r={};function t(n,t,o,i,a){var u;lu.forEach(lu.range(t,o),function(t){u=n[t],e.node(u).dummy&&lu.forEach(e.predecessors(u),function(n){var t=e.node(n);t.dummy&&(t.order<i||t.order>a)&&Mc(r,n,u)})})}return lu.reduce(n,function(n,r){var o,i=-1,a=0;return lu.forEach(r,function(u,c){if("border"===e.node(u).dummy){var s=e.predecessors(u);s.length&&(o=e.node(s[0]).order,t(r,a,c,i,o),a=c,i=o)}t(r,a,r.length,o,n.length)}),r}),r}function Mc(e,n,r){if(n>r){var t=n;n=r,r=t}var o=e[n];o||(e[n]=o={}),o[r]=!0}function Sc(e,n,r){if(n>r){var t=n;n=r,r=t}return lu.has(e[n],r)}function Pc(e,n,r,t){var o={},i={},a={};return lu.forEach(n,function(e){lu.forEach(e,function(e,n){o[e]=e,i[e]=e,a[e]=n})}),lu.forEach(n,function(e){var n=-1;lu.forEach(e,function(e){var u=t(e);if(u.length)for(var c=((u=lu.sortBy(u,function(e){return a[e]})).length-1)/2,s=Math.floor(c),f=Math.ceil(c);s<=f;++s){var d=u[s];i[e]===e&&n<a[d]&&!Sc(r,e,d)&&(i[d]=e,i[e]=o[e]=o[d],n=a[d])}})}),{root:o,align:i}}function Lc(e,n,r,t,o){var i={},a=function(e,n,r,t){var o=new Oc,i=e.graph(),a=function(e,n,r){return function(t,o,i){var a,u=t.node(o),c=t.node(i),s=0;if(s+=u.width/2,lu.has(u,"labelpos"))switch(u.labelpos.toLowerCase()){case"l":a=-u.width/2;break;case"r":a=u.width/2}if(a&&(s+=r?a:-a),a=0,s+=(u.dummy?n:e)/2,s+=(c.dummy?n:e)/2,s+=c.width/2,lu.has(c,"labelpos"))switch(c.labelpos.toLowerCase()){case"l":a=c.width/2;break;case"r":a=-c.width/2}return a&&(s+=r?a:-a),a=0,s}}(i.nodesep,i.edgesep,t);return lu.forEach(n,function(n){var t;lu.forEach(n,function(n){var i=r[n];if(o.setNode(i),t){var u=r[t],c=o.edge(u,i);o.setEdge(u,i,Math.max(a(e,n,t),c||0))}t=n})}),o}(e,n,r,o),u=o?"borderLeft":"borderRight";function c(e,n){for(var r=a.nodes(),t=r.pop(),o={};t;)o[t]?e(t):(o[t]=!0,r.push(t),r=r.concat(n(t))),t=r.pop()}return c(function(e){i[e]=a.inEdges(e).reduce(function(e,n){return Math.max(e,i[n.v]+a.edge(n))},0)},a.predecessors.bind(a)),c(function(n){var r=a.outEdges(n).reduce(function(e,n){return Math.min(e,i[n.w]-a.edge(n))},Number.POSITIVE_INFINITY),t=e.node(n);r!==Number.POSITIVE_INFINITY&&t.borderType!==u&&(i[n]=Math.max(i[n],r))},a.successors.bind(a)),lu.forEach(t,function(e){i[e]=i[r[e]]}),i}function Tc(e,n){return lu.minBy(lu.values(n),function(n){var r=Number.NEGATIVE_INFINITY,t=Number.POSITIVE_INFINITY;return lu.forIn(n,function(n,o){var i=function(e,n){return e.node(n).width}(e,o)/2;r=Math.max(n+i,r),t=Math.min(n-i,t)}),r-t})}function Fc(e,n){var r=lu.values(n),t=lu.min(r),o=lu.max(r);lu.forEach(["u","d"],function(r){lu.forEach(["l","r"],function(i){var a,u=r+i,c=e[u];if(c!==n){var s=lu.values(c);(a="l"===i?t-lu.min(s):o-lu.max(s))&&(e[u]=lu.mapValues(c,function(e){return e+a}))}})})}function Rc(e,n){return lu.mapValues(e.ul,function(r,t){if(n)return e[n.toLowerCase()][t];var o=lu.sortBy(lu.map(e,t));return(o[1]+o[2])/2})}var zc=Ic,Dc=function(e){(function(e){var n=Nu.buildLayerMatrix(e),r=e.graph().ranksep,t=0;lu.forEach(n,function(n){var o=lu.max(lu.map(n,function(n){return e.node(n).height}));lu.forEach(n,function(n){e.node(n).y=t+o/2}),t+=o+r})})(e=Nu.asNonCompoundGraph(e)),lu.forEach(zc(e),function(n,r){e.node(r).x=n})};var Uc=Nu.normalizeRanks,Bc=Nu.removeEmptyRanks,Gc=Nu,Vc=oa.Graph,qc=function(e,n){var r=n&&n.debugTiming?Gc.time:Gc.notime;r("layout",function(){var n=r("  buildLayoutGraph",function(){return function(e){var n=new Vc({multigraph:!0,compound:!0}),r=es(e.graph());return n.setGraph(lu.merge({},$c,Zc(r,Yc),lu.pick(r,Wc))),lu.forEach(e.nodes(),function(r){var t=es(e.node(r));n.setNode(r,lu.defaults(Zc(t,Kc),Jc)),n.setParent(r,e.parent(r))}),lu.forEach(e.edges(),function(r){var t=es(e.edge(r));n.setEdge(r,lu.merge({},Hc,Zc(t,Qc),lu.pick(t,Xc)))}),n}(e)});r("  runLayout",function(){!function(e,n){n("    makeSpaceForEdgeLabels",function(){!function(e){var n=e.graph();n.ranksep/=2,lu.forEach(e.edges(),function(r){var t=e.edge(r);t.minlen*=2,"c"!==t.labelpos.toLowerCase()&&("TB"===n.rankdir||"BT"===n.rankdir?t.width+=t.labeloffset:t.height+=t.labeloffset)})}(e)}),n("    removeSelfEdges",function(){!function(e){lu.forEach(e.edges(),function(n){if(n.v===n.w){var r=e.node(n.v);r.selfEdges||(r.selfEdges=[]),r.selfEdges.push({e:n,label:e.edge(n)}),e.removeEdge(n)}})}(e)}),n("    acyclic",function(){ku.run(e)}),n("    nestingGraph.run",function(){tc.run(e)}),n("    rank",function(){Zu(Gc.asNonCompoundGraph(e))}),n("    injectEdgeLabelProxies",function(){!function(e){lu.forEach(e.edges(),function(n){var r=e.edge(n);if(r.width&&r.height){var t=e.node(n.v),o=e.node(n.w),i={rank:(o.rank-t.rank)/2+t.rank,e:n};Gc.addDummyNode(e,"edge-proxy",i,"_ep")}})}(e)}),n("    removeEmptyRanks",function(){Bc(e)}),n("    nestingGraph.cleanup",function(){tc.cleanup(e)}),n("    normalizeRanks",function(){Uc(e)}),n("    assignRankMinMax",function(){!function(e){var n=0;lu.forEach(e.nodes(),function(r){var t=e.node(r);t.borderTop&&(t.minRank=e.node(t.borderTop).rank,t.maxRank=e.node(t.borderBottom).rank,n=lu.max(n,t.maxRank))}),e.graph().maxRank=n}(e)}),n("    removeEdgeLabelProxies",function(){!function(e){lu.forEach(e.nodes(),function(n){var r=e.node(n);"edge-proxy"===r.dummy&&(e.edge(r.e).labelRank=r.rank,e.removeNode(n))})}(e)}),n("    normalize.run",function(){Au.run(e)}),n("    parentDummyChains",function(){rc(e)}),n("    addBorderSegments",function(){oc(e)}),n("    order",function(){jc(e)}),n("    insertSelfEdges",function(){!function(e){var n=Gc.buildLayerMatrix(e);lu.forEach(n,function(n){var r=0;lu.forEach(n,function(n,t){var o=e.node(n);o.order=t+r,lu.forEach(o.selfEdges,function(n){Gc.addDummyNode(e,"selfedge",{width:n.label.width,height:n.label.height,rank:o.rank,order:t+ ++r,e:n.e,label:n.label},"_se")}),delete o.selfEdges})})}(e)}),n("    adjustCoordinateSystem",function(){ac.adjust(e)}),n("    position",function(){Dc(e)}),n("    positionSelfEdges",function(){!function(e){lu.forEach(e.nodes(),function(n){var r=e.node(n);if("selfedge"===r.dummy){var t=e.node(r.e.v),o=t.x+t.width/2,i=t.y,a=r.x-o,u=t.height/2;e.setEdge(r.e,r.label),e.removeNode(n),r.label.points=[{x:o+2*a/3,y:i-u},{x:o+5*a/6,y:i-u},{x:o+a,y:i},{x:o+5*a/6,y:i+u},{x:o+2*a/3,y:i+u}],r.label.x=r.x,r.label.y=r.y}})}(e)}),n("    removeBorderNodes",function(){!function(e){lu.forEach(e.nodes(),function(n){if(e.children(n).length){var r=e.node(n),t=e.node(r.borderTop),o=e.node(r.borderBottom),i=e.node(lu.last(r.borderLeft)),a=e.node(lu.last(r.borderRight));r.width=Math.abs(a.x-i.x),r.height=Math.abs(o.y-t.y),r.x=i.x+r.width/2,r.y=t.y+r.height/2}}),lu.forEach(e.nodes(),function(n){"border"===e.node(n).dummy&&e.removeNode(n)})}(e)}),n("    normalize.undo",function(){Au.undo(e)}),n("    fixupEdgeLabelCoords",function(){!function(e){lu.forEach(e.edges(),function(n){var r=e.edge(n);if(lu.has(r,"x"))switch("l"!==r.labelpos&&"r"!==r.labelpos||(r.width-=r.labeloffset),r.labelpos){case"l":r.x-=r.width/2+r.labeloffset;break;case"r":r.x+=r.width/2+r.labeloffset}})}(e)}),n("    undoCoordinateSystem",function(){ac.undo(e)}),n("    translateGraph",function(){!function(e){var n=Number.POSITIVE_INFINITY,r=0,t=Number.POSITIVE_INFINITY,o=0,i=e.graph(),a=i.marginx||0,u=i.marginy||0;function c(e){var i=e.x,a=e.y,u=e.width,c=e.height;n=Math.min(n,i-u/2),r=Math.max(r,i+u/2),t=Math.min(t,a-c/2),o=Math.max(o,a+c/2)}lu.forEach(e.nodes(),function(n){c(e.node(n))}),lu.forEach(e.edges(),function(n){var r=e.edge(n);lu.has(r,"x")&&c(r)}),n-=a,t-=u,lu.forEach(e.nodes(),function(r){var o=e.node(r);o.x-=n,o.y-=t}),lu.forEach(e.edges(),function(r){var o=e.edge(r);lu.forEach(o.points,function(e){e.x-=n,e.y-=t}),lu.has(o,"x")&&(o.x-=n),lu.has(o,"y")&&(o.y-=t)}),i.width=r-n+a,i.height=o-t+u}(e)}),n("    assignNodeIntersects",function(){!function(e){lu.forEach(e.edges(),function(n){var r,t,o=e.edge(n),i=e.node(n.v),a=e.node(n.w);o.points?(r=o.points[0],t=o.points[o.points.length-1]):(o.points=[],r=a,t=i),o.points.unshift(Gc.intersectRect(i,r)),o.points.push(Gc.intersectRect(a,t))})}(e)}),n("    reversePoints",function(){!function(e){lu.forEach(e.edges(),function(n){var r=e.edge(n);r.reversed&&r.points.reverse()})}(e)}),n("    acyclic.undo",function(){ku.undo(e)})}(n,r)}),r("  updateInputGraph",function(){!function(e,n){lu.forEach(e.nodes(),function(r){var t=e.node(r),o=n.node(r);t&&(t.x=o.x,t.y=o.y,n.children(r).length&&(t.width=o.width,t.height=o.height))}),lu.forEach(e.edges(),function(r){var t=e.edge(r),o=n.edge(r);t.points=o.points,lu.has(o,"x")&&(t.x=o.x,t.y=o.y)}),e.graph().width=n.graph().width,e.graph().height=n.graph().height}(e,n)})})};var Yc=["nodesep","edgesep","ranksep","marginx","marginy"],$c={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},Wc=["acyclicer","ranker","rankdir","align"],Kc=["width","height"],Jc={width:0,height:0},Qc=["minlen","weight","width","height","labeloffset"],Hc={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},Xc=["labelpos"];function Zc(e,n){return lu.mapValues(lu.pick(e,n),Number)}function es(e){var n={};return lu.forEach(e,function(e,r){n[r.toLowerCase()]=e}),n}var ns=oa.Graph;var rs={graphlib:oa,layout:qc,debug:{debugOrdering:function(e){var n=Nu.buildLayerMatrix(e),r=new ns({compound:!0,multigraph:!0}).setGraph({});return lu.forEach(e.nodes(),function(n){r.setNode(n,{label:n}),r.setParent(n,"layer"+e.node(n).rank)}),lu.forEach(e.edges(),function(e){r.setEdge(e.v,e.w,{},e.name)}),lu.forEach(n,function(e,n){var t="layer"+n;r.setNode(t,{rank:"same"}),lu.reduce(e,function(e,n){return r.setEdge(e,n,{style:"invis"}),n})}),r}},util:{time:Nu.time,notime:Nu.notime},version:"0.8.5"},ts=rs.graphlib,os=rs.layout;n(function(n,r){n.exports=function(){function n(e){return"function"==typeof e}var r=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},t=0,o=void 0,i=void 0,a=function(e,n){v[t]=e,v[t+1]=n,2===(t+=2)&&(i?i(l):m())},u="undefined"!=typeof window?window:void 0,c=u||{},s=c.MutationObserver||c.WebKitMutationObserver,f="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),d="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function h(){var e=setTimeout;return function(){return e(l,1)}}var v=new Array(1e3);function l(){for(var e=0;e<t;e+=2){var n=v[e],r=v[e+1];n(r),v[e]=void 0,v[e+1]=void 0}t=0}var p,g,y,b,m=void 0;function _(e,n){var r=this,t=new this.constructor(j);void 0===t[E]&&F(t);var o=r._state;if(o){var i=arguments[o-1];a(function(){return L(o,t,i,r._result)})}else S(r,t,e,n);return t}function w(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var n=new this(j);return I(n,e),n}f?m=function(){return process.nextTick(l)}:s?(g=0,y=new s(l),b=document.createTextNode(""),y.observe(b,{characterData:!0}),m=function(){b.data=g=++g%2}):d?((p=new MessageChannel).port1.onmessage=l,m=function(){return p.port2.postMessage(0)}):m=void 0===u?function(){try{var e=Function("return this")().require("vertx");return void 0!==(o=e.runOnLoop||e.runOnContext)?function(){o(l)}:h()}catch(e){return h()}}():h();var E=Math.random().toString(36).substring(2);function j(){}var k=void 0,x=1,N=2;function O(e,r,t){r.constructor===e.constructor&&t===_&&r.constructor.resolve===w?function(e,n){n._state===x?C(e,n._result):n._state===N?M(e,n._result):S(n,void 0,function(n){return I(e,n)},function(n){return M(e,n)})}(e,r):void 0===t?C(e,r):n(t)?function(e,n,r){a(function(e){var t=!1,o=function(e,n,r,t){try{e.call(n,r,t)}catch(e){return e}}(r,n,function(r){t||(t=!0,n!==r?I(e,r):C(e,r))},function(n){t||(t=!0,M(e,n))},e._label);!t&&o&&(t=!0,M(e,o))},e)}(e,r,t):C(e,r)}function I(e,n){if(e===n)M(e,new TypeError("You cannot resolve a promise with itself"));else if(o=typeof(t=n),null===t||"object"!==o&&"function"!==o)C(e,n);else{var r=void 0;try{r=n.then}catch(n){return void M(e,n)}O(e,n,r)}var t,o}function A(e){e._onerror&&e._onerror(e._result),P(e)}function C(e,n){e._state===k&&(e._result=n,e._state=x,0!==e._subscribers.length&&a(P,e))}function M(e,n){e._state===k&&(e._state=N,e._result=n,a(A,e))}function S(e,n,r,t){var o=e._subscribers,i=o.length;e._onerror=null,o[i]=n,o[i+x]=r,o[i+N]=t,0===i&&e._state&&a(P,e)}function P(e){var n=e._subscribers,r=e._state;if(0!==n.length){for(var t=void 0,o=void 0,i=e._result,a=0;a<n.length;a+=3)t=n[a],o=n[a+r],t?L(r,t,o,i):o(i);e._subscribers.length=0}}function L(e,r,t,o){var i=n(t),a=void 0,u=void 0,c=!0;if(i){try{a=t(o)}catch(e){c=!1,u=e}if(r===a)return void M(r,new TypeError("A promises callback cannot return that same promise."))}else a=o;r._state!==k||(i&&c?I(r,a):!1===c?M(r,u):e===x?C(r,a):e===N&&M(r,a))}var T=0;function F(e){e[E]=T++,e._state=void 0,e._result=void 0,e._subscribers=[]}var R=function(){function e(e,n){this._instanceConstructor=e,this.promise=new e(j),this.promise[E]||F(this.promise),r(n)?(this.length=n.length,this._remaining=n.length,this._result=new Array(this.length),0===this.length?C(this.promise,this._result):(this.length=this.length||0,this._enumerate(n),0===this._remaining&&C(this.promise,this._result))):M(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var n=0;this._state===k&&n<e.length;n++)this._eachEntry(e[n],n)},e.prototype._eachEntry=function(e,n){var r=this._instanceConstructor,t=r.resolve;if(t===w){var o=void 0,i=void 0,a=!1;try{o=e.then}catch(e){a=!0,i=e}if(o===_&&e._state!==k)this._settledAt(e._state,n,e._result);else if("function"!=typeof o)this._remaining--,this._result[n]=e;else if(r===z){var u=new r(j);a?M(u,i):O(u,e,o),this._willSettleAt(u,n)}else this._willSettleAt(new r(function(n){return n(e)}),n)}else this._willSettleAt(t(e),n)},e.prototype._settledAt=function(e,n,r){var t=this.promise;t._state===k&&(this._remaining--,e===N?M(t,r):this._result[n]=r),0===this._remaining&&C(t,this._result)},e.prototype._willSettleAt=function(e,n){var r=this;S(e,void 0,function(e){return r._settledAt(x,n,e)},function(e){return r._settledAt(N,n,e)})},e}(),z=function(){function e(n){this[E]=T++,this._result=this._state=void 0,this._subscribers=[],j!==n&&("function"!=typeof n&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(e,n){try{n(function(n){I(e,n)},function(n){M(e,n)})}catch(n){M(e,n)}}(this,n):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(e){return this.then(null,e)},e.prototype.finally=function(e){var r=this.constructor;return n(e)?this.then(function(n){return r.resolve(e()).then(function(){return n})},function(n){return r.resolve(e()).then(function(){throw n})}):this.then(e,e)},e}();return z.prototype.then=_,z.all=function(e){return new R(this,e).promise},z.race=function(e){var n=this;return r(e)?new n(function(r,t){for(var o=e.length,i=0;i<o;i++)n.resolve(e[i]).then(r,t)}):new n(function(e,n){return n(new TypeError("You must pass an array to race."))})},z.resolve=w,z.reject=function(e){var n=new this(j);return M(n,e),n},z._setScheduler=function(e){i=e},z._setAsap=function(e){a=e},z._asap=a,z.polyfill=function(){var n=void 0;if(void 0!==e)n=e;else if("undefined"!=typeof self)n=self;else try{n=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var r=n.Promise;if(r){var t=null;try{t=Object.prototype.toString.call(r.resolve())}catch(e){}if("[object Promise]"===t&&!r.cast)return}n.Promise=z},z.Promise=z,z}()}).polyfill();self.onmessage=function(e){var n=function(e,n){var r=e.subgraphs,t=e.nodes,o=e.links,i=e.hierarchy,a=new ts.Graph({multigraph:!0,compound:!0}).setGraph(n).setDefaultNodeLabel(function(){return{}}).setDefaultEdgeLabel(function(){return{}});r.forEach(function(e){a.setNode(e.id,e)}),t.forEach(function(e){a.setNode(e.id,e)}),o.forEach(function(e){a.setEdge(e.source.id,e.target.id,e,e.id)}),i.forEach(function(e){a.setParent(e.child,e.parent)}),os(a,{debugTiming:!1});var u=-a.graph().width/2||0,c=-a.graph().height/2;return a.nodes().forEach(function(e){var n=a.node(e);n.x+=u,n.y+=c}),a.edges().forEach(function(e){var n=a.edge(e);n.points=n.points.map(function(e){return[e.x+u,e.y+c]})}),{subgraphs:r,nodes:t,links:o}}.apply(void 0,e.data);self.postMessage(n)}}();`;

        const workerBlob = new Blob([workerCode], { type: "application/javascript" });
        const workerUrl = URL.createObjectURL(workerBlob);
        const worker = new Worker(workerUrl);

        worker.onmessage = event => {
            resolve(event.data);
            worker.terminate();
            URL.revokeObjectURL(workerUrl);
        };
        worker.postMessage([data, options]);
    });
}
