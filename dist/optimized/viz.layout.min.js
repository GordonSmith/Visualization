typeof define=="function"&&define.amd&&define("css",[],function(){return{load:function(e,t,n){n()}}}),function(e,t){typeof define=="function"&&define.amd?define("layout/Surface.js",["../common/HTMLWidget","../chart/MultiChart","../c3/Column","../c3/Line","css!./Surface"],t):e.layout_Surface=t(e.common_HTMLWidget,e.chart_MultiChart,e.c3_Column,e.c3_Line)}(this,function(e,t,n,r){function i(){e.call(this),this._class="layout_Surface",this._tag="div"}return i.prototype=Object.create(e.prototype),i.prototype.publish("title","","string","Title"),i.prototype.publish("widget",null,"widget","Widget"),i.prototype.testData=function(){return this.title("ABC"),this.widget((new i).widget((new t).testData())),this},i.prototype.enter=function(t,n){e.prototype.enter.apply(this,arguments)},i.prototype.update=function(t,n){e.prototype.update.apply(this,arguments);var r=n.selectAll(".surfaceTitle").data(this._title?[this._title]:[]);r.enter().insert("h3","div").attr("class","surfaceTitle"),r.text(function(e){return e}),r.exit().remove();var i=n.selectAll("#"+this._id+" > .surfaceWidget").data(this._widget?[this._widget]:[],function(e){return e._id}),s=this;i.enter().append("div").attr("class","surfaceWidget").each(function(e){e.target(this)}),i.each(function(e){var t=s.clientWidth(),r=s.clientHeight();s._title&&(r-=s.calcHeight(n.select("h3")));var i=d3.select(this);r-=s.calcFrameHeight(i),t-=s.calcFrameWidth(i),e.resize({width:t,height:r})}),i.exit().each(function(e){e.target(null)}).remove()},i.prototype.exit=function(t,n){this._widget&&(this._widget=null,this.render()),e.prototype.exit.apply(this,arguments)},i.prototype.render=function(t){var n=this;e.prototype.render.call(this,function(e){n._widget?n._widget.render(function(e){t&&t(e)}):t&&t(e)})},i}),function(e,t){typeof define=="function"&&define.amd?define("layout/Cell",["./Surface","../chart/Pie","../c3/Column","../c3/Line","css!./Cell"],t):e.layout_Cell=t(e.layout_Surface,e.chart_Pie,e.c3_Column,e.c3_Line)}(this,function(e,t,n,r){function i(){e.call(this),this._class="layout_Cell"}return i.prototype=Object.create(e.prototype),i.prototype.publish("gridRow",0,"number","Grid Row Position"),i.prototype.publish("gridCol",0,"number","Grid Column Position"),i.prototype.publish("gridRowSpan",1,"number","Grid Row Span"),i.prototype.publish("gridColSpan",1,"number","Grid Column Span"),i.prototype.enter=function(t,n){e.prototype.enter.apply(this,arguments),n.classed("layout_Surface",!0)},i}),function(e,t){typeof define=="function"&&define.amd?define("layout/Grid.js",["../common/HTMLWidget","./Cell","../common/Text","../chart/Pie","../chart/MultiChart","../c3/Column","../c3/Line","css!./Grid"],t):e.layout_Grid=t(e.common_HTMLWidget,e.layout_Cell,e.common_Text,e.chart_Pie,e.chart_MultiChart,e.c3_Column,e.c3_Line)}(this,function(e,t,n,r,i,s,o){function u(){e.call(this),this._class="layout_Grid",this._tag="div",this._content=[]}return u.prototype=Object.create(e.prototype),u.prototype.publish("gutter",4,"number","Gap Between Widgets"),u.prototype.publish("fitTo","all","set","Sizing Strategy",["all","width"]),u.prototype.publish("content",[],"widgetArray","widgets"),u.prototype.testData=function(){return this.setContent(0,0,(new r).testData()),this.setContent(0,1,(new r).testData()),this.setContent(1,0,(new r).testData()),this.setContent(1,1,(new r).testData()),this.setContent(0,2,(new i).testData(),"Title AAA",2,2),this.setContent(2,0,(new o).testData(),"Title BBB",2,4),this},u.prototype.getDimensions=function(){var e={width:0,height:0};return this._content.forEach(function(t){e.width<t.gridCol()+t.gridColSpan()&&(e.width=t.gridCol()+t.gridColSpan()),e.height<t.gridRow()+t.gridRowSpan()&&(e.height=t.gridRow()+t.gridRowSpan())},this),e},u.prototype.clearContent=function(){this._content=this._content.filter(function(e){return e.target(null),!1})},u.prototype.setContent=function(e,n,r,i,s,o){s=s||1,o=o||1,i=i||"",this._content=this._content.filter(function(t){return t._gridRow===e&&t._gridCol===n?(t.target(null),!1):!0});if(r){var u=(new t).gridRow(e).gridCol(n).widget(r).title(i).gridRowSpan(s).gridColSpan(o);this._content.push(u)}return this},u.prototype.getContent=function(e){var t=null;return this._content.some(function(n){return n._widget._id===e?(t=n._widget,!0):!1}),t},u.prototype.childMoved=u.prototype.debounce(function(e,t){this.render()},250),u.prototype.enter=function(t,n){e.prototype.enter.apply(this,arguments),n.style("position","relative"),this._scrollBarWidth=this.getScrollbarWidth()},u.prototype.update=function(t,n){e.prototype.update.apply(this,arguments),this._parentElement.style("overflow-x",this._fitTo==="width"?"hidden":null),this._parentElement.style("overflow-y",this._fitTo==="width"?"scroll":null);var r=this.getDimensions(),i=(this.width()-(this._fitTo==="width"?this._scrollBarWidth:0))/r.width,s=this._fitTo==="all"?this.height()/r.height:i,o=this,u=n.selectAll(".cell_"+this._id).data(this._content,function(e){return e._id});u.enter().append("div").attr("class","cell_"+this._id).style("position","absolute").each(function(e){e.target(this),e.__grid_watch=e.watch(function(e,t,n){o._renderCount&&e.indexOf("grid")===0&&t!==n&&o.childMoved()})}),u.style("left",function(e){return e.gridCol()*i+o._gutter/2+"px"}).style("top",function(e){return e.gridRow()*s+o._gutter/2+"px"}).style("width",function(e){return e.gridColSpan()*i-o._gutter+"px"}).style("height",function(e){return e.gridRowSpan()*s-o._gutter+"px"}).each(function(e){e.resize()}),u.exit().each(function(e){e.target(null),e.__grid_watch&&e.__grid_watch.remove()}).remove()},u.prototype.exit=function(t,n){e.prototype.exit.apply(this,arguments)},u.prototype.render=function(t){var n=this;return e.prototype.render.call(this,function(e){if(n._content.length){var r=n._content.length;n._content.forEach(function(n,i){setTimeout(function(){n.render(function(){--r===0&&t&&t(e)})},0)})}else t&&t(e)}),this},u});