(function(e,t){typeof define=="function"&&define.amd?define("tree/ITree.js",["../common/Palette"],t):e.tree_ITree=t(e.common_Palette)})(this,function(e){function t(){}return t.prototype._palette=e.ordinal("default"),t.prototype.testData=function(){var e={label:"root",children:[{label:"A",children:[{label:"AA",children:[{label:"AAA"}]},{label:"AB",children:[{label:"ABA"}]}]},{label:"B",children:[{label:"BA",children:[{label:"BAA"}]},{label:"BB"}]}]};return this.data(e),this},t.prototype.click=function(e){console.log("Click:  "+e.label)},t}),typeof define=="function"&&define.amd&&define("css",[],function(){return{load:function(e,t,n){n()}}}),function(e,t){typeof define=="function"&&define.amd?define("tree/CirclePacking.js",["d3/d3","../common/SVGWidget","./ITree","../common/Text","../common/FAChar","css!./CirclePacking"],t):e.tree_CirclePacking=t(e.d3,e.common_SVGWidget,e.tree_ITree,e.common_Text,e.common_FAChar)}(this,function(e,t,n,r,i){function s(e){t.call(this),n.call(this),this._class="tree_CirclePacking"}return s.prototype=Object.create(t.prototype),s.prototype.implements(n.prototype),s.prototype.publish("paletteID","default","set","Palette ID",s.prototype._palette.switch()),s.prototype.enter=function(t,n){var r=this;this.diameter=Math.min(this.width(),this.height()),this.pack=e.layout.pack().size([this.diameter-4,this.diameter-4]).value(function(e){return 1}),this.svg=n.append("g").attr("transform","rotate(30)")},s.prototype.update=function(t,n){var r=this;this._palette=this._palette.switch(this._paletteID),this.svg.selectAll("circle").remove(),this.svg.selectAll("text").remove();var i=this._data,s=i,o=this.pack.nodes(i);this.circle=this.svg.selectAll("circle").data(o).enter().append("circle").attr("class",function(e){return e.parent?e.children?"node":"node leaf":"node root"}).style("fill",function(e){return r._palette(e.label)}).on("click",function(e){r.click(e)}).on("dblclick",function(t){s!==t&&(r.zoom(t),e.event.stopPropagation())}),this.circle.append("title").text(function(e){return e.label});var u=this.svg.selectAll("text").data(o).enter().append("text").attr("class","label").style("fill-opacity",function(e){return e.parent===i?1:0}).style("display",function(e){return e.parent===i?null:"none"}).text(function(e){return e.label});this.node=this.svg.selectAll("circle,text"),this.zoomTo([i.x,i.y,i.r*2])},s.prototype.zoom=function(t){var n=this,r=i,i=t,s=this.svg.selectAll("circle").filter(function(e){return e===i}),o=this.svg.selectAll("text").filter(function(e){return e!==i&&this.style.display==="inline"});o.transition().duration(500).style("opacity",0).each("end",function(t){t!==i&&e.select(this).style("display","none").style("opacity",1)});var u=this.svg.transition().duration(1e3).tween("zoom",function(t){var r=e.interpolateZoom(n.view,[i.x,i.y,i.r*2]);return function(e){n.zoomTo(r(e))}});u.selectAll("text").filter(function(e){return e.parent===i||this.style.display==="inline"}).style("fill-opacity",function(e){return e.parent===i?1:0}).each("start",function(e){e.parent===i&&(this.style.display="inline")}).each("end",function(e){e.parent!==i&&(this.style.display="none")})},s.prototype.zoomTo=function(e){var t=this.diameter/e[2];this.view=e,this.node.attr("transform",function(n){return"translate("+(n.x-e[0])*t+","+(n.y-e[1])*t+")rotate(-30)"}),this.circle.attr("r",function(e){return e.r*t})},s}),function(e,t){typeof define=="function"&&define.amd?define("tree/Dendrogram.js",["d3/d3","../common/SVGWidget","./ITree","css!./Dendrogram"],t):e.tree_Dendrogram=t(e.d3,e.common_SVGWidget,e.tree_ITree)}(this,function(e,t,n){function r(e){t.call(this),n.call(this),this._class="tree_Dendrogram",this._drawStartPos="origin",this._maxTextWidth=0}return r.prototype=Object.create(t.prototype),r.prototype.implements(n.prototype),r.prototype.publish("paletteID","default","set","Palette ID",r.prototype._palette.switch()),r.prototype.publish("textOffset",8,"number","Text offset from circle"),r.prototype.enter=function(n,r){t.prototype.enter.apply(this,arguments),this.layout=e.layout.cluster(),this.diagonal=e.svg.diagonal().projection(function(e){return[e.y,e.x]})},r.prototype.update=function(n,r,i){var s=this;t.prototype.update.apply(this,arguments),this._palette=this._palette.switch(this._paletteID),this.x(this._maxTextWidth);var o=this.width()-this._maxTextWidth*2;this.layout.size([this.height(),o]);var u=this.layout.nodes(this.data()),a=this.layout.links(u),f=r.selectAll(".link").data(a);f.enter().append("path").attr("class","link"),f.attr("d",this.diagonal),f.exit().remove();var u=r.selectAll(".node").data(u);u.enter().append("g").attr("class","node").on("click",function(e){s.click(e)}).each(function(t){var n=e.select(this);n.append("circle"),n.append("text")});var l=0;u.attr("transform",function(e){return"translate("+e.y+","+e.x+")"}),u.select("circle").attr("r",4.5).style("fill",function(e){return s._palette(e.label)}).append("title").text(function(e){return e.label}),u.select("text").style("text-anchor",function(e){return e.children?"end":"start"}).attr("dx",function(e){return e.children?-s._textOffset:s._textOffset}).attr("dy",3).text(function(e){return e.label}).each(function(t){if(!i){var n=e.select(this).node().getBBox();n.width>l&&(l=n.width)}}),l+=this._textOffset,u.exit().remove(),!i&&this._maxTextWidth!==l&&(this._maxTextWidth=l,this.update(n,r,!0))},r}),function(e,t){typeof define=="function"&&define.amd?define("tree/SunburstPartition.js",["d3/d3","../common/SVGWidget","./ITree","../common/Text","../common/FAChar","css!./SunburstPartition"],t):e.tree_SunburstPartition=t(e.d3,e.common_SVGWidget,e.tree_ITree,e.common_Text,e.common_FAChar)}(this,function(e,t,n,r,i){function s(e){t.call(this),n.call(this),this._class="tree_SunburstPartition"}return s.prototype=Object.create(t.prototype),s.prototype.implements(n.prototype),s.prototype.publish("paletteID","default","set","Palette ID",s.prototype._palette.switch()),s.prototype.root=function(e){return arguments.length?(this._root=e,this.svg&&this.svg.selectAll("path").transition().duration(750).attrTween("d",this.arcTweenFunc(this._root)),this):this._root||this._data},s.prototype.data=function(){var e=t.prototype.data.apply(this,arguments);return arguments.length&&(this._resetRoot=!0),this},s.prototype.enter=function(t,n){var r=this;this.radius=Math.min(this.width(),this.height())/2,this._xScale=e.scale.linear().range([0,2*Math.PI]),this._yScale=e.scale.sqrt().range([0,this.radius]),this.partition=e.layout.partition().value(function(e){return e.value!==undefined?e.value:1}),this.arc=e.svg.arc().startAngle(function(e){return Math.max(0,Math.min(2*Math.PI,r._xScale(e.x)))}).endAngle(function(e){return Math.max(0,Math.min(2*Math.PI,r._xScale(e.x+e.dx)))}).innerRadius(function(e){return Math.max(0,r._yScale(e.y))}).outerRadius(function(e){return Math.max(0,r._yScale(e.y+e.dy))}),this.svg=n.append("g")},s.prototype.update=function(t,n){function o(t){e.event&&e.event.stopPropagation(),r.root(t)}var r=this;this._palette=this._palette.switch(this._paletteID),this.radius=Math.min(this.width(),this.height())/2,this._xScale.range([0,2*Math.PI]),this._yScale.range([0,this.radius]),this._dataNodes=this.partition.nodes(this._data);var i=this.svg.selectAll("path").data(this._dataNodes,function(e,t){return e.id!==undefined?e.id:t}),s=i.enter().append("path").on("click",function(e){r.click(e)}).on("dblclick",o).append("title");i.attr("d",this.arc).style("fill",function(e){return e.__viz_fill?e.__viz_fill:r._palette(e.label)}).style("stroke",function(e){return e.value>16?"white":"none"}).select("title").text(function(e){return e.label}),i.exit().remove(),this._resetRoot&&(this._resetRoot=!1,this.root(this._dataNodes[0]))},s.prototype.arcTweenFunc=function(t){var n=e.interpolate(this._xScale.domain(),[t.x,t.x+t.dx]),r=e.interpolate(this._yScale.domain(),[t.y,1]),i=e.interpolate(this._yScale.range(),[t.y?20:0,this.radius]),s=this;return function(e,t){return t?function(t){return s.arc(e)}:function(t){return s._xScale.domain(n(t)),s._yScale.domain(r(t)).range(i(t)),s.arc(e)}}},s});