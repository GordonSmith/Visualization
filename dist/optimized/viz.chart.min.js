(function(e,t){typeof define=="function"&&define.amd?define("chart/I2DChart.js",["../common/Palette"],t):e.chart_I2DChart=t(e.common_Palette)})(this,function(e){function t(){}return t.prototype._palette=e.ordinal("default"),t.prototype.testData=function(){return this.columns(["Subject","2nd Year"]),this.data([["Geography",75],["English",45],["Math",98],["Science",66]]),this},t.prototype.click=function(e,t){console.log("Click:  "+JSON.stringify(e)+", "+t)},t}),typeof define=="function"&&define.amd&&define("css",[],function(){return{load:function(e,t,n){n()}}}),function(e,t){typeof define=="function"&&define.amd?define("chart/Bubble.js",["d3/d3","../common/SVGWidget","./I2DChart","../common/Text","../common/FAChar","css!./Bubble"],t):e.chart_Bubble=t(e.d3,e.common_SVGWidget,e.chart_I2DChart,e.common_Text,e.common_FAChar)}(this,function(e,t,n,r,i){function s(r){t.call(this),n.call(this),this._class="chart_Bubble",this.labelWidgets={},this.d3Pack=e.layout.pack().sort(function(e,t){return e<t?-1:e>t?1:0}).size([this.width(),this.height()]).value(function(e){return e[1]})}return s.prototype=Object.create(t.prototype),s.prototype.implements(n.prototype),s.prototype.publish("paletteID","default","set","Palette ID",s.prototype._palette.switch()),s.prototype.size=function(e){var n=t.prototype.size.apply(this,arguments);return arguments.length&&this.d3Pack.size([this.width(),this.height()]),n},s.prototype.update=function(t,n){var s=this;this._palette=this._palette.switch(this._paletteID);var o=n.selectAll(".node").data(this._data.length?this.d3Pack.nodes({children:this.cloneData()}).filter(function(e){return!e.children}):[],function(e){return e[0]});o.enter().append("g").attr("class","node").attr("opacity",0).on("click",function(e){s.click(s.rowToObj(e),s._columns[1])}).each(function(t){var n=e.select(this);n.append("circle").attr("r",function(e){return e.r}).append("title"),t.__viz_faChar?s.labelWidgets[t[0]]=(new i).char(t.__viz_faChar).target(this).render():s.labelWidgets[t[0]]=(new r).text(t[0]).target(this).render()}),o.transition().attr("opacity",1).each(function(t){var n=e.select(this),r={x:t.x-s._size.width/2,y:t.y-s._size.height/2};n.select("circle").transition().attr("transform",function(e){return"translate("+r.x+","+r.y+")"}).style("fill",function(e){return s._palette(e[0])}).attr("r",function(e){return e.r}).select("title").text(function(e){return e[0]+" ("+e[1]+")"});if(t.__viz_faChar)s.labelWidgets[t[0]].pos(r).render();else{var i=t[0],o=s.labelWidgets[t[0]].getBBox().width;t.r*2<16?i="":t.r*2<o&&(i=i[0]+"..."),s.labelWidgets[t[0]].pos(r).text(i).render()}}),o.exit().transition().style("opacity",0).remove()},s}),function(e,t){typeof define=="function"&&define.amd?define("chart/XYAxis.js",["d3/d3","../common/SVGWidget"],t):e.chart_XYAxis=t(e.d3,e.common_SVGWidget)}(this,function(e,t){function n(n){t.call(this),this._xScale="",this.parseDate=e.time.format("%Y-%m-%d").parse}return n.prototype=Object.create(t.prototype),n.prototype.xScale=function(e){return arguments.length?(this._xScale=e,this):this._xScale},n.prototype.enter=function(t,n){var r=this;this.x=null;switch(this._xScale){case"DATE":this.x=e.time.scale();break;default:this.x=e.scale.ordinal()}this.y=e.scale.linear(),this.xAxis=e.svg.axis().orient("bottom").scale(this.x),this.yAxis=e.svg.axis().orient("left").scale(this.y).tickFormat(e.format(".2s")).ticks(10),this.recenterG=n.append("g"),this.svg=this.recenterG.append("g"),this.svgData=this.svg.append("g"),this.svgXAxis=this.svg.append("g").attr("class","x axis"),this.svgYAxis=this.svg.append("g").attr("class","y axis")},n.prototype.calcMargin=function(e,t){var n=this,r={top:8,right:0,bottom:24,left:40},i=this.width()-r.left-r.right,s=this.height()-r.top-r.bottom,o=t.append("g"),u=o.append("g").attr("class","x axis").attr("transform","translate(0,"+s+")").call(this.xAxis),a=o.append("g").attr("class","y axis").call(this.yAxis),f=u.node().getBBox(),l=a.node().getBBox();return r.bottom=f.height,r.left=l.width,o.remove(),r},n.prototype.update=function(t,n){var r=this;switch(this._xScale){case"DATE":var i=e.min(this._data,function(t){return e.min(t,function(e){return r.parseDate(e[0])})}),s=e.max(this._data,function(t){return e.max(t,function(e){return r.parseDate(e[0])})});this.x.domain([i,s]);break;default:this.x.domain(this._data.map(function(e){return e[0]}))}var i=e.min(this._data,function(t){return e.min(t.filter(function(e,t){return t>0&&r._columns[t]&&r._columns[t].indexOf("__")!==0}),function(e){return e})}),s=e.max(this._data,function(t){return e.max(t.filter(function(e,t){return t>0&&r._columns[t]&&r._columns[t].indexOf("__")!==0}),function(e){return e})}),o=i-(s-i)/10;i>=0&&o<0&&(o=0),this.y.domain([o,s]),this.x.rangeRoundBands?this.x.rangeRoundBands([0,this.width()],.1):this.x.rangeRound&&this.x.range([0,this.width()]),this.y.range([this.height(),0]);var u=this.calcMargin(t,n),a=this.width()-u.left-u.right,f=this.height()-u.top-u.bottom;this.x.rangeRoundBands?this.x.rangeRoundBands([0,a],.1):this.x.rangeRound&&this.x.range([0,a]),this.y.range([f,0]),this.svg.transition().attr("transform","translate("+u.left+","+u.top+")"),this.svgXAxis.transition().attr("transform","translate(0,"+f+")").call(this.xAxis),this.svgYAxis.transition().call(this.yAxis),this.updateChart(t,n,u,a,f),this.recenterG.transition().attr("transform","translate("+ -this.width()/2+","+ -this.height()/2+")")},n.prototype.updateChart=function(e,t,n,r,i){},n}),function(e,t){typeof define=="function"&&define.amd?define("chart/Column.js",["d3/d3","./XYAxis","./I2DChart","css!./Column"],t):e.chart_Column=t(e.d3,e.chart_XYAxis,e.chart_I2DChart)}(this,function(e,t,n){function r(e){t.call(this),n.call(this),this._class="chart_Column"}return r.prototype=Object.create(t.prototype),r.prototype.implements(n.prototype),r.prototype.publish("paletteID","default","set","Palette ID",r.prototype._palette.switch()),r.prototype.updateChart=function(e,t,n,r,i){var s=this;this._palette=this._palette.switch(this._paletteID);var o=this.svgData.selectAll(".columnRect").data(this._data),u=o.enter().append("rect").attr("class","columnRect").on("click",function(e){s.click(s.rowToObj(e),s._columns[1])}).append("title");o.transition().attr("class","columnRect").attr("x",function(e){return s.x(e[0])}).attr("width",this.x.rangeBand()).attr("y",function(e){return s.y(e[1])}).attr("height",function(e){return i-s.y(e[1])}).style("fill",function(e){return s._palette(e[0])}),u.text(function(e){return e[0]+" ("+e[1]+")"}),o.exit().transition().remove()},r}),function(e,t){typeof define=="function"&&define.amd?define("chart/I1DChart.js",["../common/Palette"],t):e.chart_I1DChart=t(e.common_Palette)}(this,function(e){function t(){}return t.prototype._palette=e.rainbow("default"),t.prototype.testData=function(){return this.columns("Result"),this.data(66),this},t.prototype.click=function(e,t){console.log("Click:  "+JSON.stringify(e)+", "+t)},t}),function(e,t){typeof define=="function"&&define.amd?define("chart/INDChart",["../common/Palette"],t):e.chart_INDChart=t(e.common_Palette)}(this,function(e){function t(){}return t.prototype._palette=e.ordinal("default"),t.prototype.testData=function(){return this.columns(["Subject","Year 1","Year 2","Year 3"]),this.data([["Geography",75,68,65],["English",45,55,52],["Math",98,92,90],["Science",66,60,66]]),this},t.prototype.click=function(e,t){console.log("Click:  "+JSON.stringify(e)+", "+t)},t}),function(e,t){typeof define=="function"&&define.amd?define("chart/Line.js",["d3/d3","./XYAxis","./INDChart","css!./Line"],t):e.chart_Line=t(e.d3,e.chart_XYAxis,e.chart_INDChart)}(this,function(e,t,n){function r(e){t.call(this),n.call(this),this._class="chart_Line"}return r.prototype=Object.create(t.prototype),r.prototype.implements(n.prototype),r.prototype.publish("paletteID","default","set","Palette ID",r.prototype._palette.switch()),r.prototype.enter=function(e,n){t.prototype.enter.apply(this,arguments);var r=this},r.prototype.updateChart=function(t,n,r,i,s){var o=this;this._palette=this._palette.switch(this._paletteID);var u=e.svg.line().x(function(e){switch(o._xScale){case"DATE":return o.x(o.parseDate(e[0]))}return o.x(e[0])+(o.x.rangeBand?o.x.rangeBand()/2:0)}).y(function(e){return o.y(e[1])}),a=this.svgData.selectAll(".dataLine").data(this._columns.filter(function(e,t){return t>0}));a.enter().append("path").attr("class","dataLine"),a.style("stroke",function(e,t){return o._palette(o._columns[t+1])}).append("title").text(function(e){return e}),a.datum(function(e,t){return o._data.map(function(e,n){return[e[0],e[t+1]]})}).attr("d",u),a.exit().remove()},r}),function(e,t){typeof define=="function"&&define.amd?define("chart/MultiChart",["d3/d3","../common/SVGWidget","./INDChart","../other/Persist","require"],t):e.chart_MultiChart=t(e.d3,e.common_SVGWidget,e.chart_INDChart,e.other_Persist,e.require)}(this,function(e,t,n,r,i){function f(){t.call(this),n.call(this),this._class="chart_MultiChart",this._chart=null,this._2dChartTypes=s,this._multiChartTypes=o,this._anyChartTypes=u,this._allChartTypes=a,this._allCharts={},this._allChartTypes.forEach(function(e){var t=JSON.parse(JSON.stringify(e));t.widget=null,this._allCharts[e.id]=t,this._allCharts[e.display]=t,this._allCharts[e.widgetClass]=t},this),this._allCharts.BAR=this._allCharts.COLUMN}var s=[{id:"BUBBLE",display:"Bubble",widgetClass:"chart_Bubble"},{id:"COLUMN",display:"Column",widgetClass:"chart_Column"},{id:"PIE",display:"Pie",widgetClass:"chart_Pie"},{id:"GOOGLE_PIE",display:"Pie (Google)",widgetClass:"google_Pie"},{id:"C3_PIE",display:"Pie (C3)",widgetClass:"c3_Pie"},{id:"C3_DONUT",display:"Donut (C3)",widgetClass:"c3_Donut"},{id:"WORD_CLOUD",display:"Word Cloud",widgetClass:"other_WordCloud"}],o=[{id:"GOOGLE_BAR",display:"Bar (Google)",widgetClass:"google_Bar"},{id:"GOOGLE_COLUMN",display:"Column (Google)",widgetClass:"google_Column"},{id:"LINE",display:"Line",widgetClass:"chart_Line"},{id:"GOOGLE_LINE",display:"Line (Google)",widgetClass:"google_Line"},{id:"C3_LINE",display:"Line (C3)",widgetClass:"c3_Line"},{id:"C3_BAR",display:"Bar (C3)",widgetClass:"c3_Bar"},{id:"C3_COLUMN",display:"Column (C3)",widgetClass:"c3_Column"},{id:"C3_STEP",display:"Step (C3)",widgetClass:"c3_Step"},{id:"C3_AREA",display:"Area (C3)",widgetClass:"c3_Area"},{id:"C3_SCATTER",display:"Scatter (C3)",widgetClass:"c3_Scatter"}],u=[{id:"TABLE",display:"Table",widgetClass:"other_Table"}],a=s.concat(o.concat(u));return f.prototype=Object.create(t.prototype),f.prototype.implements(n.prototype),f.prototype.publish("chart_type","BUBBLE","set","Chart Type",a.map(function(e){return e.id})),f.prototype.publish("chart",null,"widget","Chart"),f.prototype.columns=function(e){var n=t.prototype.columns.apply(this,arguments);return arguments.length&&this._chart&&this._chart.columns(e),n},f.prototype.data=function(e){var n=t.prototype.data.apply(this,arguments);return arguments.length&&this._chart&&this._chart.data(e),n},f.prototype.hasOverlay=function(){return this._chart&&this._chart.hasOverlay()},f.prototype.visible=function(e){return arguments.length?(this._chart&&this._chart.visible(e),this):this._chart.visible()},f.prototype.requireContent=function(e,t){var n=this._allCharts[e].widget;if(n){t(n);return}var r=this,s="../"+this._allCharts[e].widgetClass.split("_").join("/");i([s],function(i){n=new i,r._allCharts[e].widget=n,t(n)})},f.prototype.switchChart=function(e){var t=this._chart,n=this;this.requireContent(this._chart_type,function(r){if(r!==t){var i=n.size();n._chart=r.columns(n._columns).data(n._data).size(i),r.click=function(e,t){n.click(e,t)},t&&t.data([]).size({width:1,height:1}).render()}e&&e(this)})},f.prototype.update=function(e,n){t.prototype.update.apply(this,arguments);var r=n.selectAll(".multiChart").data(this._chart?[this._chart]:[],function(e){return e._id});r.enter().append("g").attr("class","multiChart").each(function(e){e.target(this)});var i=this.size();r.each(function(e){e.size(i).render()}),r.exit().transition().each(function(e){e.target(null)}).remove()},f.prototype.exit=function(e,n){this._chart&&this._chart.target(null),t.prototype.exit.apply(this,arguments)},f.prototype.render=function(e){if(this._chart_type&&(!this._chart||this._chart._class!==this._allCharts[this._chart_type].widgetClass)){var n=this,r=arguments;return this.switchChart(function(){t.prototype.render.apply(n,r)}),this}return t.prototype.render.apply(this,arguments)},f}),function(e,t){typeof define=="function"&&define.amd?define("chart/MultiChartSurface.js",["d3/d3","../common/ResizeSurface","./MultiChart","./INDChart"],t):e.chart_MultiChartSurface=t(e.d3,e.common_ResizeSurface,e.chart_MultiChart,e.chart_INDChart)}(this,function(e,t,n,r){function i(){t.call(this),r.call(this),this.class="chart_MultiChartSurface",this._title="MultiChartSurface",this._content=new n,this._content.click=function(t,n){e.click(t,n)};var e=this;this._menu.click=function(t){e._content.chart_type(t).render()},this.mode("all")}return i.prototype=Object.create(t.prototype),i.prototype.implements(r.prototype),i.prototype.testData=r.prototype.testData,i.prototype.publishProxy("chart_type","_content"),i.prototype.columns=function(e){return arguments.length?(this._content.columns(e),this):this._content.columns()},i.prototype.data=function(e){return arguments.length?(this._content.data(e),this):this._content.data()},i.prototype.mode=function(e){if(!arguments.length)return this._mode;this._mode=e;switch(this._mode){case"2d":this.menu(this._content._2dChartTypes.concat(this._content._anyChartTypes).map(function(e){return e.display}).sort());break;case"multi":this.menu(this._content._multiChartTypes.concat(this._content._anyChartTypes).map(function(e){return e.display}).sort());break;case"all":default:this.menu(this._content._allChartTypes.map(function(e){return e.display}).sort())}return this},i}),function(e,t){typeof define=="function"&&define.amd?define("chart/Pie.js",["d3/d3","../common/SVGWidget","./I2DChart","../common/Text","../common/FAChar","css!./Pie"],t):e.chart_Pie=t(e.d3,e.common_SVGWidget,e.chart_I2DChart,e.common_Text,e.common_FAChar)}(this,function(e,t,n,r,i){function s(r){t.call(this),n.call(this),this._class="chart_Pie",this._outerText=!1,this._radius=100,this._innerRadius=0,this.labelWidgets={},this.d3Pie=e.layout.pie().sort(function(e,t){return e<t?-1:e>t?1:0}).value(function(e){return e[1]}),this.d3Arc=e.svg.arc().outerRadius(this._radius).innerRadius(this._innerRadius)}return s.prototype=Object.create(t.prototype),s.prototype.implements(n.prototype),s.prototype.publish("paletteID","default","set","Palette ID",s.prototype._palette.switch()),s.prototype.size=function(e){var n=t.prototype.size.apply(this,arguments);return arguments.length&&this.radius(Math.min(this._size.width,this._size.height)/2),n},s.prototype.radius=function(e){return arguments.length?(this.d3Arc.outerRadius(e),this._radius=e,this):this._radius},s.prototype.innerRadius=function(e){return arguments.length?(this.d3Arc.innerRadius(e),this._innerRadius=e,this):this._innerRadius},s.prototype.outerText=function(e){return arguments.length?(this._outerText=e,this):this._outerText},s.prototype.intersection=function(e,t){return this.intersectCircle(e,t)},s.prototype.update=function(t,n){var s=this;this._palette=this._palette.switch(this._paletteID);var o=n.selectAll(".arc").data(this.d3Pie(this._data),function(e){return e.data[0]});o.enter().append("g").attr("class","arc").attr("opacity",0).on("click",function(e){s.click(s.rowToObj(e.data),s._columns[1])}).each(function(t){var n=e.select(this);n.append("path").attr("d",s.d3Arc).append("title"),t.data.__viz_faChar?s.labelWidgets[t.data[0]]=(new i).char(t.data.__viz_faChar).target(this).render():s.labelWidgets[t.data[0]]=(new r).text(t.data[0]).target(this).render()}),o.transition().attr("opacity",1).each(function(t){var n={x:0,y:1};if(s._outerText){var r=Math.cos((t.startAngle+t.endAngle-Math.PI)/2),i=Math.sin((t.startAngle+t.endAngle-Math.PI)/2),o=s.labelWidgets[t.data[0]].getBBox(),u=Math.abs(r)>Math.abs(i)?o.width:o.height;n.x=r*(s._radius+u),n.y=i*(s._radius+u)}else{var a=s.d3Arc.centroid(t);n={x:a[0],y:a[1]}}var f=e.select(this);f.select("path").transition().attr("d",s.d3Arc).style("fill",function(e){return s._palette(e.data[0])}).select("title").text(function(e){return e.data[0]+" ("+e.data[1]+")"}),s.labelWidgets[t.data[0]].pos(n).render().element().classed("innerLabel",!s._outerText).classed("outerLabel",s._outerText)}),o.exit().transition().style("opacity",0).remove();if(s._outerText){var u=n.selectAll("line").data(this.d3Pie(this._data),function(e){return e.data[0]}),a=this.radius();u.enter().append("line").attr("x1",0).attr("x2",0).attr("y1",-this._radius-3).attr("y2",-this._radius-8).attr("stroke","gray").attr("transform",function(e){return"rotate("+(e.startAngle+e.endAngle)/2*(180/Math.PI)+")"}),u.transition().attr("transform",function(e){return"rotate("+(e.startAngle+e.endAngle)/2*(180/Math.PI)+")"}),u.exit().remove()}},s});