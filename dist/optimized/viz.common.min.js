(function(e,t){typeof define=="function"&&define.amd?define("common/Widget.js",["d3/d3","require"],t):e.common_Widget=t(e.d3)})(this,function(e,t){function s(){this._id="_w"+r++,this._class="",this._columns=[],this._data=[],this._pos={x:0,y:0},this._size={width:0,height:0},this._scale=1,this._target=null,this._parentElement=null,this._parentWidget=null,this._element=e.select(),this._watchArr=[],this._renderCount=0}var n=this,r=0,i={};return s.prototype.ieVersion=function(){var e=navigator.userAgent,t,n=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(t=/\brv[ :]+(\d+)/g.exec(e)||[],parseFloat(t[1])):/msie/i.test(n[1])?parseFloat(n[2]):null}(),s.prototype.isIE=s.prototype.ieVersion!==null,s.prototype.svgMarkerGlitch=s.prototype.isIE&&s.prototype.ieVersion<=12,s.prototype.MutationObserver=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver||function(e){this.callback=e,this.listeners=[];var t=function(e,t,n){this.callback=e,this.domNode=t,this.type=n};t.prototype={handleEvent:function(e){var t={type:this.type,target:this.domNode,addedNodes:[],removedNodes:[],previousSibling:e.target.previousSibling,nextSibling:e.target.nextSibling,attributeName:null,attributeNamespace:null,oldValue:null};this.callback([t])}},this.observe=function(e,n){if(n.attributes){var r=new t(this.callback,e,"attributes");this.listeners.push(r),e.addEventListener("DOMAttrModified",r,!0)}if(n.characterData){var r=new t(this.callback,e,"characterData");this.listeners.push(r),e.addEventListener("DOMCharacterDataModified",r,!0)}if(n.childList){var r=new t(this.callback,e,"childList");this.listeners.push(r),e.addEventListener("DOMNodeInserted",r,!0),e.addEventListener("DOMNodeRemoved",r,!0)}},this.disconnect=function(){this.listeners.forEach(function(e){switch(e.type){case"attributes":e.domNode.removeEventListener("DOMAttrModified",e,!0);break;case"characterData":e.domNode.removeEventListener("DOMCharacterDataModified",e,!0);break;case"childList":e.domNode.removeEventListener("DOMNodeRemoved",e,!0),e.domNode.removeEventListener("DOMNodeInserted",e,!0)}}),this.listeners=[]}},window.MutationObserver||(window.MutationObserver=s.prototype.MutationObserver),s.prototype.implements=function(e){for(var t in e)this[t]===undefined&&e.hasOwnProperty(t)&&(this[t]=e[t])},s.prototype.require=t||function(e,t){typeof e=="function"&&(t=e,e=[]);var r=e.map(function(e){var t=e.substring("../".length).split("/").join("_");return n[t]});t.apply(null,r)},s.prototype.publish=function(e,t,n,r,i,s){if(this["__meta_"+e]!==undefined)throw e+" is already published.";this["__meta_"+e]={id:e,type:n,defaultValue:t,description:r,set:i,ext:s||{}},this[e]=function(t){if(!arguments.length)return this["_"+e];switch(n){case"set":(!i||i.indexOf(t)<0)&&console.log("Invalid value for '"+e+"':  "+t);break;case"html-color":var r="red",s=document.createElement("div");s.style.color=r,s.style.color=t,t!==r&&(s.style.color===r||s.style.color==="")&&console.log("Invalid value for '"+e+"':  "+t);break;case"boolean":t=Boolean(t);break;case"number":t=Number(t);break;case"string":t=String(t);break;case"array":t instanceof Array||console.log("Invalid value for '"+e)}return this.broadcast(e,t,this["_"+e]),this["_"+e]=t,this},this[e+"_modified"]=function(){return this["_"+e]!==t},this[e+"_reset"]=function(){this["_"+e]=t},this["_"+e]=t},s.prototype.publishWidget=function(e,t,n){for(var r in t.prototype)if(r.indexOf("__meta")===0){var i=t.prototype[r];this.publishProxy(e+"_"+i.id,n,i.method||i.id)}},s.prototype.publishProxy=function(e,t,n,r){n=n||e;if(this["__meta_"+e]!==undefined)throw e+" is already published.";this["__meta_"+e]={id:e,type:"proxy",proxy:t,method:n,defaultValue:r},this[e]=function(i){return arguments.length?(r&&i===r?this[t][n+"_reset"]():this[t][n](i),this):!r||this[e+"_modified"]()?this[t][n]():r},this[e+"_modified"]=function(e){return this[t][n+"_modified"]()&&(!r||this[t][n]()!==r)},this[e+"_reset"]=function(){this[t][n+"_reset"]()}},s.prototype.watch=function(e){var t=this,n=this._watchArr.push(e)-1;return{remove:function(){delete t._watchArr[n]}}},s.prototype.broadcast=function(e,t,n){this._watchArr.forEach(function(r){r&&setTimeout(function(){r(e,t,n)},0)})},s.prototype.id=function(e){return arguments.length?(this._id=e,this):this._id},s.prototype.class=function(e){return arguments.length?(this._class=e,this):this._class},s.prototype.columns=function(e){return arguments.length?(this._columns=e,this):this._columns},s.prototype.data=function(e){return arguments.length?(this._data=e,this):this._data},s.prototype.cloneData=function(){return this._data.map(function(e){return e.slice(0)})},s.prototype.rowToObj=function(e){var t={};if(e.length!==this._columns.length)throw"Columns and row do not match";return this._columns.forEach(function(n,r){t[n]=e[r]}),t},s.prototype.pos=function(e){return arguments.length?(this._pos=e,this._overlayElement&&this._overlayElement.attr("transform","translate("+e.x+","+e.y+")scale("+this._scale+")"),this):this._pos},s.prototype.x=function(e){return arguments.length?(this.pos({x:e,y:this._pos.y}),this):this._pos.x},s.prototype.y=function(e){return arguments.length?(this.pos({x:this._pos.x,y:e}),this):this._pos.y},s.prototype.size=function(e){return arguments.length?(this._size=e,this._overlayElement&&this._overlayElement.attr("width",e.width).attr("height",e.height),this):this._size},s.prototype.width=function(e){return arguments.length?(this.size({width:e,height:this._size.height}),this):this._size.width},s.prototype.height=function(e){return arguments.length?(this.size({width:this._size.width,height:e}),this):this._size.height},s.prototype.resize=function(e,t){t=t||{width:0,height:0};var n,r;if(e&&e.width&&e.height)n=e.width,r=e.height;else{var i=window.getComputedStyle(this._target,null);n=parseFloat(i.getPropertyValue("width"))-t.width,r=parseFloat(i.getPropertyValue("height"))-t.height}return this.size({width:n,height:r}),this},s.prototype._scrollBarWidth=null,s.prototype.getScrollbarWidth=function(){if(s.prototype._scrollBarWidth===null){var e=document.createElement("div");e.style.visibility="hidden",e.style.width="100px",e.style.msOverflowStyle="scrollbar",document.body.appendChild(e);var t=e.offsetWidth;e.style.overflow="scroll";var n=document.createElement("div");n.style.width="100%",e.appendChild(n);var r=n.offsetWidth;e.parentNode.removeChild(e),s.prototype._scrollBarWidth=t-r}return s.prototype._scrollBarWidth},s.prototype.scale=function(e){return arguments.length?(this._scale=e,this._overlayElement&&this._overlayElement.attr("transform","translate("+e.x+","+e.y+")scale("+this._scale+")"),this):this._scale},s.prototype.visible=function(e){return arguments.length?(this._visible=e,this._parentElement&&this._parentElement.style("visibility",this._visible?null:"hidden"),this):this._visible},s.prototype.display=function(e){return arguments.length?(this._display=e,this._element&&this._element.style("display",this._display?null:"none"),this):this._display},s.prototype.calcSnap=function(e){function t(e,t){function n(e,t){var n=e%t;return Math.abs(n)>t-Math.abs(n)&&(n=(t-Math.abs(n))*(n<0?1:-1)),n}return e-n(e,t)}var n=t(this._pos.x-this._size.width/2,e),r=t(this._pos.y-this._size.height/2,e),i=t(this._pos.x+this._size.width/2,e),s=t(this._pos.y+this._size.height/2,e),o=i-n,u=s-r;return[{x:n+o/2,y:r+u/2},{width:o,height:u}]},s.prototype.toWidget=function(t){if(!t)return null;var n=e.select(t);if(n){var r=n.datum();if(r)return r}return null},s.prototype.locateParentWidget=function(e){if(!e)return null;var t=this.toWidget(e);return t?t:this.locateParentWidget(e.parentNode)},s.prototype.locateSVGNode=function(e){return e?e.tagName==="svg"?e:this.locateSVGNode(e.parentNode):null},s.prototype.locateOverlayNode=function(){var e=this.locateParentWidget(this._target);while(e){if(e._parentOverlay)return e._parentOverlay;e=this.locateParentWidget(e._target.parentNode)}return null},s.prototype.getAbsolutePos=function(e,t,n){var r=this.locateSVGNode(e);if(!r)return null;var i=r.createSVGPoint(),s=e.getCTM();i=i.matrixTransform(s);var o={x:i.x,y:i.y};if(t!==undefined&&n!==undefined){var u=r.createSVGPoint();u.x=t,u.y=n,u=u.matrixTransform(s),o.width=u.x-i.x,o.height=u.y-i.y}return o},s.prototype.hasOverlay=function(){return this._overlayElement},s.prototype.syncOverlay=function(){if(this._size.width&&this._size.height){var e=this.getAbsolutePos(this._overlayElement.node(),this._size.width,this._size.height);if(e&&(this.oldPos===null||this.oldPos===undefined||e.x!==this.oldPos.x||e.y!==this.oldPos.y||e.width!==this.oldPos.width||e.height!==this.oldPos.height)){var t=e.width/this._size.width,n=e.height/this._size.height;this._parentElement.style({left:e.x-e.width/t/2+"px",top:e.y-e.height/n/2+"px",width:e.width/t+"px",height:e.height/n+"px"});var r="scale("+t+","+n+")";this._parentElement.style("transform",r).style("-moz-transform",r).style("-ms-transform",r).style("-webkit-transform",r).style("-o-transform",r)}this.oldPos=e}},s.prototype.element=function(){return this._element},s.prototype.node=function(){return this._element.node()},s.prototype.render=function(t){if(!this._parentElement)return this;if(!this._tag)throw"No DOM tag specified";var n=this._parentElement.selectAll("#"+this._id).data([this],function(e){return e._id});return n.enter().append(this._tag).classed(this._class,!0).attr("id",this._id).each(function(t){t._element=e.select(this),t.enter(this,t._element)}),n.each(function(e){e.update(this,e._element),e._element.attr("transform",function(t){return"translate("+e._pos.x+","+e._pos.y+")scale("+e._scale+")"})}),n.exit().each(function(t){t.exit(this,t._element)}).remove(),this._renderCount++,t&&t(this),this},s.prototype.enter=function(e,t,n){},s.prototype.update=function(e,t,n){},s.prototype.exit=function(e,t,n){},s.prototype.debounce=function(e,t,n){return function(){function o(){n||e.apply(i,s),i.timeout=null}var i=this,s=arguments;i.timeout?clearTimeout(i.timeout):n&&e.apply(i,s),i.timeout=setTimeout(o,t||100)}},s}),function(e,t){typeof define=="function"&&define.amd?define("common/Transition.js",[],t):e.common_Transition=t()}(this,function(){function e(e){this._widget=e,this._duration=250,this._delay=0,this._ease="cubic-in-out"}return e.prototype.duration=function(e){return arguments.length?(this._duration=e,this._widget):this._duration},e.prototype.delay=function(e){return arguments.length?(this._delay=e,this._widget):this._delay},e.prototype.ease=function(e){return arguments.length?(this._ease=e,this._widget):this._ease},e.prototype.apply=function(e){return this._duration||this._delay?e.transition().duration(this._duration).delay(this._delay).ease(this._ease):e},e}),function(e,t){typeof define=="function"&&define.amd?define("common/SVGWidget.js",["./Widget","./Transition","d3/d3"],t):e.common_SVGWidget=t(e.common_Widget,e.common_Transition,e.d3)}(this,function(e,t,n){function r(){e.call(this),this._tag="g",this._boundingBox=null,this.transition=new t(this),this._drawStartPos="center"}r.prototype=Object.create(e.prototype),r.prototype.move=function(e,t){var n=this.pos.apply(this,arguments);return arguments.length&&(t?this._element.transition().duration(t):this._element).attr("transform","translate("+e.x+" "+e.y+")"),n},r.prototype.size=function(t){var n=e.prototype.size.apply(this,arguments);return arguments.length&&(this._boundingBox=null),n},r.prototype.resize=function(t){var n=e.prototype.resize.apply(this,arguments);this._parentRelativeDiv.style({width:this._size.width+"px",height:this._size.height+"px"}),this._parentElement.attr("width",this._size.width).attr("height",this._size.height);switch(this._drawStartPos){case"origin":this.pos({x:0,y:0});break;case"center":default:this.pos({x:this._size.width/2,y:this._size.height/2})}return n},r.prototype.target=function(e){if(!arguments.length)return this._target;if(this._target&&e&&this._target.__data__.id!==e.__data__.id)throw"Target can only be assigned once.";this._target=e;if(typeof this._target=="string"||this._target instanceof String)this._target=document.getElementById(this._target);if(this._target instanceof SVGElement){this._parentElement=n.select(this._target),this._parentWidget=this._parentElement.datum();if(!this._parentWidget||this._parentWidget._id===this._id)this._parentWidget=this.locateParentWidget(this._target.parentNode)}else this._target?(this._parentRelativeDiv=n.select(this._target).append("div").style({position:"relative"}),this._parentElement=this._parentRelativeDiv.append("svg").style({position:"absolute",top:0,left:0}),this._parentOverlay=this._parentRelativeDiv.append("div").style({position:"absolute",top:0,left:0}),this.resize(this._size)):this.exit();return this},r.prototype.enter=function(t,n,r){e.prototype.enter.apply(this,arguments)},r.prototype.update=function(t,n,r){e.prototype.update.apply(this,arguments),n.attr("transform","translate("+this._pos.x+" "+this._pos.y+")")},r.prototype.exit=function(t,n,r){this._parentRelativeDiv&&(this._parentOverlay.remove(),this._parentElement.remove(),this._parentRelativeDiv.remove()),e.prototype.exit.apply(this,arguments)},r.prototype.getOffsetPos=function(){var e={x:0,y:0};return this._parentWidget?(e=this._parentWidget.getOffsetPos(),e.x+=this._pos.x,e.y+=this._pos.y,e):e},r.prototype.getBBox=function(e,t){if(e||this._boundingBox===null){var n=this._element.node();n instanceof SVGElement&&(this._boundingBox=n.getBBox())}return this._boundingBox===null?{x:0,y:0,width:0,height:0}:{x:(t?Math.round(this._boundingBox.x):this._boundingBox.x)*this._scale,y:(t?Math.round(this._boundingBox.y):this._boundingBox.y)*this._scale,width:(t?Math.round(this._boundingBox.width):this._boundingBox.width)*this._scale,height:(t?Math.round(this._boundingBox.height):this._boundingBox.height)*this._scale}},r.prototype.intersection=function(e,t){return this.intersectRect(e,t)};var i=function(e,t,n){return{x:e.x+(t.x-e.x)*n,y:e.y+(t.y-e.y)*n}},s=function(e,t,n,r){var i={type:"",points:[]},s=(r.x-n.x)*(e.y-n.y)-(r.y-n.y)*(e.x-n.x),o=(t.x-e.x)*(e.y-n.y)-(t.y-e.y)*(e.x-n.x),u=(r.y-n.y)*(t.x-e.x)-(r.x-n.x)*(t.y-e.y);if(u!=0){var a=s/u,f=o/u;0<=a&&a<=1&&0<=f&&f<=1?(i.type="Intersection",i.points.push({x:e.x+a*(t.x-e.x),y:e.y+a*(t.y-e.y)})):i.type="No Intersection"}else s==0||o==0?i.type="Coincident":i.type="Parallel";return i};r.prototype.intersectRect=function(e,t){var n=this.getOffsetPos(),r=this.getBBox();if(e.x===t.x&&e.y===t.y)return e;var i={x:n.x-r.width/2,y:n.y-r.height/2},o={x:n.x+r.width/2,y:n.y-r.height/2},u={x:n.x+r.width/2,y:n.y+r.height/2},a={x:n.x-r.width/2,y:n.y+r.height/2},f=s(i,o,e,t);return f.points.length?{x:f.points[0].x,y:f.points[0].y}:(f=s(o,u,e,t),f.points.length?{x:f.points[0].x,y:f.points[0].y}:(f=s(u,a,e,t),f.points.length?{x:f.points[0].x,y:f.points[0].y}:(f=s(a,i,e,t),f.points.length?{x:f.points[0].x,y:f.points[0].y}:null)))};var o=function(e,t,n,r){var s={type:"",points:[]},o=(r.x-n.x)*(r.x-n.x)+(r.y-n.y)*(r.y-n.y),u=2*((r.x-n.x)*(n.x-e.x)+(r.y-n.y)*(n.y-e.y)),a=e.x*e.x+e.y*e.y+n.x*n.x+n.y*n.y-2*(e.x*n.x+e.y*n.y)-t*t,f=u*u-4*o*a;if(f<0)s.type="Outside";else if(f==0)s.type="Tangent";else{var l=Math.sqrt(f),c=(-u+l)/(2*o),h=(-u-l)/(2*o);(c<0||c>1)&&(h<0||h>1)?c<0&&h<0||c>1&&h>1?s.type="Outside":s.type="Inside":(s.type="Intersection",0<=c&&c<=1&&s.points.push(i(n,r,c)),0<=h&&h<=1&&s.points.push(i(n,r,h)))}return s};return r.prototype.intersectCircle=function(e,t){var n=this.getOffsetPos(),r=this.radius(),i=o(n,r,e,t);return i.points.length?{x:i.points[0].x,y:i.points[0].y}:null},r.prototype.distance=function(e,t){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y))},r.prototype._pushMarkers=function(e,t){this.svgMarkerGlitch&&(e=e||this._element,e.selectAll("path[marker-start],path[marker-end]").attr("fixme-start",function(e){return this.getAttribute("marker-start")}).attr("fixme-end",function(e){return this.getAttribute("marker-end")}).attr("marker-start",null).attr("marker-end",null))},r.prototype._popMarkers=function(e,t){this.svgMarkerGlitch&&(e=e||this._element,e.selectAll("path[fixme-start],path[fixme-end]").attr("marker-start",function(e){return this.getAttribute("fixme-start")}).attr("marker-end",function(e){return this.getAttribute("fixme-end")}).attr("fixme-start",null).attr("fixme-end",null))},r.prototype._popMarkersDebounced=e.prototype.debounce(function(e,t){this.svgMarkerGlitch&&this._popMarkers(e,t)},250),r.prototype._fixIEMarkers=function(e,t){this.svgMarkerGlitch&&(this._pushMarkers(e,t),this._popMarkersDebounced(e,t))},r}),typeof define=="function"&&define.amd&&define("css",[],function(){return{load:function(e,t,n){n()}}}),function(e,t){typeof define=="function"&&define.amd?define("common/Text.js",["./SVGWidget","css!./Text"],t):e.common_Text=t(e.common_SVGWidget)}(this,function(e){function t(){e.call(this),this._class="common_Text"}return t.prototype=Object.create(e.prototype),t.prototype.publish("text","","string","Display Text"),t.prototype.publish("font_family","","string","Font Family"),t.prototype.publish("font_size",null,"number","Font Size (px)"),t.prototype.publish("anchor","middle","set","Anchor Position",["start","middle","end"]),t.prototype.publish("color_fill",null,"html-color","Fill Color"),t.prototype.testData=function(){return this.text("Hello\nand\nWelcome!"),this},t.prototype.enter=function(t,n){e.prototype.enter.apply(this,arguments),this._textElement=n.append("text")},t.prototype.update=function(t,n){e.prototype.update.apply(this,arguments),this._textElement.attr("font-family",this.__meta_font_family.defaultValue!==this._font_family?this._font_family:null).attr("font-size",this.__meta_font_size.defaultValue!==this._font_size?this._font_size:null);var r=this._text.split("\n"),i=this._textElement.selectAll("tspan").data(r,function(e){return e});i.enter().append("tspan").attr("class",function(e,t){return"tspan_"+t}).attr("dy","1em").attr("x","0"),i.style("fill",this.__meta_color_fill.defaultValue!==this._color_fill?this._color_fill:null).text(function(e){return e}),i.exit().remove();var s={width:0,height:0};try{s=this._textElement.node().getBBox()}catch(o){}var u=0;switch(this._anchor){case"start":u=-s.width/2;break;case"end":u=s.width/2}var a=-(s.y+s.height/2);this._textElement.style("text-anchor",this._anchor).attr("transform",function(e){return"translate("+u+","+a+")"})},t}),function(e,t){typeof define=="function"&&define.amd?define("common/FAChar",["./SVGWidget","./Text","css!font-awesome/css/font-awesome","css!./FAChar"],t):e.common_FAChar=t(e.common_SVGWidget,e.common_Text)}(this,function(e,t){function n(){e.call(this),this._class="common_FAChar",this._text=(new t).font_family("FontAwesome")}return n.prototype=Object.create(e.prototype),n.prototype.publish("char","","string","Font Awesome Item"),n.prototype.publish("font_size",null,"number","Font Size"),n.prototype.publishProxy("color_fill","_text"),n.prototype.testData=function(){return this.char(""),this},n.prototype.enter=function(t,n){e.prototype.enter.apply(this,arguments),this._text.target(t)},n.prototype.update=function(t,n){e.prototype.update.apply(this,arguments),this._text.text(this._char).scale((this.font_size()||14)/14).render()},n}),function(e,t){typeof define=="function"&&define.amd?define("common/HTMLWidget.js",["./Widget","./Transition","d3/d3"],t):e.common_HTMLWidget=t(e.common_Widget,e.common_Transition,e.d3)}(this,function(e,t,n){function r(){e.call(this)}return r.prototype=Object.create(e.prototype),r.prototype.calcFrameWidth=function(e){var t=parseFloat(e.style("padding-left"))+parseFloat(e.style("padding-right"))+parseFloat(e.style("margin-left"))+parseFloat(e.style("margin-right"))+parseFloat(e.style("border-left-width"))+parseFloat(e.style("border-right-width"));return t},r.prototype.calcWidth=function(e){return parseFloat(e.style("width"))-this.calcFrameWidth(e)},r.prototype.calcFrameHeight=function(e){var t=parseFloat(e.style("padding-top"))+parseFloat(e.style("padding-bottom"))+parseFloat(e.style("margin-top"))+parseFloat(e.style("margin-bottom"))+parseFloat(e.style("border-top-width"))+parseFloat(e.style("border-bottom-width"));return t},r.prototype.calcHeight=function(e){return parseFloat(e.style("height"))+this.calcFrameHeight(e)},r.prototype.clientWidth=function(){return this._size.width-this.calcFrameWidth(this._element)},r.prototype.clientHeight=function(){return this._size.height-this.calcFrameHeight(this._element)},r.prototype.resize=function(t){var n=e.prototype.resize.apply(this,arguments);return this._parentElement.style("width",this._size.width+"px").style("height",this._size.height+"px"),n},r.prototype.target=function(e){if(!arguments.length)return this._target;if(this._target&&e)throw"Target can only be assigned once.";this._target=e;if(typeof this._target=="string"||this._target instanceof String)this._target=document.getElementById(this._target);if(this._target instanceof SVGElement){var t=this.locateOverlayNode();this._parentElement=t.append("div").style({position:"absolute",top:0,left:0,overflow:"hidden"}),this._overlayElement=n.select(this._target);var r=this;this.oldPos=null,this.observer=new this.MutationObserver(function(e){r.syncOverlay()});var i=this._overlayElement.node();while(i)this.observer.observe(i,{attributes:!0}),i=i.parentNode}else if(this._target){this._parentElement=n.select(this._target);if(!this._size.width&&!this._size.height){var s=parseFloat(this._parentElement.style("width")),o=parseFloat(this._parentElement.style("height"));this.size({width:s,height:o})}this._parentElement=n.select(this._target).append("div")}else this.exit();return this},r.prototype.exit=function(t,n,r){this.observer&&this.observer.disconnect(),this.oldPos=null,this._parentElement&&this._parentElement.remove(),e.prototype.exit.apply(this,arguments)},r}),function(e,t){typeof define=="function"&&define.amd?define("common/IList",[],t):e.common_IList=t()}(this,function(){function e(){}return e.prototype.testData=function(){var e=["This","is a","list","of some text."];return this.data(e),this},e.prototype.click=function(e){console.log("Click:  "+e)},e}),function(e,t){typeof define=="function"&&define.amd?define("common/IMenu",[],t):e.common_IMenu=t()}(this,function(){function e(){}return e.prototype.testData=function(){var e=["This","is a","list","of some text."];return this.data(e),this},e.prototype.click=function(e){console.log("Click:  "+e)},e.prototype.preShowMenu=function(){console.log("preShowMenu")},e.prototype.postHideMenu=function(e){console.log("postHideMenu")},e}),function(e,t){typeof define=="function"&&define.amd?define("common/Shape.js",["./SVGWidget","css!./Shape"],t):e.common_Shape=t(e.common_SVGWidget)}(this,function(e){function t(){e.call(this),this._class="common_Shape"}return t.prototype=Object.create(e.prototype),t.prototype.publish("shape","circle","set","Shape Type",["circle","square","rect","ellipse"]),t.prototype.publish("width",24,"number","Width"),t.prototype.publish("height",24,"number","Height"),t.prototype.publish("color_stroke",null,"html-color","Stroke Color",null),t.prototype.publish("color_fill",null,"html-color","Fill Color",null),t.prototype.radius=function(e){return arguments.length?(this._width=e,this._height=e,this):Math.max(this._width,this._height)/2},t.prototype.testData=function(){return this},t.prototype.intersection=function(t,n){switch(this._shape){case"circle":return this.intersectCircle(t,n)}return e.prototype.intersection.apply(this,arguments)},t.prototype.update=function(e,t){var n=t.selectAll("rect,circle,ellipse").data([this._shape],function(e){return e});n.enter().append(this._shape==="square"?"rect":this._shape).attr("class","common_Shape");var r=this;n.each(function(e){var t=d3.select(this);t.style({fill:r._color_fill!==r.__meta_color_fill.defaultValue?r._color_fill:null,stroke:r._color_stroke!==r.__meta_color_stroke.defaultValue?r._color_stroke:null});switch(r._shape){case"circle":var n=r.radius();t.attr("r",n);break;case"square":var i=Math.max(r._width,r._height);t.attr("x",-i/2).attr("y",-i/2).attr("width",i).attr("height",i);break;case"rect":t.attr("x",-r._width/2).attr("y",-r._height/2).attr("width",r._width).attr("height",r._height);break;case"ellipse":t.attr("rx",r._width/2).attr("ry",r._height/2)}}),n.exit().remove()},t}),function(e,t){typeof define=="function"&&define.amd?define("common/Icon",["./SVGWidget","./Shape","./FAChar","css!./Icon"],t):e.common_Icon=t(e.common_SVGWidget,e.common_Shape,e.common_FAChar)}(this,function(e,t,n){function r(){e.call(this),this._class="common_Icon",this._shapeWidget=new t,this._faChar=new n}return r.prototype=Object.create(e.prototype),r.prototype.publish("shape","circle","set","Shape Type",["circle","square"]),r.prototype.publishProxy("faChar","_faChar","char"),r.prototype.publishProxy("image_color_fill","_faChar","color_fill"),r.prototype.publish("tooltip","","string","Tooltip"),r.prototype.publish("diameter",24,"number","Diameter"),r.prototype.publish("padding_percent",45,"number","Padding Percent"),r.prototype.publishProxy("shape_color_fill","_shapeWidget","color_fill"),r.prototype.publishProxy("shape_color_stroke","_shapeWidget","color_stroke"),r.prototype.testData=function(){return this._faChar.testData(),this},r.prototype.intersection=function(e,t){return this._shapeWidget.intersection(e,t)},r.prototype.enter=function(t,n){e.prototype.enter.apply(this,arguments),this._shapeWidget.target(t).render(),this._faChar.target(t).render(),this._tooltipElement=n.append("title")},r.prototype.update=function(t,n){e.prototype.update.apply(this,arguments),this._faChar.font_size(this._diameter*(100-this._padding_percent)/100).render(),this._shapeWidget.shape(this._shape).width(this._diameter).height(this._diameter).render(),this._tooltipElement.text(this._tooltip)},r}),function(e,t){typeof define=="function"&&define.amd?define("common/TextBox.js",["./SVGWidget","./Shape","./Text","css!./TextBox"],t):e.common_TextBox=t(e.common_SVGWidget,e.common_Shape,e.common_Text)}(this,function(e,t,n){function r(){e.call(this),this._class="common_TextBox",this._shape=(new t).shape("rect"),this._text=new n}return r.prototype=Object.create(e.prototype),r.prototype.publishProxy("text","_text"),r.prototype.publishProxy("shape_color_stroke","_shape","color_stroke"),r.prototype.publishProxy("shape_color_fill","_shape","color_fill"),r.prototype.publishProxy("text_color_fill","_text","color_fill"),r.prototype.publish("padding_left",4,"number","Padding:  Left"),r.prototype.publish("padding_right",4,"number","Padding:  Right"),r.prototype.publish("padding_top",4,"number","Padding:  Top"),r.prototype.publish("padding_bottom",4,"number","Padding:  Bottom"),r.prototype.publishProxy("anchor","_text"),r.prototype.publish("fixedSize",null),r.prototype.padding=function(e){return this._padding_left=e,this._padding_right=e,this._padding_top=e,this._padding_bottom=e,this},r.prototype.testData=function(){return this._text.testData(),this},r.prototype.enter=function(t,n){e.prototype.enter.apply(this,arguments),this._shape.target(t).render(),this._text.target(t).render()},r.prototype.update=function(t,n){e.prototype.update.apply(this,arguments),this._text.render();var r=this._text.getBBox(!0),i={width:this._fixedSize?this._fixedSize.width:r.width+this._padding_left+this._padding_right,height:this._fixedSize?this._fixedSize.height:r.height+this._padding_top+this._padding_bottom};this._shape.width(i.width).height(i.height).render();if(this._fixedSize)switch(this.anchor()){case"start":this._text.x(-this._fixedSize.width/2+r.width/2+(this._padding_left+this._padding_right)/2).render();break;case"end":this._text.x(this._fixedSize.width/2-r.width/2-(this._padding_left+this._padding_right)/2).render()}},r}),function(e,t){typeof define=="function"&&define.amd?define("common/List",["d3/d3","../common/SVGWidget","./IList","../common/TextBox","css!./List"],t):e.common_List=t(e.d3,e.common_SVGWidget,e.common_IList,e.common_TextBox)}(this,function(e,t,n,r){function i(e){t.call(this),n.call(this),this._class="common_List",this._listWidgets={}}return i.prototype=Object.create(t.prototype),i.prototype.implements(n.prototype),i.prototype.publish("anchor","start","set","Anchor Position",["","start","middle","end"]),i.prototype.update=function(e,n){t.prototype.update.apply(this,arguments);var i=this,s=n.selectAll(".line").data(this._data,function(e){return e});s.enter().append("g").attr("class","line").each(function(e){var t=(new r).target(this).padding_top(0).padding_bottom(0).padding_left(8).padding_right(8).text(e).render();t.element().on("click",function(e){i.click(e.text())}),i._listWidgets[e]=t});var o=0,u=0,a=0;for(var f in this._listWidgets){var l=this._listWidgets[f].getBBox();o+=l.height,u<l.width&&(u=l.width),++a}var c=o/a,h=-u/2,p=-o/2;s.each(function(e){var t=i._listWidgets[e],n=t.getBBox();t.pos({x:0,y:p+n.height/2}).anchor(i._anchor).fixedSize({width:u,height:n.height}).render(),p+=n.height}),s.exit().remove().each(function(e){delete i._listWidgets[e]})},i}),function(e,t){typeof define=="function"&&define.amd?define("common/Menu",["./SVGWidget","./IMenu","./Icon","./List","css!./Menu"],t):e.common_Menu=t(e.common_SVGWidget,e.common_IMenu,e.common_Icon,e.common_List)}(this,function(e,t,n,r){function i(){e.call(this),t.call(this),this._class="common_Menu",this._icon=(new n).shape("rect").diameter(14),this._list=new r;var i=this;this._list.click=function(e){d3.event.stopPropagation(),i.hideMenu(),i.click(e)},this._visible=!1}return i.prototype=Object.create(e.prototype),i.prototype.implements(t.prototype),i.prototype.publishProxy("faChar","_icon",null,""),i.prototype.publishProxy("padding_percent","_icon",null,10),i.prototype.toggleMenu=function(){this._visible?this.hideMenu():this.showMenu()},i.prototype.showMenu=function(){this.preShowMenu(),this._visible=!0,this._list.data(this._data).render();var e=this._icon.getBBox(!0),t=this._list.getBBox(!0),n={x:e.width/2-t.width/2,y:e.height/2+t.height/2};this._list.move(n);var r=this;d3.select("body").on("click."+this._id,function(){console.log("click:  body - "+r._id),r._visible&&r.hideMenu()})},i.prototype.hideMenu=function(){d3.select("body").on("click."+this._id,null),this._visible=!1,this._list.data([]).render(),this.postHideMenu()},i.prototype.testData=function(){return this.data(["Menu A","And B","a longer C"]),this},i.prototype.enter=function(t,n){e.prototype.enter.apply(this,arguments),this._icon.target(t).render(),this._list.target(t).render();var r=this;this._icon.element().on("click",function(e){d3.event.stopPropagation(),r.toggleMenu()})},i.prototype.update=function(t,n){e.prototype.update.apply(this,arguments),n.classed("disabled",this._data.length===0),this._icon.faChar(this.faChar()).padding_percent(this.padding_percent()).render()},i}),function(e,t){typeof define=="function"&&define.amd?define("common/Palette.js",["d3/d3","colorbrewer/colorbrewer"],t):e.common_Palette=t(e.d3)}(this,function(e){function s(e,t){if(!e)return o();var n=i[e];return n||(n=o(e,t),i[e]=n),n}function o(u,a){function h(e){return f(e)}if(!u)return["default"].concat(t.concat(n).concat(r));var u=u,f=null,a=a;if(a)f=e.scale.ordinal().range(a);else{if(t.indexOf(u)>=0)f=new e.scale[u];else if(r.indexOf(u)>=0){var l=[];switch(u){case"hpcc10":var a=o("default").colors();l=a.filter(function(e,t){return t%2?!0:!1});break;case"hpcc20":l=o("category10").colors().concat(o("hpcc10").colors())}f=e.scale.ordinal().range(l)}else if(n.indexOf(u)>0){var c=12;while(c>0){if(colorbrewer[u][c]){f=e.scale.ordinal().range(colorbrewer[u][c]);break}--c}}f||(f=e.scale.category20()),a=f.range()}return h.id=function(e){return arguments.length?(u=e,h):u},h.colors=function(e){return arguments.length?(a=e,h):a},h.clone=function(e){return i[e]=o(e,this.colors()),i[e]},h.switch=function(e,t){return u===e?this:arguments.length?s(e,t):s()},h}function a(e,t,n){if(!e)return f();var r=u[e];return r||(r=f(e,t),u[e]=r),r}function f(t,r,i){function d(e,t,n){return l.domain([t,n])(e)}if(!arguments.length){var s=["default"];for(var o in colorbrewer)n.indexOf(o)===-1&&s.push(o);return s}var t=t,l=null,c=r,h=function(t,n){n=n||32;var r=Math.ceil(n/(t.length-1)),i=[],s=null;return t.forEach(function(t){if(s){var n=e.scale.linear().domain([0,r]).range([s,t]).interpolate(e.interpolateLab);for(var o=0;o<r;++o)i.push(n(o))}s=t}),l=e.scale.quantize().domain([0,100]).range(i),l};if(r)l=h(r,i);else{if(colorbrewer[t]){var p=12;while(p>0){if(colorbrewer[t][p]){l=h(colorbrewer[t][p]);break}--p}}l||(l=h(colorbrewer.RdYlGn[11])),c=l.range()}return d.id=function(e){return arguments.length?(t=e,d):t},d.colors=function(e){return arguments.length?(c=e,d):c},d.clone=function(e){return u[e]=f(e,this.color()),u[e]},d.switch=function(e,n){return t===e?this:arguments.length?a(e,n):a()},d}var t=["category10","category20","category20b","category20c"],n=["Accent","Dark2","Paired","Pastel1","Pastel2","Set1","Set2","Set3"],r=["hpcc10","hpcc20"],i={},u={},l=function(t,n,r,i,s){e.select(t).selectAll(".palette").data(o(),function(e){return e}).enter().append("span").attr("class","palette").attr("title",function(e){return e}).on("click",function(t){console.log(e.values(t.value).map(JSON.stringify).join("\n"))}).selectAll(".swatch").data(function(e){return o(e).colors()}).enter().append("span").attr("class","swatch").style("background-color",function(e){return e}),e.select(n).selectAll(".palette").data(f(),function(e){return e}).enter().append("span").attr("class","palette").attr("title",function(e){return e}).on("click",function(t){console.log(e.values(t.value).map(JSON.stringify).join("\n"))}).selectAll(".swatch2").data(function(e){return f(e).colors()}).enter().append("span").attr("class","swatch2").style("height","8px").style("background-color",function(e){return e});var u={id:i.join("_")+s,scale:f("custom",i,s)};e.select(r).selectAll(".palette").data([u],function(e){return e.id}).enter().append("span").attr("class","palette").attr("title",function(e){return"aaa"}).on("click",function(t){console.log(e.values(t.value).map(JSON.stringify).join("\n"))}).selectAll(".swatch2").data(function(e){var t=[];for(var n=0;n<=255;++n)t.push(u.scale(n,0,255));return t}).enter().append("span").attr("class","swatch2").style("background-color",function(e){return e})};return{ordinal:s,rainbow:a,test:l}}),function(e,t){typeof define=="function"&&define.amd?define("common/Surface.js",["./SVGWidget","./Icon","./Shape","./Text","./FAChar","./Menu","css!./Surface"],t):e.common_Surface=t(e.common_SVGWidget,e.common_Icon,e.common_Shape,e.common_Text,e.common_FAChar,e.common_Menu)}(this,function(e,t,n,r,i,s){function o(){e.call(this),this._class="common_Surface",this._menuPadding=2,this._icon=(new t).faChar("").padding_percent(50),this._container=(new n).class("container").shape("rect"),this._titleRect=(new n).class("title").shape("rect"),this._text=(new r).class("title"),this._menu=(new s).padding_percent(0);var i=this;this._menu.preShowMenu=function(){i._content&&i._content.hasOverlay()&&i._content.visible(!1)},this._menu.postHideMenu=function(){i._content&&i._content.hasOverlay()&&i._content.visible(!0)},this._showContent=!0,this._content=null}return o.prototype=Object.create(e.prototype),o.prototype.publish("show_title",!0,"boolean","Show Title"),o.prototype.publish("title","","string","Title"),o.prototype.publishProxy("title_font_size","_text","font_size"),o.prototype.publish("show_icon",!0,"boolean","Show Title"),o.prototype.publishProxy("icon_faChar","_icon","faChar"),o.prototype.publishProxy("icon_shape","_icon","shape"),o.prototype.publish("content",null,"widget","Content"),o.prototype.menu=function(e){return arguments.length?(this._menu.data(e),this):this._menu.data()},o.prototype.showContent=function(e){return arguments.length?(this._showContent=e,this._content&&this._content.visible(this._showContent),this):this._showContent},o.prototype.content=function(e){if(!arguments.length)return this._content;this._content=e;switch(this._content.class()){case"bar":this.icon_faChar("");break;case"bubble":this.icon_faChar("");break;case"pie":this.icon_faChar("");break;case"table":this.icon_faChar("")}return this},o.prototype.testData=function(){return this.title("Hello and welcome!"),this.menu(["aaa","bbb","ccc"]),this},o.prototype.enter=function(t,n){e.prototype.enter.apply(this,arguments);var r=n.append("g").attr("class","frame"),i=r.node();this._clipRect=r.append("defs").append("clipPath").attr("id",this.id()+"_clip").append("rect").attr("x",0).attr("y",0).attr("width",this._size.width).attr("height",this._size.height),this._titleRect.target(i).render().display(this._show_title&&this._show_icon),this._icon.target(i).render();var s=!1;this._menu.target(t),this._text.target(i),this._container.target(i)},o.prototype.update=function(t,n){e.prototype.update.apply(this,arguments),this._icon.display(this._show_title&&this._show_icon).render(),this._menu.render(),this._text.text(this._title).display(this._show_title).render();var r=this._show_icon?this._icon.getBBox(!0):{width:0,height:0},i=this._text.getBBox(!0),s=this._menu.getBBox(!0),o=Math.max(r.height,i.height,s.height),u=(-this._size.height+o)/2,a=Math.max(i.height,s.height),f=o<=a?0:(o-a)/2,l=f;this._titleRect.pos({x:l,y:u}).width(this._size.width-l*2).height(a).display(this._show_title).render(),this._icon.move({x:-this._size.width/2+r.width/2,y:u}),this._menu.move({x:this._size.width/2-s.width/2-this._menuPadding,y:u}),this._text.move({x:(r.width/2-s.width/2)/2,y:u}),this._show_title?this._container.pos({x:l/2,y:o/2-f/2}).width(this._size.width-l).height(this._size.height-o+f).render():this._container.pos({x:0,y:0}).width(this._size.width).height(this._size.height).render();if(this._showContent){var c=l,h=o-f,p=this,d=n.selectAll(".content").data(this._content?[this._content]:[],function(e){return e._id});d.enter().append("g").attr("class","content").attr("clip-path","url(#"+this.id()+"_clip)").each(function(e){e.target(this)}),d.each(function(e){var t={left:4,top:4,right:4,bottom:4};e.pos({x:c/2,y:h/2}).size({width:p._size.width-c-(t.left+t.right),height:p._size.height-h-(t.top+t.bottom)})}),this._content&&this._clipRect.attr("x",-this._size.width/2+c).attr("y",-this._size.height/2+h).attr("width",this._size.width-c).attr("height",this._size.height-h),d.exit().transition().each(function(e){e.target(null)}).remove()}this._menu.element().node().parentNode.appendChild(this._menu.element().node())},o.prototype.exit=function(t,n){this._content&&this._content.target(null),e.prototype.exit.apply(this,arguments)},o.prototype.render=function(t){this._content||e.prototype.render.apply(this,arguments),e.prototype.render.call(this);var n=this;return this._content&&this._content.render(function(e){t&&t(n)}),this},o.prototype.intersection=function(e,t){var n=[],r=this._icon.intersection(e,t,this._pos);r&&n.push({i:r,d:this.distance(r,t)});var i=this._titleRect.intersection(e,t);i&&n.push({i:i,d:this.distance(i,t)});var s=this._container.intersection(e,t);s&&n.push({i:s,d:this.distance(s,t)});var o=null;return n.forEach(function(e){if(o===null||o.d>e.d)o=e}),o&&o.i?o.i:null},o}),function(e,t){typeof define=="function"&&define.amd?define("common/ResizeSurface.js",["./Surface","css!./ResizeSurface"],t):e.common_ResizeSurface=t(e.common_Surface)}(this,function(e){function t(){e.call(this),this.handleWidth=8,this.handles=[{loc:"NW"},{loc:"N"},{loc:"NE"},{loc:"E"},{loc:"SE"},{loc:"S"},{loc:"SW"},{loc:"W"}],this._allowResize=!0;var t=this;this.dispatch=d3.dispatch("sizestart","size","sizeend"),this.drag=d3.behavior.drag().origin(function(e){return e}).on("dragstart",function(e){t.dispatch.sizestart(t,e.loc),t._allowResize&&(d3.event.sourceEvent.stopPropagation(),t._dragHandlePos={x:e.x,y:e.y},t._dragStartPos=t.pos(),t._dragStartSize=t.size(),t._prevPosSize={x:t._dragStartPos.x,y:t._dragStartPos.y,width:t._dragStartSize.width,height:t._dragStartSize.height},t._textPosSize=t._text.getBBox(!0),t._iconPosSize=t._icon.getBBox(!0),t.showContent(!1))}).on("drag",function(e){if(t._allowResize){d3.event.sourceEvent.stopPropagation();var n=d3.event.x-t._dragHandlePos.x,r=d3.event.y-t._dragHandlePos.y,i={x:0,y:0,w:0,h:0};switch(e.loc){case"NW":i.x=n/2,i.w=-n;case"N":i.y=r/2,i.h=-r;break;case"NE":i.y=r/2,i.h=-r;case"E":i.x=n/2,i.w=n;break;case"SE":i.x=n/2,i.w=n;case"S":i.y=r/2,i.h=r;break;case"SW":i.y=r/2,i.h=r;case"W":i.x=n/2,i.w=-n}var s={x:t._dragStartPos.x+i.x,y:t._dragStartPos.y+i.y,width:t._dragStartSize.width+i.w,height:t._dragStartSize.height+i.h};s.width<t._iconPosSize.width*2+t._textPosSize.width&&(s.x=t._prevPosSize.x,s.width=t._prevPosSize.width),s.height<t._textPosSize.height+48&&(s.y=t._prevPosSize.y,s.height=t._prevPosSize.height),t.pos({x:s.x,y:s.y},!1,!1).size({width:s.width,height:s.height}).render().getBBox(!0),t.dispatch.size(t,e.loc),t._prevPosSize=s}}).on("dragend",function(e){t._allowResize&&(d3.event.sourceEvent.stopPropagation(),t.showContent(!0).render(),t._container.getBBox(!0),t._titleRect.getBBox(!0),t.dispatch.sizeend(t,e.loc))})}return t.prototype=Object.create(e.prototype),t.prototype.allowResize=function(e){return arguments.length?(this._allowResize=e,this):this._allowResize},t.prototype.move=function(t){var n=e.prototype.move.apply(this,arguments);return this.updateHandles(this._domNode,this._element),n},t.prototype.update=function(t,n){e.prototype.update.apply(this,arguments),this.updateHandles(t,n)},t.prototype.updateHandles=function(e,t){var n=this._parentElement.selectAll("rect").data(this.handles,function(e){return e.loc});n.enter().append("rect").attr("class",function(e){return"resize"+e.loc}).call(this.drag);var r=this._pos.x+this._container._pos.x-this._container.width()/2,i=this._pos.y+this._titleRect._pos.y-this._titleRect.height()/2,s=this._pos.x+this._container._pos.x+this._container.width()/2,o=this._pos.y+this._container._pos.y+this._container.height()/2,u=s-r,a=o-i,f=this;n.each(function(e){switch(e.loc){case"NW":e.x=r-f.handleWidth/2,e.y=i-f.handleWidth/2,e.width=f.handleWidth,e.height=f.handleWidth;break;case"N":e.x=r+f.handleWidth/2,e.y=i-f.handleWidth/2,e.width=u-f.handleWidth,e.height=f.handleWidth;break;case"NE":e.x=s-f.handleWidth/2,e.y=i-f.handleWidth/2,e.width=f.handleWidth,e.height=f.handleWidth;break;case"E":e.x=s-f.handleWidth/2,e.y=i+f.handleWidth/2,e.width=f.handleWidth,e.height=a-f.handleWidth;break;case"SE":e.x=s-f.handleWidth/2,e.y=o-f.handleWidth/2,e.width=f.handleWidth,e.height=f.handleWidth;break;case"S":e.x=r+f.handleWidth/2,e.y=o-f.handleWidth/2,e.width=u-f.handleWidth,e.height=f.handleWidth;break;case"SW":e.x=r-f.handleWidth/2,e.y=o-f.handleWidth/2,e.width=f.handleWidth,e.height=f.handleWidth;break;case"W":e.x=r-f.handleWidth/2,e.y=i+f.handleWidth/2,e.width=f.handleWidth,e.height=a-f.handleWidth}d3.select(this).attr("x",e.x).attr("y",e.y).attr("width",e.width).attr("height",e.height)})},t});