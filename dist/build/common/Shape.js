(function(e,t){typeof define=="function"&&define.amd?define(["./SVGWidget","css!./Shape"],t):e.Shape=t(e.SVGWidget)})(this,function(e){function t(){e.call(this),this._class="common_Shape"}return t.prototype=Object.create(e.prototype),t.prototype.publish("shape","circle","set","Shape Type",["circle","square","rect","ellipse"]),t.prototype.publish("width",24,"number","Width"),t.prototype.publish("height",24,"number","Height"),t.prototype.publish("color_stroke",null,"html-color","Stroke Color",null),t.prototype.publish("color_fill",null,"html-color","Fill Color",null),t.prototype.radius=function(e){return arguments.length?(this._width=e,this._height=e,this):Math.max(this._width,this._height)/2},t.prototype.testData=function(){return this},t.prototype.intersection=function(t,n){switch(this._shape){case"circle":return this.intersectCircle(t,n)}return e.prototype.intersection.apply(this,arguments)},t.prototype.update=function(e,t){var n=t.selectAll("rect,circle,ellipse").data([this._shape],function(e){return e});n.enter().append(this._shape==="square"?"rect":this._shape).attr("class","common_Shape");var r=this;n.each(function(e){var t=d3.select(this);t.style({fill:r._color_fill!==r.__meta_color_fill.defaultValue?r._color_fill:null,stroke:r._color_stroke!==r.__meta_color_stroke.defaultValue?r._color_stroke:null});switch(r._shape){case"circle":var n=r.radius();t.attr("r",n);break;case"square":var i=Math.max(r._width,r._height);t.attr("x",-i/2).attr("y",-i/2).attr("width",i).attr("height",i);break;case"rect":t.attr("x",-r._width/2).attr("y",-r._height/2).attr("width",r._width).attr("height",r._height);break;case"ellipse":t.attr("rx",r._width/2).attr("ry",r._height/2)}}),n.exit().remove()},t});