(function(e,t){typeof define=="function"&&define.amd?define(["./SVGWidget","./IMenu","./Icon","./List","css!./Menu"],t):e.Menu=t(e.SVGWidget,e.IMenu,e.Icon,e.List)})(this,function(e,t,n,r){function i(){e.call(this),t.call(this),this._class="common_Menu",this._icon=(new n).shape("rect").diameter(14),this._list=new r;var i=this;this._list.click=function(e){d3.event.stopPropagation(),i.hideMenu(),i.click(e)},this._visible=!1}return i.prototype=Object.create(e.prototype),i.prototype.implements(t.prototype),i.prototype.publishProxy("faChar","_icon",null,"ïƒ‰"),i.prototype.publishProxy("padding_percent","_icon",null,10),i.prototype.toggleMenu=function(){this._visible?this.hideMenu():this.showMenu()},i.prototype.showMenu=function(){this.preShowMenu(),this._visible=!0,this._list.data(this._data).render();var e=this._icon.getBBox(!0),t=this._list.getBBox(!0),n={x:e.width/2-t.width/2,y:e.height/2+t.height/2};this._list.move(n);var r=this;d3.select("body").on("click."+this._id,function(){console.log("click:  body - "+r._id),r._visible&&r.hideMenu()})},i.prototype.hideMenu=function(){d3.select("body").on("click."+this._id,null),this._visible=!1,this._list.data([]).render(),this.postHideMenu()},i.prototype.testData=function(){return this.data(["Menu A","And B","a longer C"]),this},i.prototype.enter=function(t,n){e.prototype.enter.apply(this,arguments),this._icon.target(t).render(),this._list.target(t).render();var r=this;this._icon.element().on("click",function(e){d3.event.stopPropagation(),r.toggleMenu()})},i.prototype.update=function(t,n){e.prototype.update.apply(this,arguments),n.classed("disabled",this._data.length===0),this._icon.faChar(this.faChar()).padding_percent(this.padding_percent()).render()},i});