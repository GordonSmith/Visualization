(function(e,t){typeof define=="function"&&define.amd?define(["../common/SVGWidget","./ISlider","css!./Slider"],t):e.other_Slider=t(e.common_SVGWidget,e.other_ISlider)})(this,function(e,t){function n(){e.call(this),t.call(this),this._class="other_Slider",this._selectionLabel="",this.xScale=d3.scale.linear().clamp(!0);var n=this;this.brush=d3.svg.brush().x(this.xScale).extent([0,0]).on("brushstart",function(e){n.brushstart(e,this)}).on("brush",function(e){n.brushmove(e,this)}).on("brushend",function(e){n.brushend(e,this)}),this.brush.empty=function(){return!1},this.axis=d3.svg.axis().scale(this.xScale).orient("bottom").tickFormat(function(e){return e}).tickSize(0).tickPadding(12)}return n.prototype=Object.create(e.prototype),n.prototype.implements(t.prototype),n.prototype.publish("allowRange",!1,"boolean","Allow Range Selection"),n.prototype.publish("low",0,"number","Low"),n.prototype.publish("high",100,"number","High"),n.prototype.publish("step",10,"number","Step"),n.prototype.publish("selectionLabel","","string","Selection Label"),n.prototype.testData=function(e){return this.columns("Percent"),this.data(66),this},n.prototype.testData2=function(e){return this.allowRange(!0),this.columns("Percent"),this.data([44,66]),this},n.prototype.data=function(t){var n=e.prototype.data.apply(this,arguments);return arguments.length&&this.brushg&&this.brushg.call(this.brush.extent(this._allowRange?this._data:[this._data,this._data])),n},n.prototype.enter=function(e,t){(this._high-this._low)/this._step<=10&&this.axis.tickValues(d3.merge([d3.range(this._low,this._high,this._step),[this._high]])),this.axisElement=t.append("g").attr("class","x axis"),this.brushg=t.append("g").attr("class","brush").call(this.brush),this.brushg.select(".background").attr("y",-9).attr("height",18),this.brushg.select(".extent").attr("y","-10").attr("height","20"),this.brushg.selectAll(".resize").select("rect").attr("x",function(e){return e==="e"?0:-8}).attr("y","-10").attr("width","8").attr("height","20"),this.handle=this.brushg.selectAll(".resize").append("path").attr("class","handle").attr("transform","translate(0,-27)")},n.prototype.update=function(e,t){var n=this,r=this.width()-50;this.xScale.domain([this._low,this._high]).range([-r/2,r/2]),this.axisElement.call(this.axis);var i=this.xScale.range();this.brushg.select(".background").attr("x",i[0]).attr("width",i[1]-i[0]),this.handle.attr("d",function(e){return n.handlePath(e)});if(this._initHandle===undefined){this._initHandle=!0;var s=[this._low,this._low];if(this._allowRange&&this._data)var s=this._data;else this._data&&(s=[this._data,this._data]);this.brushg.call(this.brush.extent(s))}},n.prototype.brushstart=function(e,t){if(!d3.event||!d3.event.sourceEvent)return;d3.event.sourceEvent.stopPropagation()},n.prototype.brushmove=function(e,t){if(!d3.event||!d3.event.sourceEvent)return;d3.event.sourceEvent.stopPropagation();if(!this._allowRange){var n=this.xScale.invert(d3.mouse(t)[0]);d3.select(t).call(this.brush.extent([n,n]))}},n.prototype.brushend=function(e,t){if(!d3.event||!d3.event.sourceEvent)return;d3.event.sourceEvent.stopPropagation();if(!this._allowRange){var n=this.nearestStep(this.xScale.invert(d3.mouse(t)[0]));d3.select(t).call(this.brush.extent([n,n])),this._data=n;if(this._selectionLabel){var r={};r[this._selectionLabel]=n,this.click(r)}else this.click(n)}else{var i=this.brush.extent();i[0]=this.nearestStep(i[0]),i[1]=this.nearestStep(i[1]),this._data=i,d3.select(t).call(this.brush.extent(i)),this.newSelection(i[0],i[1])}},n.prototype.nearestStep=function(e){return this._low+Math.round((e-this._low)/this._step)*this._step},n.prototype.handlePath=function(e,t){var n=+(e==="e"),r=n?1:-1,i=this._allowRange?.5:0,s=18,o="M"+i*r+","+s+"A6,6 0 0 "+n+" "+6.5*r+","+(s+6)+"V"+(2*s-6)+"A6,6 0 0 "+n+" "+i*r+","+2*s;return this._allowRange?o+="ZM"+2.5*r+","+(s+8)+"V"+(2*s-8)+"M"+4.5*r+","+(s+8)+"V"+(2*s-8):o+="M"+1*r+","+(s+8)+"V"+(2*s-8),o},n});