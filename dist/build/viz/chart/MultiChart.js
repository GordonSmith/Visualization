(function(e,t){typeof define=="function"&&define.amd?define(["d3/d3","../common/SVGWidget","./INDChart","../other/Persist","require"],t):e.chart_MultiChart=t(e.d3,e.common_SVGWidget,e.chart_INDChart,e.other_Persist,e.require)})(this,function(e,t,n,r,i){function f(){t.call(this),n.call(this),this._class="chart_MultiChart",this._chart=null,this._2dChartTypes=s,this._multiChartTypes=o,this._anyChartTypes=u,this._allChartTypes=a,this._allCharts={},this._allChartTypes.forEach(function(e){var t=JSON.parse(JSON.stringify(e));t.widget=null,this._allCharts[e.id]=t,this._allCharts[e.display]=t,this._allCharts[e.widgetClass]=t},this),this._allCharts.BAR=this._allCharts.COLUMN}var s=[{id:"BUBBLE",display:"Bubble",widgetClass:"chart_Bubble"},{id:"COLUMN",display:"Column",widgetClass:"chart_Column"},{id:"PIE",display:"Pie",widgetClass:"chart_Pie"},{id:"GOOGLE_PIE",display:"Pie (Google)",widgetClass:"google_Pie"},{id:"C3_PIE",display:"Pie (C3)",widgetClass:"c3_Pie"},{id:"C3_DONUT",display:"Donut (C3)",widgetClass:"c3_Donut"},{id:"WORD_CLOUD",display:"Word Cloud",widgetClass:"other_WordCloud"}],o=[{id:"GOOGLE_BAR",display:"Bar (Google)",widgetClass:"google_Bar"},{id:"GOOGLE_COLUMN",display:"Column (Google)",widgetClass:"google_Column"},{id:"LINE",display:"Line",widgetClass:"chart_Line"},{id:"GOOGLE_LINE",display:"Line (Google)",widgetClass:"google_Line"},{id:"C3_LINE",display:"Line (C3)",widgetClass:"c3_Line"},{id:"C3_BAR",display:"Bar (C3)",widgetClass:"c3_Bar"},{id:"C3_COLUMN",display:"Column (C3)",widgetClass:"c3_Column"},{id:"C3_STEP",display:"Step (C3)",widgetClass:"c3_Step"},{id:"C3_AREA",display:"Area (C3)",widgetClass:"c3_Area"},{id:"C3_SCATTER",display:"Scatter (C3)",widgetClass:"c3_Scatter"}],u=[{id:"TABLE",display:"Table",widgetClass:"other_Table"}],a=s.concat(o.concat(u));return f.prototype=Object.create(t.prototype),f.prototype.implements(n.prototype),f.prototype.publish("chart_type","BUBBLE","set","Chart Type",a.map(function(e){return e.id})),f.prototype.publish("chart",null,"widget","Chart"),f.prototype.columns=function(e){var n=t.prototype.columns.apply(this,arguments);return arguments.length&&this._chart&&this._chart.columns(e),n},f.prototype.data=function(e){var n=t.prototype.data.apply(this,arguments);return arguments.length&&this._chart&&this._chart.data(e),n},f.prototype.hasOverlay=function(){return this._chart&&this._chart.hasOverlay()},f.prototype.visible=function(e){return arguments.length?(this._chart&&this._chart.visible(e),this):this._chart.visible()},f.prototype.requireContent=function(e,t){var n=this._allCharts[e].widget;if(n){t(n);return}var r=this,s="../"+this._allCharts[e].widgetClass.split("_").join("/");i([s],function(i){n=new i,r._allCharts[e].widget=n,t(n)})},f.prototype.switchChart=function(e){var t=this._chart,n=this;this.requireContent(this._chart_type,function(r){if(r!==t){var i=n.size();n._chart=r.columns(n._columns).data(n._data).size(i),r.click=function(e,t){n.click(e,t)},t&&t.data([]).size({width:1,height:1}).render()}e&&e(this)})},f.prototype.update=function(e,n){t.prototype.update.apply(this,arguments);var r=n.selectAll(".multiChart").data(this._chart?[this._chart]:[],function(e){return e._id});r.enter().append("g").attr("class","multiChart").each(function(e){e.target(this)});var i=this.size();r.each(function(e){e.size(i).render()}),r.exit().transition().each(function(e){e.target(null)}).remove()},f.prototype.exit=function(e,n){this._chart&&this._chart.target(null),t.prototype.exit.apply(this,arguments)},f.prototype.render=function(e){if(this._chart_type&&(!this._chart||this._chart._class!==this._allCharts[this._chart_type].widgetClass)){var n=this,r=arguments;return this.switchChart(function(){t.prototype.render.apply(n,r)}),this}return t.prototype.render.apply(this,arguments)},f});