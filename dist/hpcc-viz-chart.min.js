typeof define=="function"&&define.amd&&define("css",[],function(){return{load:function(e,t,n){n()}}}),function(e,t){typeof define=="function"&&define.amd?define("chart/Axis.js",["d3","../common/SVGWidget","../common/Utility","css!./Axis"],t):e.chart_Axis=t(e.d3,e.common_SVGWidget,e.common_Utility)}(this,function(e,t,n){function r(){t.call(this),this._drawStartPos="origin",this.d3Axis=e.svg.axis(),this.d3Guides=e.svg.axis(),this.updateScale()}r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.prototype._class+=" chart_Axis",r.prototype.publish("title","","string","Title"),r.prototype.publish("orientation","bottom","set","Orientation",["left","top","right","bottom"]),r.prototype.publish("type","linear","set","Type",["none","ordinal","linear","pow","log","time"]),r.prototype.publish("timePattern","%Y-%m-%d","string","Time Series Pattern",null,{disable:function(e){return e.type()!=="time"}}),r.prototype.publish("powExponent",2,"number","Exponent for Pow on Value Axis",null,{disable:function(e){return e.type()!=="pow"}}),r.prototype.publish("logBase",10,"number","Base for log on Value Axis",null,{disable:function(e){return e.type()!=="log"}}),r.prototype.publish("ordinals",[],"array","Ordinal Values",null,{disable:function(e){return e.type()!=="ordinal"}}),r.prototype.publish("tickCount",null,"number","Tick Count",null,{optional:!0,disable:function(e){return e.type()==="ordinal"}}),r.prototype.publish("tickFormat",null,"string","Tick Format",null,{optional:!0,disable:function(e){return e.type()==="ordinal"}}),r.prototype.publish("tickLength",null,"number","Tick Length",{optional:!0}),r.prototype.publish("low",null,"any","Low",null,{optional:!0,disable:function(e){return e.type()==="ordinal"}}),r.prototype.publish("high",null,"any","High",null,{optional:!0,disable:function(e){return e.type()==="ordinal"}}),r.prototype.publish("overlapMode","none","set","Label Overlap Mode",["none","stagger","hide","rotate","linebreak","wrap"]),r.prototype.publish("labelRotation",33,"number","Label Rotation",null,{optional:!0,disable:function(e){return e.overlapMode()!=="rotate"}}),r.prototype.publish("shrinkToFit","both","set","Size to fit",["none","low","high","both"]),r.prototype.publish("extend",5,"number","Extend axis %",{optional:!0,disable:function(e){return e.type()==="ordinal"}});var i=r.prototype.type;r.prototype.type=function(e){var t=i.apply(this,arguments);return arguments.length&&this.updateScale(),t};var s=r.prototype.timePattern;return r.prototype.timePattern=function(e){var t=s.apply(this,arguments);return arguments.length&&this.updateScale(),t},r.prototype.lowValue=function(){return this.parse(this.low())},r.prototype.highValue=function(){return this.parse(this.high())},r.prototype.parse=function(e,t){if(e instanceof Array)return e.map(function(e){return this.parse(e)},this);if(e!==undefined&&e!==null){if(this.parser)return this.parser.parse(typeof e=="number"?e.toString():e);if(t&&typeof e=="string")return+e}return e},r.prototype.parseInvert=function(e){return e instanceof Array?e.map(function(e){return this.parseInvert(e)},this):this.parser?this.parser(e):e},r.prototype.format=function(e){return e instanceof Array?e.map(function(e){return this.format(e)},this):e!==undefined&&e!==null&&this.formatter?this.formatter(e):e},r.prototype.scalePos=function(e){var t=this.d3Scale(this.parse(e));return this.type()==="ordinal"&&(t+=this.d3Scale.rangeBand()/2),t},r.prototype.isHorizontal=function(){switch(this.orientation()){case"left":case"right":return!1}return!0},r.prototype.domain=function(e){return arguments.length?(this.d3Scale.domain(e),this):this.d3Scale.domain()},r.prototype.range=function(e){if(!arguments.length){if(this.d3Scale.rangeRoundBands)return this.d3Scale.rangeExtent();if(this.d3Scale.rangeRound)return this.d3Scale.range()}return this.d3Scale.rangeRoundBands?this.d3Scale.rangeRoundBands(e,.1):this.d3Scale.rangeRound&&this.d3Scale.range(e),this},r.prototype.invert=function(e){return this.d3Scale.invert(e)},r.prototype.guideTarget=function(t){this._guideElement=e.select(t).attr("class",this._class)},r.prototype.enter=function(e,n){t.prototype.enter.apply(this,arguments),this.svg=n.append("g"),this.svgAxis=this.svg.append("g").attr("class","axis"),this.svgText=this.svgAxis.append("text"),this.svg2=(this._guideElement||n).append("g"),this.svgGuides=this.svg2.attr("class","guide")},r.prototype.updateScale=function(){switch(this.type()){case"ordinal":this.d3Scale=e.scale.ordinal(),this.ordinals_exists()&&this.d3Scale.domain(this.ordinals()),this.parser=null,this.formatter=null;break;case"linear":this.d3Scale=e.scale.linear(),this.low_exists()&&this.high_exists()&&this.d3Scale.domain([this.lowValue(),this.highValue()]),this.parser=null,this.formatter=this.tickFormat_exists()?e.format(this.tickFormat()):null;break;case"pow":this.d3Scale=e.scale.pow().exponent(this.powExponent()),this.low_exists()&&this.high_exists()&&this.d3Scale.domain([this.lowValue(),this.highValue()]),this.parser=null,this.formatter=this.tickFormat_exists()?e.format(this.tickFormat()):null;break;case"log":this.d3Scale=e.scale.log().base(this.logBase()),this.low_exists()&&this.high_exists()&&this.d3Scale.domain([this.lowValue(),this.highValue()]),this.parser=null,this.formatter=this.tickFormat_exists()?e.format(this.tickFormat()):null;break;case"time":this.d3Scale=e.time.scale(),this.low_exists()&&this.high_exists()&&this.d3Scale.domain([this.lowValue(),this.highValue()]),this.parser=this.timePattern_exists()?e.time.format(this.timePattern()):null,this.formatter=this.tickFormat_exists()?e.time.format(this.tickFormat()):null}if(this.extend())switch(this.type()){case"ordinal":break;default:var t,n,r,i;this.isHorizontal()?(t=this.width(),this.d3Scale.range([0,t]),n=t*this.extend()/100,r=this.d3Scale.invert(-n),i=this.d3Scale.invert(t+n)):(t=this.height(),this.d3Scale.range([t,0]),n=t*this.extend()/100,r=this.d3Scale.invert(t+n),i=this.d3Scale.invert(-n)),this.d3Scale.domain([r,i])}this.d3Axis.orient(this.orientation()).scale(this.d3Scale).tickFormat(this.formatter).ticks(this.tickCount()),this.d3Guides.orient(this.orientation()).scale(this.d3Scale).tickSize(-this.tickLength()).tickFormat("").ticks(this.tickCount())},r.prototype.adjustText=function(t,n){var r=this.isHorizontal(),i=this.orientation()==="left",s=this.orientation()==="bottom",o=this;if(this.overlapMode()==="linebreak")this.type()==="ordinal"&&t.selectAll(".tick > text").call(function(){return o.linebreak.apply(o,arguments)},this.d3Scale.rangeBand());else if(this.overlapMode()==="wrap")this.type()==="ordinal"&&t.selectAll(".tick > text").call(function(){return o.wrap.apply(o,arguments)},this.d3Scale.rangeBand());else switch(r?this.overlapMode():"none"){case"stagger":t.selectAll(".tick > text").style("text-anchor","middle").attr("dy",function(e,t){return(s?1:-1)*((s?.71:0)+t%n)+"em"}).attr("dx",0).attr("visibility",null).attr("transform","rotate(0)");break;case"hide":t.selectAll(".tick > text").style("text-anchor","middle").attr("dy",(s?.71:0)+"em").attr("dx",0).attr("visibility",function(e,t){return t%n?"hidden":null}).attr("transform","rotate(0)");break;case"rotate":var u=-this.labelRotation()||0;if(u!==0&&n>1){t.selectAll(".tick > text").each(function(){var t=e.select(this),n=t.node().getBBox(),r=(s?1:-1)*Math.sin(Math.PI*(-Math.abs(u)/180));t.style("text-anchor",u>0?s?"start":"end":s?"end":"start").attr("dy",n.height/2*r+"px").attr("dx",u>0?s?"0.71em":"-0.71em":s?"-0.71em":"0.71em").attr("transform","rotate("+u+")").attr("visibility",null)});break};default:t.selectAll(".tick > text").style("text-anchor",r?"middle":i?"end":"start").attr("dy",r?(s?.71:0)+"em":"0.32em").attr("dx",0).attr("visibility",null).attr("transform","rotate(0)")}},r.prototype.calcTickOverlapModulus=function(e){var t=1;switch(this.overlapMode()){case"rotate":case"stagger":case"hide":var n=[];e.selectAll(".tick > text").each(function(e){var r=this.getBoundingClientRect();for(var i=n.length-1;i>=0;--i){if(n[i].right<r.left)break;n.length+1-i>t&&(t=n.length+1-i)}n.push(r)})}return t},r.prototype.calcOverflow=function(e,t){this.updateScale();var n=this.isHorizontal();this.range(n?[0,this.width()]:[this.height(),0]);var r=e.append("g").attr("class",this.classID()).append("g");r.attr("class",n?"x":"y").call(this.d3Axis),t&&e.selectAll(".tick > text").remove();var i={left:0,top:0,right:0,bottom:0,tickOverlapModulus:this.calcTickOverlapModulus(r)};this.adjustText(r,i.tickOverlapModulus);var s=r.node().getBBox();i.depth=n?s.height:s.width;switch(this.shrinkToFit()){case"low":case"both":i.left=n?-s.x:0,i.bottom=n?0:-(this.height()-(s.height+s.y))}switch(this.shrinkToFit()){case"high":case"both":i.top=n?0:-s.y,i.right=n?-(this.width()-s.x-s.width):0}return r.remove(),i},r.prototype.wrap=function(t,n,r){r=r||/\s+/;var i=this;t.each(function(){var t=e.select(this),s=t.text().split(r).reverse(),o,u=[],a=0,f=1.1,l=t.attr("x"),c=t.attr("y"),h=parseFloat(t.style("font-size"))||10,p=Math.floor(n/(h*f))-1,d=i.isHorizontal()?1:Math.ceil(s.length/p),v=parseFloat(t.attr("dy")),m=t.text(null).append("tspan").attr("x",l).attr("y",c).attr("dy",v+"em"),g=0;while(o=s.pop())u.push(o),m.text(u.join(" ")),g++,m.node().getComputedTextLength()>n&&g>=d&&(u.pop(),m.text(u.join(" ")),u=[o],m=t.append("tspan").attr("x",l).attr("y",c).attr("dy",++a*f+v+"em").text(o),g=0);i.isHorizontal()||t.selectAll("tspan").attr("y",-a/2+"em")})},r.prototype.linebreak=function(e,t){this.wrap(e,t,"\n")},r.prototype.update=function(e,n){function s(e){e.attr("transform",function(e){switch(i.orientation()){case"left":return"translate("+r.depth+", "+r.top+")";case"top":return"translate(0,"+r.depth+")";case"right":return"translate("+(i.width()-r.depth)+", "+r.top+")";case"bottom":return"translate(0,"+(i.height()-r.depth)+")"}return"translate(0,0)"})}t.prototype.update.apply(this,arguments);var r=this.calcOverflow(n);this.range(this.isHorizontal()?[r.left,this.width()-r.right]:[this.height()-r.top-r.bottom,0]);var i=this;this.svg.style("visibility",this.type()==="none"?"hidden":null).transition().call(s),this._guideElement&&this.svg2.transition().call(s),this.svgAxis.call(this.d3Axis),this.adjustText(this.svgAxis,r.tickOverlapModulus);var o=this.svgAxis.select("path.domain"),u=o.node().getBBox();switch(this.orientation()){case"left":this.svgText.transition().attr("transform","rotate(-90)").attr("x",-2).attr("y",2).attr("dx",null).attr("dy",".71em").style("text-anchor","end").text(this.title());break;case"right":this.svgText.transition().attr("transform","rotate(-90)").attr("x",-2).attr("y",4).attr("dx",null).attr("dy","-.71em").style("text-anchor","end").text(this.title());break;case"top":this.svgText.transition().attr("transform","rotate(0)").attr("x",u.x+u.width-2).attr("y",2).attr("dx",null).attr("dy",".71em").style("text-anchor","end").text(this.title());break;case"bottom":this.svgText.transition().attr("transform","rotate(0)").attr("x",u.x+u.width-2).attr("y",-2).attr("dx",null).attr("dy",null).style("text-anchor","end").text(this.title())}this.svgGuides.call(this.d3Guides)},r.prototype.postUpdate=function(e,n){t.prototype.postUpdate.apply(this,arguments),this._guideElement&&this._guideElement.attr("transform",this._element.attr("transform"))},r}),function(e,t){typeof define=="function"&&define.amd?define("chart/XYAxis.js",["d3","../common/SVGWidget","./Axis","../common/Utility","css!./XYAxis"],t):e.chart_XYAxis=t(e.d3,e.common_SVGWidget,e.chart_Axis,e.common_Utility)}(this,function(e,t,n,r){function i(){t.call(this),r.SimpleSelectionMixin.call(this),this._drawStartPos="origin",this.domainAxis=(new n).orientation_default("bottom").type_default("ordinal").overlapMode_default("stagger").shrinkToFit_default("high").extend_default(0),this.valueAxis=(new n).orientation_default("left").type_default("linear").shrinkToFit_default("high");var i=this;this.xBrush=e.svg.brush().on("brush",function(){return i.brushMoved()}),this.yBrush=e.svg.brush().on("brush",function(){return i.brushMoved()})}return i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.prototype._class+=" chart_XYAxis",i.prototype.mixin(r.SimpleSelectionMixin),i.prototype.publish("orientation","horizontal","set","Selects orientation for the axis",["horizontal","vertical"]),i.prototype.publish("selectionMode",!1,"boolean","Range Selector"),i.prototype.publishProxy("xAxisTickCount","domainAxis","tickCount"),i.prototype.publishProxy("xAxisTickFormat","domainAxis","tickFormat"),i.prototype.publishProxy("xAxisType","domainAxis","type"),i.prototype.publishProxy("xAxisTypeTimePattern","domainAxis","timePattern"),i.prototype.publish("xAxisDomainLow",null,"string","X-Axis Low",null,{optional:!0,disable:function(e){return e.xAxisType()==="ordinal"}}),i.prototype.publish("xAxisDomainHigh",null,"string","X-Axis High",null,{optional:!0,disable:function(e){return e.xAxisType()==="ordinal"}}),i.prototype.publishProxy("xAxisOverlapMode","domainAxis","overlapMode"),i.prototype.publishProxy("xAxisLabelRotation","domainAxis","labelRotation"),i.prototype.publishProxy("xAxisDomainPadding","domainAxis","extend"),i.prototype.publish("xAxisGuideLines",!1,"boolean","Y-Axis Guide Lines"),i.prototype.publish("xAxisFocus",!1,"boolean","X-Axis Focus",null,{disable:function(e){return e.orientation()!=="horizontal"}}),i.prototype.publish("xAxisFocusHeight",80,"number","X-Axis Focus Height",null,{disable:function(e){return!e.xAxisFocus()}}),i.prototype.publishProxy("yAxisTitle","valueAxis","title"),i.prototype.publishProxy("yAxisTickCount","valueAxis","tickCount"),i.prototype.publishProxy("yAxisTickFormat","valueAxis","tickFormat"),i.prototype.publishProxy("yAxisType","valueAxis","type"),i.prototype.publishProxy("yAxisTypeTimePattern","valueAxis","timePattern"),i.prototype.publishProxy("yAxisTypePowExponent","valueAxis","powExponent"),i.prototype.publishProxy("yAxisTypeLogBase","valueAxis","logBase"),i.prototype.publish("yAxisDomainLow",null,"string","Y-Axis Low",null,{optional:!0,disable:function(e){return e.yAxisType()==="ordinal"}}),i.prototype.publish("yAxisDomainHigh",null,"string","Y-Axis High",null,{optional:!0,disable:function(e){return e.yAxisType()==="ordinal"}}),i.prototype.publishProxy("yAxisDomainPadding","valueAxis","extend"),i.prototype.publish("yAxisGuideLines",!0,"boolean","Y-Axis Guide Lines"),i.prototype.publish("regions",[],"array","Regions"),i.prototype.publish("sampleData","","set","Display Sample Data",["","ordinal","ordinalRange","linear","time-x","time-y"]),i.prototype.resetSelection=function(){return this._prevBrush=null,this},i.prototype.columns=function(e){return t.prototype.columns.apply(this,arguments)},i.prototype.parseData=function(e){return this.domainAxis.parse(e)},i.prototype.parseValue=function(e){return this.valueAxis.parse(e,!0)},i.prototype.formatData=function(e){return this.domainAxis.format(e)},i.prototype.formatValue=function(e){return this.valueAxis.format(e,!0)},i.prototype.parsedData=function(){return this.data().map(function(e){return e.map(function(e,t){return t===0?this.parseData(e):t>=this.columns().length?e:this.parseValue(e)},this)},this)},i.prototype.enter=function(e,n){t.prototype.enter.apply(this,arguments),this.svg=n.append("g"),this.svgRegions=n.append("g"),this.svgDomainGuide=this.svg.append("g"),this.svgValueGuide=this.svg.append("g"),this.svgData=this.svg.append("g"),this.svgDataClipRect=this.svg.append("clipPath").attr("id",this.id()+"_clippath").append("rect").attr("x",0).attr("y",0),this.svgData=this.svg.append("g").attr("clip-path","url(#"+this.id()+"_clippath)"),this._selection.widgetElement(this.svgData),this.svgFocus=n.append("g"),this.domainAxis.target(this.svg.node()).guideTarget(this.svgDomainGuide.node()),this.valueAxis.target(this.svg.node()).guideTarget(this.svgValueGuide.node()),this.svgBrush=n.append("g").attr("class","brush")},i.prototype.resizeBrushHandle=function(e,t,n){var r,i,s;return e==="e"||e==="w"?(r=+(e==="e"),i=r?1:-1,s=n/3,"M"+.5*i+","+s+"A6,6 0 0 "+r+" "+6.5*i+","+(s+6)+"V"+(2*s-6)+"A6,6 0 0 "+r+" "+.5*i+","+2*s+"Z"+"M"+2.5*i+","+(s+8)+"V"+(2*s-8)+"M"+4.5*i+","+(s+8)+"V"+(2*s-8)):(r=+(e==="s"),s=r?1:-1,i=t/3,"M"+i+", "+.5*s+"A6,6 0 0 "+(r+1)%2+" "+(i+6)+","+6.5*s+"H"+(2*i-6)+"A6,6 0 0 "+(r+1)%2+" "+2*i+","+.5*s+"Z"+"M"+(i+8)+","+2.5*s+"H"+(2*i-8)+"M"+(i+8)+","+4.5*s+"H"+(2*i-8))},i.prototype.brushMoved=t.prototype.debounce(function(){var t=this.data().filter(function(e){var t=e[0];return this.xAxisType()==="ordinal"&&(t=this.domainAxis.d3Scale(t)+(this.domainAxis.d3Scale.rangeBand?this.domainAxis.d3Scale.rangeBand()/2:0)),this.orientation()==="horizontal"?t>=this.xBrush.extent()[0]&&t<=this.xBrush.extent()[1]:t>=this.yBrush.extent()[0]&&t<=this.yBrush.extent()[1]},this);this.selection(t)},250),i.prototype.dataPos=function(e){return this.domainAxis.scalePos(e)},i.prototype.valuePos=function(e){return this.valueAxis.scalePos(e)},i.prototype.setScaleRange=function(e,t){this.xAxis.width(e),this.yAxis.height(t)},i.prototype.calcMargin=function(e,t,n){var r={top:!n&&this.selectionMode()?10:2,right:n&&(this.selectionMode()||this.xAxisFocus())?10:2,bottom:(this.xAxisFocus()?this.xAxisFocusHeight():0)+2,left:2},i=this.width()-r.left-r.right,s=this.height()-r.top-r.bottom,o=30,u=30;for(var a=0;a<10;++a){this.xAxis.width(i-u).height(0);var f=this.xAxis.calcOverflow(t);this.yAxis.width(0).height(s-o);var l=this.yAxis.calcOverflow(t),c=f.depth,h=l.depth;if(c===o&&h===u){o=c,u=h;break}o=c,u=h}return this.xAxis.x(i/2+u/2+r.left).y(s+r.top).width(i-u),this.yAxis.x(r.left).y(s/2-o/2+r.top).height(s-o),r.left+=u,r.bottom+=o,r},i.prototype.updateRegions=function(t,n,r){var i=this,s=this.svgRegions.selectAll(".region").data(this.regions());s.enter().append("rect").attr("class","region"),r?s.attr("x",function(e){return i.dataPos(e.x0)}).attr("y",0).attr("width",function(e){return i.dataPos(e.x1)-i.dataPos(e.x0)}).attr("height",this.height()).style("stroke",function(e){return i._palette(e.colorID)}).style("fill",function(t){return e.hsl(i._palette(t.colorID)).brighter()}):s.attr("x",0).attr("y",function(e){return i.dataPos(e.x0)}).attr("width",this.width()).attr("height",function(e){return i.dataPos(e.x0)-i.dataPos(e.x1)}).style("stroke",function(e){return i._palette(e.colorID)}).style("fill",function(t){return e.hsl(i._palette(t.colorID)).brighter()}),s.exit().remove()},i.prototype.update=function(t,n){var r=this,i=this.orientation()==="horizontal";this.updateRegions(t,n,i),this.domainAxis.orientation(i?"bottom":"left").title(this.columns()[0]),this.valueAxis.orientation(i?"left":"bottom"),this.xAxis=i?this.domainAxis:this.valueAxis,this.yAxis=i?this.valueAxis:this.domainAxis;var s=i?this.xBrush:this.yBrush,o=i?this.yBrush:this.xBrush,u=o.extent();switch(this.xAxisType()){case"ordinal":this.domainAxis.ordinals(this.data().map(function(e){return e[0]}));break;default:var a=this.xAxisDomainLow()?this.xAxisDomainLow():this.domainAxis.parseInvert(e.min(this.parsedData(),function(e){return e[0]})),f=this.xAxisDomainHigh()?this.xAxisDomainHigh():this.domainAxis.parseInvert(e.max(this.parsedData(),function(e){return e[0]}));a!==undefined&&f!==undefined&&this.domainAxis.low(a).high(f)}var l=this.yAxisDomainLow()?this.yAxisDomainLow():this.valueAxis.parseInvert(e.min(this.parsedData(),function(t){return e.min(t.filter(function(e,t){return t>0&&r.columns()[t]&&r.columns()[t].indexOf("__")!==0&&e!==null}),function(e){return e instanceof Array?e[0]:e})})),c=this.yAxisDomainHigh()?this.yAxisDomainHigh():this.valueAxis.parseInvert(e.max(this.parsedData(),function(t){return e.max(t.filter(function(e,t){return t>0&&r.columns()[t]&&r.columns()[t].indexOf("__")!==0&&e!==null}),function(e){return e instanceof Array?e[1]:e})}));this.valueAxis.low(l).high(c),this.margin=this.calcMargin(t,n,i);var h=this.width()-this.margin.left-this.margin.right;h<0&&(h=0);var p=this.height()-this.margin.top-this.margin.bottom;p<0&&(p=0);var d=i?h:p,v=i?p:h;this.domainAxis.tickLength(this.xAxisGuideLines()?v:0).render(),this.valueAxis.tickLength(this.yAxisGuideLines()?d:0).render(),this.svgDataClipRect.attr("width",h).attr("height",p),this.svgData.transition().attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.xBrush.x(this.domainAxis.d3Scale),this.yBrush.y(this.domainAxis.d3Scale);if(this.selectionMode()){this._prevXAxisType!==this.xAxisType()&&(this._prevXAxisType=this.xAxisType(),this._prevBrush=null);if(!this._prevBrush)switch(this.xAxisType()){case"ordinal":s.extent([0,d]);break;default:s.extent(this.domainAxis.d3Scale.domain())}else if(this._prevBrush&&this._prevBrush.orientation!==this.orientation())switch(this.xAxisType()){case"ordinal":s.extent([d-u[0]*d/this._prevBrush.maxCurrExtent,d-u[1]*d/this._prevBrush.maxCurrExtent]);break;default:s.extent(u)}this._prevBrush={orientation:this.orientation(),maxCurrExtent:d}}this.svgBrush.attr("transform","translate("+this.margin.left+", "+this.margin.top+")").style("display",this.selectionMode()?null:"none").call(s).selectAll(".background").transition().attr("width",h).attr("height",p),this.svgBrush.selectAll(".extent, .resize rect").transition().attr(i?"y":"x",0).attr(i?"height":"width",v);var m=this.svgBrush.selectAll(".resize").selectAll("path").data(function(e){return e});m.enter().append("path"),m.transition().attr("d",function(e){return r.resizeBrushHandle(e,h,p)}),this.updateFocusChart(t,n,this.margin,h,p,i),this.updateChart(t,n,this.margin,h,p,i,250)},i.prototype.updateFocusChart=function(e,t,n,r,i,s){function a(){if(o.focusChart.xAxisType()!=="ordinal")o.xAxis.domain(o.focusChart.xBrush.extent());else{var e=o.focusChart.xBrush.extent(),t=e[1]-e[0],n=t/r;o.xAxis.range([-e[0]/n,(r-e[0])/n])}o.xAxis.svgAxis.call(o.xAxis.d3Axis),o.xAxis.svgGuides.call(o.xAxis.d3Guides)}var o=this,u=this.svgFocus.selectAll("#"+this.id()+"_focusChart").data(this.xAxisFocus()?[!0]:[]);u.enter().append("g").attr("id",this.id()+"_focusChart").each(function(u){o.focusChart=(new o.constructor).target(this),o.focusChart.xBrush.on("brush.focus",function(){a(),o.updateChart(e,t,n,r,i,s,0)})}),u.each(function(e){o.copyPropsTo(o.focusChart),o.focusChart.xAxisFocus(!1).selectionMode(!0).tooltipStyle("none").orientation("horizontal").xAxisGuideLines(!1).xAxisDomainLow(null).xAxisDomainHigh(null).yAxisGuideLines(!1).x(o.width()/2).y(o.height()-o.xAxisFocusHeight()/2).width(o.width()).height(o.xAxisFocusHeight()).columns(o.columns()).data(o.data()).render(),a()}),u.exit().each(function(e){o.focusChart&&(o.focusChart.target(null),delete o.focusChart)}).remove()},i.prototype.updateChart=function(e,t,n,r,i,s,o){},i.prototype.exit=function(e,n){t.prototype.exit.apply(this,arguments)},i.prototype.selection=function(e){},i}),function(e,t){typeof define=="function"&&define.amd?define("chart/Scatter.js",["d3","../common/SVGWidget","./XYAxis","../api/INDChart","../api/ITooltip","css!./Scatter"],t):e.chart_Scatter=t(e.d3,e.common_SVGWidget,e.chart_XYAxis,e.api_INDChart,e.api_ITooltip)}(this,function(e,t,n,r,i){function s(e){n.call(this),r.call(this),i.call(this),this.xAxisGuideLines_default(!0).yAxisGuideLines_default(!0)}return s.prototype=Object.create(n.prototype),s.prototype.constructor=s,s.prototype._class+=" chart_Scatter",s.prototype.implements(r.prototype),s.prototype.implements(i.prototype),s.prototype.publish("paletteID","default","set","Palette ID",s.prototype._palette.switch(),{tags:["Basic","Shared"]}),s.prototype.publish("pointShape","cross","set","Shape of the data points",["circle","rectangle","cross"]),s.prototype.publish("pointSize",6,"number","Point Size"),s.prototype.publish("interpolate","","set","Interpolate Data",["","linear","step","step-before","step-after","basis","bundle","cardinal","monotone"]),s.prototype.publish("interpolateFill",!1,"boolean","Fill Interpolation"),s.prototype.publish("interpolateFillOpacity",.66,"number","Fill Interpolation Opacity"),s.prototype.publish("useClonedPalette",!1,"boolean","Enable or disable using a cloned palette",null,{tags:["Intermediate","Shared"]}),s.prototype.xPos=function(e){return this.orientation()==="horizontal"?this.dataPos(e.label):this.valuePos(e.value)},s.prototype.yPos=function(e){return this.orientation()==="horizontal"?this.valuePos(e.value):this.dataPos(e.label)},s.prototype.enter=function(e,t){n.prototype.enter.apply(this,arguments);var r=this;this.tooltipHTML(function(e){return r.tooltipFormat({label:e.label,series:r.columns()[e.colIdx],value:e.value})})},s.prototype.updateChart=function(t,n,r,i,s,o){function a(e){switch(e){case"rectangle":return"rect";case"circle":return"circle";case"cross":return"path"}}var u=this;this._palette=this._palette.switch(this.paletteID()),this.useClonedPalette()&&(this._palette=this._palette.cloneNotExists(this.paletteID()+"_"+this.id())),this._prevPointShape!==this.pointShape()&&(this.svgData.selectAll(".data").remove(),this._prevPointShape=this.pointShape());var f=this.flattenData().map(function(e){return e.shape=a(u.pointShape()),e}),l=this.svgData.selectAll(".point").data(f,function(e,t){return e.shape+"_"+t});l.enter().append("g").attr("class","point").each(function(t){var n=e.select(this);n.append("circle").attr("class","pointSelection").on("mouseout.tooltip",u.tooltip.hide).on("mousemove.tooltip",u.tooltip.show).call(u._selection.enter.bind(u._selection)).on("click",function(e,t){u.click(u.rowToObj(u.data()[e.rowIdx]),u.columns()[e.colIdx],u._selection.selected(this))}),n.append(t.shape).attr("class","pointShape")}),l.each(function(t){var n=e.select(this).select(".pointSelection");n.attr("cx",function(e){return u.xPos(e)}).attr("cy",function(e){return u.yPos(e)}).attr("r",u.pointSize());var r=e.select(this).select(".pointShape");switch(t.shape){case"rect":r.attr("x",function(e){return u.xPos(e)-u.pointSize()/2}).attr("y",function(e){return u.yPos(e)-u.pointSize()/2}).attr("width",u.pointSize()).attr("height",u.pointSize()).style("fill",function(e,t){return u._palette(u.columns()[e.colIdx])});break;case"circle":r.attr("cx",function(e){return u.xPos(e)}).attr("cy",function(e){return u.yPos(e)}).attr("r",u.pointSize()/2).style("fill",function(e,t){return u._palette(u.columns()[e.colIdx])});break;case"path":r.attr("d",function(e){return"M"+(u.xPos(e)-u.pointSize()/2)+" "+(u.yPos(e)-u.pointSize()/2)+" "+"L"+(u.xPos(e)+u.pointSize()/2)+" "+(u.yPos(e)+u.pointSize()/2)+" "+"M"+(u.xPos(e)-u.pointSize()/2)+" "+(u.yPos(e)+u.pointSize()/2)+" "+"L"+(u.xPos(e)+u.pointSize()/2)+" "+(u.yPos(e)-u.pointSize()/2)}).style("stroke",function(e,t){return u._palette(u.columns()[e.colIdx])})}}),l.exit().remove();var c=this.svgData.selectAll(".area").data(this.columns().filter(function(e,t){return u.interpolate()&&u.interpolateFill()&&t>0}));c.enter().append("path").attr("class","area");var h=e.svg.area().interpolate(this.interpolate());o?h.x(function(e){return u.xPos(e)}).y0(function(e){return s}).y1(function(e){return u.yPos(e)}):h.y(function(e){return u.yPos(e)}).x0(function(e){return 0}).x1(function(e){return u.xPos(e)}),c.each(function(t,n){var r=e.select(this);r.attr("d",h(f.filter(function(e){return e.colIdx===n+1}))).style("opacity",u.interpolateFillOpacity()).style("stroke","none").style("fill",function(t,r){return e.hsl(u._palette(u.columns()[n+1])).brighter()})}),c.exit().remove();var p=this.svgData.selectAll(".line").data(this.columns().filter(function(e,t){return u.interpolate()&&t>0}));p.enter().append("path").attr("class","line");var d=e.svg.line().x(function(e){return u.xPos(e)}).y(function(e){return u.yPos(e)}).interpolate(this.interpolate());p.each(function(t,n){var r=e.select(this),i=f.filter(function(e){return e.colIdx===n+1});r.attr("d",d(i)).style("stroke",function(e,t){return u._palette(u.columns()[n+1])}).style("fill","none")}),p.exit().remove()},s.prototype.exit=function(e,n){t.prototype.exit.apply(this,arguments)},s}),function(e,t){typeof define=="function"&&define.amd?define("chart/Area.js",["d3","./Scatter"],t):e.chart_Area=t(e.d3,e.chart_Scatter)}(this,function(e,t){function n(e){t.call(this),this.interpolate_default("linear").interpolateFill_default(!0)}return n.prototype=Object.create(t.prototype),n.prototype.constructor=n,n.prototype._class+=" chart_Area",n}),function(e,t){typeof define=="function"&&define.amd?define("chart/Column.js",["d3","./XYAxis","../api/INDChart","../api/ITooltip","css!./Column"],t):e.chart_Column=t(e.d3,e.chart_XYAxis,e.api_INDChart,e.api_ITooltip)}(this,function(e,t,n,r){function i(e){t.call(this),n.call(this),r.call(this),this._linearGap=25}return i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.prototype._class+=" chart_Column",i.prototype.implements(n.prototype),i.prototype.implements(r.prototype),i.prototype.publish("paletteID","default","set","Palette ID",i.prototype._palette.switch(),{tags:["Basic","Shared"]}),i.prototype.publish("stacked",!1,"boolean","Stacked Bars",null,{tags:["Basic"]}),i.prototype.publish("stackedOpacity",.66,"number","Fill Stacked Opacity",null,{tags:["Basic"]}),i.prototype.publish("useClonedPalette",!1,"boolean","Enable or disable using a cloned palette",null,{tags:["Intermediate","Shared"]}),i.prototype.enter=function(e,n){t.prototype.enter.apply(this,arguments);var r=this;this.tooltipHTML(function(e){return r.tooltipFormat({label:e.row[0],series:r.columns()[e.idx],value:e.row[e.idx]})})},i.prototype.updateChart=function(t,n,r,i,s,o,u){var a=this;this._palette=this._palette.switch(this.paletteID()),this.useClonedPalette()&&(this._palette=this._palette.cloneNotExists(this.paletteID()+"_"+this.id()));var f=10,l=0;switch(this.xAxisType()){case"ordinal":f=this.domainAxis.d3Scale.rangeBand(),l=-f/2;break;case"linear":case"time":f=Math.max(Math.abs(this.dataPos(2)-this.dataPos(1))*(100-this._linearGap)/100,f),l=-f/2}var c=e.scale.ordinal().domain(a.columns().filter(function(e,t){return t>0})).rangeRoundBands(o?[0,f]:[f,0]),h=this.svgData.selectAll(".dataRow").data(this.data());h.enter().append("g").attr("class","dataRow"),this.tooltip.direction(o?"n":"e"),h.each(function(t,n){var r=e.select(this),i=r.selectAll("rect").data(t.filter(function(e,t){return t<a.columns().length}).map(function(e,n){return{column:a.columns()[n],row:t,value:e,idx:n}}).filter(function(e,t){return e.value!==null&&e.idx>0}));i.enter().append("rect").attr("class","columnRect").call(a._selection.enter.bind(a._selection)).on("mouseout.tooltip",a.tooltip.hide).on("mousemove.tooltip",a.tooltip.show).on("click",function(e,t){a.click(a.rowToObj(e.row),e.column,a._selection.selected(this))}),o?i.transition().duration(u).attr("x",function(e){return a.dataPos(t[0])+(a.stacked()?0:c(e.column))+l}).attr("width",a.stacked()?f:c.rangeBand()).attr("y",function(e){return e.value instanceof Array?a.valuePos(e.value[1]):a.valuePos(e.value)}).attr("height",function(e){return e.value instanceof Array?a.valuePos(e.value[0])-a.valuePos(e.value[1]):s-a.valuePos(e.value)}).style("opacity",a.stacked()?a.stackedOpacity():1).style("fill",function(e){return a._palette(e.column)}):i.transition().duration(u).attr("y",function(e){return a.dataPos(t[0])+(a.stacked()?0:c(e.column))+l}).attr("height",a.stacked()?f:c.rangeBand()).attr("x",function(e){return e.value instanceof Array?a.valuePos(e.value[0]):0}).attr("width",function(e){return e.value instanceof Array?a.valuePos(e.value[1])-a.valuePos(e.value[0]):a.valuePos(e.value)}).style("opacity",a.stacked()?a.stackedOpacity():1).style("fill",function(e){return a._palette(e.column)}),a.stacked()&&i.sort(function(e,t){return t-e}),i.exit().transition().duration(u).remove()}),h.exit().transition().duration(u).remove()},i}),function(e,t){typeof define=="function"&&define.amd?define("chart/Bar",["./Column"],t):e.chart_Bar=t(e.chart_Column)}(this,function(e){function t(t){e.call(this),this.orientation_default("vertical")}return t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.prototype._class+=" chart_Bar",t}),function(e,t){typeof define=="function"&&define.amd?define("chart/Bubble.js",["d3","../common/SVGWidget","../api/I2DChart","../common/Text","../common/FAChar","../common/Utility","../api/ITooltip","css!./Bubble"],t):e.chart_Bubble=t(e.d3,e.common_SVGWidget,e.api_I2DChart,e.common_Text,e.common_FAChar,e.common_Utility,e.api_ITooltip)}(this,function(e,t,n,r,i,s,o){function u(r){t.call(this),n.call(this),o.call(this),s.SimpleSelectionMixin.call(this),this._drawStartPos="origin",this.labelWidgets={},this.d3Pack=e.layout.pack().sort(function(e,t){return e<t?-1:e>t?1:0}).size([this.width(),this.height()]).value(function(e){return e[1]})}return u.prototype=Object.create(t.prototype),u.prototype.constructor=u,u.prototype._class+=" chart_Bubble",u.prototype.implements(n.prototype),u.prototype.implements(o.prototype),u.prototype.mixin(s.SimpleSelectionMixin),u.prototype.publish("paletteID","default","set","Palette ID",u.prototype._palette.switch(),{tags:["Basic","Shared"]}),u.prototype.publish("useClonedPalette",!1,"boolean","Enable or disable using a cloned palette",null,{tags:["Intermediate","Shared"]}),u.prototype.size=function(e){var n=t.prototype.size.apply(this,arguments);return arguments.length&&this.d3Pack.size([this.width(),this.height()]),n},u.prototype.enter=function(e,n){t.prototype.enter.apply(this,arguments),this._selection.widgetElement(n);var r=this;this.tooltipHTML(function(e){return r.tooltipFormat({label:e[0],value:e[1]})})},u.prototype.update=function(t,n){var s=this;this._palette=this._palette.switch(this.paletteID()),this.useClonedPalette()&&(this._palette=this._palette.cloneNotExists(this.paletteID()+"_"+this.id()));var o=n.selectAll(".node").data(this.data().length?this.d3Pack.nodes({children:this.cloneData()}).filter(function(e){return!e.children}):[],function(e){return e[0]});o.enter().append("g").attr("class","node").attr("opacity",0).call(this._selection.enter.bind(this._selection)).on("click",function(e){s.click(s.rowToObj(e),s.columns()[1],s._selection.selected(this))}).each(function(t){var n=e.select(this);n.append("circle").attr("r",function(e){return e.r}).on("mouseout.tooltip",s.tooltip.hide).on("mousemove.tooltip",s.tooltip.show),t.__viz_faChar?s.labelWidgets[t[0]]=(new i).char(t.__viz_faChar).target(this).render():s.labelWidgets[t[0]]=(new r).text(t[0]).target(this).render()}),o.transition().attr("opacity",1).each(function(t){var n=e.select(this),r={x:t.x,y:t.y};n.select("circle").transition().attr("transform",function(e){return"translate("+r.x+","+r.y+")"}).style("fill",function(e){return s._palette(e[0])}).attr("r",function(e){return e.r}).select("title").text(function(e){return e[0]+" ("+e[1]+")"});if(t.__viz_faChar)s.labelWidgets[t[0]].pos(r).render();else{var i=t[0],o=s.labelWidgets[t[0]].getBBox().width;t.r*2<16?i="":t.r*2<o&&(i=i[0]+"..."),s.labelWidgets[t[0]].pos(r).text(i).render()}}),o.exit().transition().style("opacity",0).remove()},u.prototype.exit=function(e,n){t.prototype.enter.apply(this,arguments)},u}),function(e,t){typeof define=="function"&&define.amd?define("chart/Bullet.js",["d3","../common/HTMLWidget","../common/Utility","d3-bullet","css!./Bullet"],t):e.chart_Bullet=t(e.d3,e.common_HTMLWidget,e.common_Utility,e.d3.bullet)}(this,function(e,t,n,r){function i(e){t.call(this),n.SimpleSelectionMixin.call(this,!0)}return r=r||e.bullet||window.d3.bullet,i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.prototype._class+=" chart_Bullet",i.prototype.publish("titleColumn",null,"set","Title Column",function(){return this.columns()},{optional:!0}),i.prototype.publish("subtitleColumn",null,"set","Subtitle Column",function(){return this.columns()},{optional:!0}),i.prototype.publish("rangesColumn",null,"set","Ranges Column",function(){return this.columns()},{optional:!0}),i.prototype.publish("measuresColumn",null,"set","Measures Column",function(){return this.columns()},{optional:!0}),i.prototype.publish("markersColumn",null,"set","Markers Column",function(){return this.columns()},{optional:!0}),i.prototype.bulletData=function(){function t(t,n){var r=e.indexOf(n);return r>=0?t[r]instanceof Array?t[r]:[t[r]]:[]}var e=this.columns();return this.data().map(function(e){return{title:t(e,this.titleColumn()),subtitle:t(e,this.subtitleColumn()),ranges:t(e,this.rangesColumn()),measures:t(e,this.measuresColumn()),markers:t(e,this.markersColumn()),origRow:e}},this)},i.prototype.enter=function(n,r){t.prototype.enter.apply(this,arguments),e.select(n.parentNode).style("overflow","auto"),this._selection.widgetElement(r)},i.prototype.update=function(n,i){t.prototype.update.apply(this,arguments);var s=this,o={top:8,right:16,bottom:20,left:16},u=this.width()-o.left-o.right,a=50-o.top-o.bottom,f=i.selectAll("svg").data(this.bulletData());f.enter().append("svg").attr("class","bullet").call(this._selection.enter.bind(this._selection)).on("click",function(e){s.click(s.rowToObj(e.origRow),s.titleColumn(),s._selection.selected(this))}).each(function(t){var n=e.select(this),r=n.append("g").attr("class","bulletBar"),i=r.append("g").attr("class","bulletTitle");i.append("text").attr("class","title"),i.append("text").attr("class","subtitle").attr("dy","1em")});var l=f.select(".bulletTitle").style("text-anchor","end").attr("transform","translate(-6,"+a/2+")");l.select(".title").text(function(e){return e.title}),l.select(".subtitle").text(function(e){return e.subtitle});var c=0;l.each(function(){var e=this.getBBox();e.width>c&&(c=e.width)});var h=(new r).width(u-c).height(a);f.attr("width",u).attr("height",a+o.top+o.bottom),f.select(".bulletBar").attr("transform","translate("+(c+o.left)+","+o.top+")").call(h),f.exit().remove()},i.prototype.exit=function(e,n){t.prototype.exit.apply(this,arguments)},i.prototype.click=function(e,t,n){console.log("Click:  "+JSON.stringify(e)+", "+t+","+n)},i}),function(e,t){typeof define=="function"&&define.amd?define("chart/Gantt.js",["./Bar"],t):e.chart_Gantt=t(e.chart_Bar)}(this,function(e){function t(t){e.call(this),this.orientation_default("vertical").xAxisType_default("ordinal").yAxisType_default("time")}return t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.prototype._class+=" chart_Gantt",t}),function(e,t){typeof define=="function"&&define.amd?define("chart/HexBin.js",["d3","../common/SVGWidget","./XYAxis","../api/INDChart","../api/ITooltip","../common/Palette","d3-hexbin","css!./HexBin"],t):e.chart_HexBin=t(e.d3,e.common_SVGWidget,e.chart_XYAxis,e.api_INDChart,e.api_ITooltip,e.common_Palette)}(this,function(e,t,n,r,i,s,o){function u(e){n.call(this),r.call(this),i.call(this),this._hexbin=new o,this.xAxisGuideLines_default(!1).yAxisGuideLines_default(!1)}return o=o||e.hexbin||window.d3.hexbin,u.prototype=Object.create(n.prototype),u.prototype.constructor=u,u.prototype._class+=" chart_HexBin",u.prototype.implements(r.prototype),u.prototype.implements(i.prototype),u.prototype._palette=s.rainbow("default"),u.prototype.publish("paletteID","Blues","set","Palette ID",u.prototype._palette.switch(),{tags:["Basic","Shared"]}),u.prototype.publish("useClonedPalette",!1,"boolean","Enable or disable using a cloned palette",null,{tags:["Intermediate","Shared"]}),u.prototype.publish("binSize",20,"number","Bin radius"),u.prototype.xPos=function(e){return this.orientation()==="horizontal"?this.dataPos(e.label):this.valuePos(e.value)},u.prototype.yPos=function(e){return this.orientation()==="horizontal"?this.valuePos(e.value):this.dataPos(e.label)},u.prototype.updateChart=function(t,n,r,i,s,o,u){var a=this;this._palette=this._palette.switch(this.paletteID()),this.useClonedPalette()&&(this._palette=this._palette.cloneNotExists(this.paletteID()+"_"+this.id())),this._hexbin.size([i,s]).radius(this.binSize());var f=this.flattenData(),l=f.map(function(e,t){return[a.xPos(e),a.yPos(e)]}),c=this._hexbin(l),h=e.max(c,function(e){return e.length}),p=this.svgData.selectAll(".hexagon").data(c,function(e,t){return e.i+"_"+e.j});p.enter().append("path").attr("class","hexagon").attr("transform",function(e){return"translate("+e.x+","+e.y+")scale(0)"}),p.transition().duration(u).attr("d",this._hexbin.hexagon()).attr("transform",function(e){return"translate("+e.x+","+e.y+")scale(1)"}).style("fill",function(e){return a._palette(e.length,0,h)}),p.exit().transition().duration(u).attr("transform",function(e){return"translate("+e.x+","+e.y+")scale(0)"}).remove()},u.prototype.exit=function(e,n){t.prototype.exit.apply(this,arguments)},u}),function(e,t){typeof define=="function"&&define.amd?define("chart/Line.js",["d3","./Scatter","css!./Line"],t):e.chart_Line=t(e.d3,e.chart_Scatter)}(this,function(e,t){function n(e){t.call(this),this.interpolate_default("linear")}return n.prototype=Object.create(t.prototype),n.prototype.constructor=n,n.prototype._class+=" chart_Line",n}),function(e,t){typeof define=="function"&&define.amd?define("chart/MultiChart",["d3","../common/HTMLWidget","../common/Utility","../api/INDChart"],t):e.chart_MultiChart=t(e.d3,e.common_HTMLWidget,e.common_Utility,e.api_INDChart)}(this,function(e,t,n,r){function i(){t.call(this),r.call(this),this._tag="div",this._allCharts={},this._allChartTypes.forEach(function(e){var t=JSON.parse(JSON.stringify(e));t.widget=null,this._allCharts[e.id]=t,this._allCharts[e.display]=t,this._allCharts[e.widgetClass]=t},this),this._chartTypeDefaults={},this._chartTypeProperties={}}return i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.prototype._class+=" chart_MultiChart",i.prototype.implements(r.prototype),i.prototype._1DChartTypes=[{id:"C3_GAUGE",display:"Gauge (C3)",widgetClass:"c3chart_Gauge"}].map(function(e){return e.family="1D",e}),i.prototype._2DChartTypes=[{id:"SUMMARY",display:"Summary",widgetClass:"chart_Summary"},{id:"BUBBLE",display:"Bubble",widgetClass:"chart_Bubble"},{id:"PIE",display:"Pie",widgetClass:"chart_Pie"},{id:"GOOGLE_PIE",display:"Pie (Google)",widgetClass:"google_Pie"},{id:"C3_DONUT",display:"Donut (C3)",widgetClass:"c3chart_Donut"},{id:"C3_PIE",display:"Pie (C3)",widgetClass:"c3chart_Pie"},{id:"AM_FUNNEL",display:"Area (amCharts)",widgetClass:"amchart_Funnel"},{id:"AM_PIE",display:"Pie (amCharts)",widgetClass:"amchart_Pie"},{id:"AM_PYRAMID",display:"Area (amCharts)",widgetClass:"amchart_Pyramid"},{id:"WORD_CLOUD",display:"Word Cloud",widgetClass:"other_WordCloud"}].map(function(e){return e.family="2D",e}),i.prototype._NDChartTypes=[{id:"COLUMN",display:"Column",widgetClass:"chart_Column"},{id:"BAR",display:"Bar",widgetClass:"chart_Bar"},{id:"LINE",display:"Line",widgetClass:"chart_Line"},{id:"AREA",display:"Area",widgetClass:"chart_Area"},{id:"STEP",display:"Step",widgetClass:"chart_Step"},{id:"SCATTER",display:"Scatter",widgetClass:"chart_Scatter"},{id:"HEXBIN",display:"Hex Bin",widgetClass:"chart_HexBin"},{id:"GOOGLE_BAR",display:"Bar (Google)",widgetClass:"google_Bar"},{id:"GOOGLE_COLUMN",display:"Column (Google)",widgetClass:"google_Column"},{id:"GOOGLE_LINE",display:"Line (Google)",widgetClass:"google_Line"},{id:"GOOGLE_SCATTER",display:"Scatter (Google)",widgetClass:"google_Scatter"},{id:"GOOGLE_COMBO",display:"Combo (Google)",widgetClass:"google_Combo"},{id:"C3_AREA",display:"Area (C3)",widgetClass:"c3chart_Area"},{id:"C3_BAR",display:"Bar (C3)",widgetClass:"c3chart_Bar"},{id:"C3_COLUMN",display:"Column (C3)",widgetClass:"c3chart_Column"},{id:"C3_LINE",display:"Line (C3)",widgetClass:"c3chart_Line"},{id:"C3_SCATTER",display:"Scatter (C3)",widgetClass:"c3chart_Scatter"},{id:"C3_STEP",display:"Step (C3)",widgetClass:"c3chart_Step"},{id:"C3_COMBO",display:"Combo (C3)",widgetClass:"c3chart_Combo"},{id:"AM_AREA",display:"Area (amCharts)",widgetClass:"amchart_Area"},{id:"AM_BAR",display:"Bar (amCharts)",widgetClass:"amchart_Bar"},{id:"AM_LINE",display:"Line (amCharts)",widgetClass:"amchart_Line"},{id:"AM_SCATTER",display:"Scatter (amCharts)",widgetClass:"amchart_Scatter"},{id:"AM_COLUMN",display:"Column (amCharts)",widgetClass:"amchart_Column"},{id:"AM_GANTT",display:"Gantt (amCharts)",widgetClass:"amchart_Gantt"},{id:"AM_COMBO",display:"Combo (amCharts)",widgetClass:"amchart_Combo"}].map(function(e){return e.family="ND",e}),i.prototype._mapChartTypes=[{id:"CHORO_USSTATES",display:"US State Choropleth",widgetClass:"map_ChoroplethStates"},{id:"CHORO_USCOUNTIES",display:"US County Choropleth",widgetClass:"map_ChoroplethCounties"},{id:"CHORO_COUNTRIES",display:"Counrty Choropleth",widgetClass:"map_ChoroplethCountries"}].map(function(e){return e.family="map",e}),i.prototype._anyChartTypes=[{id:"TABLE",display:"Table",widgetClass:"other_Table"},{id:"TABLE_NESTED",display:"Nested Table",widgetClass:"other_NestedTable"},{id:"TABLE_CALENDAR",display:"Table driven Calendar Heat Map",widgetClass:"other_CalendarHeatMap"},{id:"TABLE_BULLET",display:"Table driven bullet chart",widgetClass:"chart_Bullet"},{id:"TABLE_SELECT",display:"Table driven select",widgetClass:"other_Select"},{id:"TABLE_TREE",display:"Table driven tree",widgetClass:"tree_Dendrogram"},{id:"TABLE_TREEMAP",display:"Table driven Treemap",widgetClass:"tree_Treemap"},{id:"TABLE_SANKEY",display:"Table driven Sankey",widgetClass:"graph_Sankey"},{id:"TABLE_GMAP_PIN",display:"Table driven Google Map (pins)",widgetClass:"map_GMapPin"},{id:"TABLE_GMAP_PINLINE",display:"Table driven Google Map (pins/lines)",widgetClass:"map_GMapPinLine"}].map(function(e){return e.family="any",e}),i.prototype._allChartTypes=i.prototype._1DChartTypes.concat(i.prototype._2DChartTypes.concat(i.prototype._NDChartTypes.concat(i.prototype._mapChartTypes.concat(i.prototype._anyChartTypes)))),i.prototype._allMap=e.map(i.prototype._allChartTypes,function(e){return e.family}),i.prototype._allFamilies=i.prototype._allMap.keys(),i.prototype.publishReset(),i.prototype.publish("chartType","BUBBLE","set","Chart Type",i.prototype._allChartTypes.map(function(e){return e.id}),{tags:["Basic"]}),i.prototype.publish("chart",null,"widget","Chart",null,{tags:["Basic"]}),i.prototype.fields=function(e){var n=t.prototype.fields.apply(this,arguments);if(this.chart()){if(!arguments.length)return this.chart().fields();this.chart().fields(e)}return n},i.prototype.columns=function(e){var n=t.prototype.columns.apply(this,arguments);if(this.chart()){if(!arguments.length)return this.chart().columns();this.chart().columns(e)}return n},i.prototype.data=function(e){var n=t.prototype.data.apply(this,arguments);if(this.chart()){if(!arguments.length)return this.chart().data();this.chart().data(e)}return n},i.prototype._origChart=i.prototype.chart,i.prototype.chart=function(e){var t=i.prototype._origChart.apply(this,arguments);if(arguments.length){var n=this;e.click=function(e,t,r){n.click(e,t,r)},this._chartMonitor&&(this._chartMonitor.remove(),delete this._chartMonitor),this._chartMonitor=e.monitor(function(t,r,i){n.broadcast(t,r,i,e)})}return t},i.prototype.hasOverlay=function(){return this.chart()&&this.chart().hasOverlay()},i.prototype.visible=function(e){return arguments.length?(this.chart()&&this.chart().visible(e),this):this.chart()&&this.chart().visible()},i.prototype.chartTypeDefaults=function(e){return arguments.length?(this._chartTypeDefaults=e,this):this._chartTypeDefaults},i.prototype.chartTypeProperties=function(e){return arguments.length?(this._chartTypeProperties=e,this):this._chartTypeProperties},i.prototype.getChartDataFamily=function(){return this._allCharts[this.chartType()].family},i.prototype.requireContent=function(e,t){n.requireWidget(this._allCharts[e].widgetClass).then(function(e){t(new e)})},i.prototype.switchChart=function(e){if(this._switchingTo===this.chartType()){e&&e(this);return}this._switchingTo&&console.log("Attempting switch to:  "+this.chartType()+", before previous switch is complete ("+this._switchingTo+")"),this._switchingTo=this.chartType();var t=this.chart(),n=this;this.requireContent(this.chartType(),function(r){if(r!==t){var i=n.size();r.fields(n.fields()).data(n.data()).size(i),n.chart(r),t&&t.data([]).size({width:1,height:1}).render()}delete n._switchingTo,e&&e(this)})},i.prototype.update=function(e,n){t.prototype.update.apply(this,arguments);var r=n.selectAll(".multiChart").data(this.chart()?[this.chart()]:[],function(e){return e._id});r.enter().append("div").attr("class","multiChart").each(function(e){e.target(this)});var i=this.chart();if(i){for(var s in this._chartTypeDefaults)if(i[s+"_default"])try{i[s+"_default"](this._chartTypeDefaults[s])}catch(o){console.log("Exception Setting Default:  "+s)}else console.log("Unknown Default:  "+s);this._chartTypeDefaults={};for(var u in this._chartTypeProperties)if(i[u])try{i[u](this._chartTypeProperties[u])}catch(o){console.log("Exception Setting Property:  "+u)}else console.log("Unknown Property:  "+u);this._chartTypeProperties={}}var a=this;r.each(function(e){e.resize(a.size())}),r.exit().transition().each(function(e){e.target(null)}).remove()},i.prototype.exit=function(e,n){this._chartMonitor&&(this._chartMonitor.remove(),delete this._chartMonitor),this.chart()&&this.chart().target(null),t.prototype.exit.apply(this,arguments)},i.prototype.render=function(e){if(this.chartType()&&(!this.chart()||this.chart().classID()!==this._allCharts[this.chartType()].widgetClass)){var n=this,r=arguments;return this.switchChart(function(){t.prototype.render.apply(n,r)}),this}return t.prototype.render.apply(this,arguments)},i}),function(e,t){typeof define=="function"&&define.amd?define("chart/MultiChartSurface.js",["d3","../common/ResizeSurface","./MultiChart","../api/INDChart"],t):e.chart_MultiChartSurface=t(e.d3,e.common_ResizeSurface,e.chart_MultiChart,e.api_INDChart)}(this,function(e,t,n,r){function i(){t.call(this),r.call(this),this._title="MultiChartSurface",this._content=new n;var e=this;this._content.click=function(t,n){e.click(t,n)},this._menu.click=function(t){e._content.chartType(t).render()},this.content(this._content),this.mode("all")}return i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.prototype._class+=" chart_MultiChartSurface",i.prototype.implements(r.prototype),i.prototype.publish("mode","2D","set","Chart Type",["1D","2D","ND","all"]),i.prototype.publishProxy("chartType","_content"),i.prototype.columns=function(e){return arguments.length?(this.content().columns(e),this):this.content().columns()},i.prototype.data=function(e){return arguments.length?(this.content().data(e),this):this.content().data()},i.prototype._origMode=i.prototype.mode,i.prototype.mode=function(e){var t=i.prototype._origMode.apply(this,arguments);if(arguments.length){this._mode=e;switch(this._mode){case"1d":case"1D":this.menu(this.content()._1DChartTypes.map(function(e){return e.display}).sort());break;case"2d":case"2D":this.menu(this.content()._2DChartTypes.concat(this.content()._NDChartTypes.concat(this.content()._anyChartTypes)).map(function(e){return e.display}).sort());break;case"multi":case"ND":this.menu(this.content()._NDChartTypes.concat(this.content()._anyChartTypes).map(function(e){return e.display}).sort());break;case"all":default:this.menu(this.content()._allChartTypes.map(function(e){return e.display}).sort())}}return t},i}),function(e,t){typeof define=="function"&&define.amd?define("chart/Pie.js",["d3","../common/SVGWidget","../api/I2DChart","../common/Text","../common/FAChar","../common/Utility","../api/ITooltip","css!./Pie"],t):e.chart_Pie=t(e.d3,e.common_SVGWidget,e.api_I2DChart,e.common_Text,e.common_FAChar,e.common_Utility,e.api_ITooltip)}(this,function(e,t,n,r,i,s,o){function u(r){t.call(this),n.call(this),o.call(this),s.SimpleSelectionMixin.call(this),this.labelWidgets={},this.d3Pie=e.layout.pie().padAngle(.0025).sort(function(e,t){return e<t?-1:e>t?1:0}).value(function(e){return e[1]}),this.d3Arc=e.svg.arc().padRadius(this.calcRadius()).innerRadius(this.innerRadius()),this.tooltipTick_default(!1).tooltipOffset_default(0)}return u.prototype=Object.create(t.prototype),u.prototype.constructor=u,u.prototype._class+=" chart_Pie",u.prototype.implements(n.prototype),u.prototype.implements(o.prototype),u.prototype.mixin(s.SimpleSelectionMixin),u.prototype.publish("paletteID","default","set","Palette ID",u.prototype._palette.switch(),{tags:["Basic","Shared"]}),u.prototype.publish("useClonedPalette",!1,"boolean","Enable or disable using a cloned palette",null,{tags:["Intermediate","Shared"]}),u.prototype.publish("outerText",!1,"boolean","Sets label position inside or outside chart",null,{tags:["Basic"]}),u.prototype.publish("innerRadius",0,"number","Sets inner pie hole radius as a percentage of the radius of the pie chart",null,{tags:["Basic"]}),u.prototype.pointInArc=function(e,t){var n=this.d3Arc.innerRadius()(t),r=this.d3Arc.outerRadius()(t),i=this.d3Arc.startAngle()(t),s=this.d3Arc.endAngle()(t),o=e.x*e.x+e.y*e.y,u=Math.atan2(e.x,-e.y);return u=u<0?u+Math.PI*2:u,n*n<=o&&o<=r*r&&i<=u&&u<=s},u.prototype.boxInArc=function(e,t,n){var r={x:e.x+t.x,y:e.y+t.y},i={x:r.x+t.width,y:r.y},s={x:r.x,y:r.y+t.height},o={x:r.x+t.width,y:r.y+t.height};return this.pointInArc(r,n)&&this.pointInArc(i,n)&&this.pointInArc(s,n)&&this.pointInArc(o,n)},u.prototype.calcRadius=function(e){return Math.min(this._size.width,this._size.height)/2-2},u.prototype.intersection=function(e,t){return this.intersectCircle(e,t)},u.prototype.enter=function(e,n){t.prototype.enter.apply(this,arguments),this._selection.widgetElement(n);var r=this;this.tooltipHTML(function(e){return r.tooltipFormat({label:e.data[0],value:e.data[1]})})},u.prototype.update=function(n,s){function f(t,n){return function(){e.select(this).transition().delay(n).attrTween("d",function(n){var r=e.interpolate(n.outerRadius,o.calcRadius()+t);return function(e){return n.outerRadius=r(e),o.d3Arc(n)}})}}t.prototype.update.apply(this,arguments);var o=this;this._palette=this._palette.switch(this.paletteID()),this.useClonedPalette()&&(this._palette=this._palette.cloneNotExists(this.paletteID()+"_"+this.id())),this.d3Arc.innerRadius(this.innerRadius_exists()?this.calcRadius()*this.innerRadius()/100:0);var u=s.selectAll(".arc").data(this.d3Pie(this.data()),function(e){return e.data[0]});u.enter().append("g").attr("class","arc").attr("opacity",0).call(this._selection.enter.bind(this._selection)).on("click",function(e){o.click(o.rowToObj(e.data),o.columns()[1],o._selection.selected(this))}).each(function(t){var n=e.select(this);n.append("path").on("mouseout.tooltip",o.tooltip.hide).on("mousemove.tooltip",o.tooltip.show).on("mouseover",f(0,0)).on("mouseout",f(-5,150)),t.data.__viz_faChar?o.labelWidgets[t.data[0]]=(new i).char(t.data.__viz_faChar).target(this).render():o.labelWidgets[t.data[0]]=(new r).text(t.data[0]).target(this).render()}),u.transition().attr("opacity",1).each(function(t){t.outerRadius=o.calcRadius()-5;var n={x:0,y:1};if(o.outerText()){var r=Math.cos((t.startAngle+t.endAngle-Math.PI)/2),i=Math.sin((t.startAngle+t.endAngle-Math.PI)/2),s=o.labelWidgets[t.data[0]].getBBox(),u=Math.abs(r)>Math.abs(i)?s.width:s.height;n.x=r*(o.calcRadius()+u),n.y=i*(o.calcRadius()+u)}else{var a=o.d3Arc.centroid(t);n={x:a[0],y:a[1]}}var f=e.select(this);f.select("path").transition().attr("d",o.d3Arc).style("fill",function(e){return o._palette(e.data[0])}),o.labelWidgets[t.data[0]].pos(n).render().element().classed("innerLabel",!o.outerText()).classed("outerLabel",o.outerText()).style("opacity",o.outerText()||o.boxInArc(n,o.labelWidgets[t.data[0]].getBBox(),t)?null:0)}),u.exit().transition().style("opacity",0).remove();if(o.outerText()){var a=s.selectAll("line").data(this.d3Pie(this.data()),function(e){return e.data[0]});a.enter().append("line").attr("x1",0).attr("x2",0).attr("y1",-this.calcRadius()-3).attr("y2",-this.calcRadius()-8).attr("stroke","gray").attr("transform",function(e){return"rotate("+(e.startAngle+e.endAngle)/2*(180/Math.PI)+")"}),a.transition().attr("transform",function(e){return"rotate("+(e.startAngle+e.endAngle)/2*(180/Math.PI)+")"}),a.exit().remove()}},u.prototype.exit=function(e,n){t.prototype.exit.apply(this,arguments)},u}),function(e,t){typeof define=="function"&&define.amd?define("chart/Step.js",["d3","./Scatter"],t):e.chart_Step=t(e.d3,e.chart_Scatter)}(this,function(e,t){function n(e){t.call(this),this.interpolate_default("step")}return n.prototype=Object.create(t.prototype),n.prototype.constructor=n,n.prototype._class+=" chart_Step",n}),function(e,t){typeof define=="function"&&define.amd?define("chart/Summary.js",["d3","../common/HTMLWidget","../api/I2DChart","css!font-awesome","css!./Summary"],t):e.chart_Summary=t(e.d3,e.common_HTMLWidget,e.api_I2DChart)}(this,function(e,t,n){function r(){t.call(this),this._tag="div",this._drawStartPos="center",this.playInterval(this.playInterval()),this._playIntervalIdx=0}r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.prototype.implements(n.prototype),r.prototype._class+=" chart_Summary",r.prototype.publish("colorFill","#3498db","html-color","Fill Color",null),r.prototype.publish("colorStroke","#ffffff","html-color","Fill Color",null),r.prototype.publish("valueIcon","fa-briefcase","string","FA Char icon class"),r.prototype.publish("moreText","More Info","string","More text"),r.prototype.publish("moreIcon","fa-info-circle","string","FA Char icon class"),r.prototype.publish("fixedSize",!0,"boolean","Fix Size to Min Width/Height"),r.prototype.publish("minWidth",225,"number","Minimum Width"),r.prototype.publish("minHeight",150,"number","Minimum Height"),r.prototype.publish("playInterval",null,"number","Play Interval",null,{optional:!0});var i=r.prototype.playInterval;return r.prototype.playInterval=function(e){var t=i.apply(this,arguments);if(arguments.length){this._playIntervalHandle&&clearInterval(this._playIntervalHandle);var n=this;e&&(this._playIntervalHandle=setInterval(function(){n._playIntervalIdx++,n._renderCount&&n.data().length&&n.render()},e))}return t},r.prototype.enter=function(e,n){t.prototype.enter.apply(this,arguments),this._mainDiv=n.append("div");var r=this;this._headerDiv=this._mainDiv.append("h2").on("click",function(e){r.click(r.data()[r._playIntervalIdx],r.columns()[1],!0)}),this._textDiv=this._mainDiv.append("div").attr("class","text").on("click",function(e){r.click(r.data()[r._playIntervalIdx],r.columns()[1],!0)})},r.prototype.update=function(n,r){t.prototype.update.apply(this,arguments),this.data().length;var i=this.formattedData();this._playIntervalIdx>=i.length&&(this._playIntervalIdx=0);var s=this._playIntervalIdx<i.length?i[this._playIntervalIdx]:["",""];r.style({width:this.fixedSize()?this.minWidth_exists()?this.minWidth()+"px":null:"100%",height:this.fixedSize()?this.minHeight_exists()?this.minHeight()+"px":null:"100%"}),this._mainDiv.attr("class","content bgIcon "+this.valueIcon()).style({"background-color":this.colorFill(),color:this.colorStroke(),"min-width":this.minWidth_exists()?this.minWidth()+"px":null,"min-height":this.minHeight_exists()?this.minHeight()+"px":null}),this._headerDiv.style("color",this.colorStroke()).text(s[1]),this._textDiv.text(s[0]);var o=this,u=this._mainDiv.selectAll(".more").data(this.moreText()?[this.moreText()]:[]);u.enter().append("div").attr("class","more").on("click",function(e){var t={};t[o.columns()]=o.data(),o.click(t,"more")}).each(function(t){var n=e.select(this);n.append("i"),n.append("span")}),u.attr("style","background-color:"+e.rgb(this.colorFill()).darker(.75)),u.select("i").attr("class","fa "+this.moreIcon()),u.select("span").text(this.moreText()),u.exit().remove()},r.prototype.exit=function(e,n){t.prototype.exit.apply(this,arguments)},r});