"function"==typeof define&&define.amd&&define("css",[],function(){return{load:function(t,e,i){i()}}}),function(t,e){"function"==typeof define&&define.amd?define("layout/AbsoluteSurface",["d3","../common/HTMLWidget","../common/TextBox","css!./AbsoluteSurface"],e):t.layout_AbsoluteSurface=e(t.d3,t.common_HTMLWidget,t.common_TextBox)}(this,function(t,e,i){function o(){e.call(this),this._tag="div"}return o.prototype=Object.create(e.prototype),o.prototype.constructor=o,o.prototype._class+=" layout_AbsoluteSurface",o.prototype.publish("units","percent","set","Units",["pixels","percent"]),o.prototype.publish("widgetX",0,"number","Widget XPos"),o.prototype.publish("widgetY",0,"number","Widget YPos"),o.prototype.publish("widgetWidth","100","string","Widget Width, omit for full"),o.prototype.publish("widgetHeight","100","string","Widget Height, omit for full"),o.prototype.publish("widget",null,"widget","Widget",null,{tags:["Private"]}),o.prototype.publish("opacity",1,"number","Opacity"),o.prototype.enter=function(t,i){e.prototype.enter.apply(this,arguments)},o.prototype.update=function(t,i){e.prototype.update.apply(this,arguments);var o=0,n=0,s=this.clientWidth(),r=this.clientHeight();switch(this.units()){case"pixels":o=this.widgetX(),n=this.widgetY(),s=""===this.widgetWidth()?s-o:Number(this.widgetWidth()),r=""===this.widgetHeight()?r-n:Number(this.widgetHeight());break;case"percent":o=this.widgetX()*s/100,n=this.widgetY()*r/100,s=""===this.widgetWidth()?s-o:Number(this.widgetWidth()*s/100),r=""===this.widgetHeight()?r-n:Number(this.widgetHeight()*r/100)}i.style("opacity",this.opacity());var l=i.selectAll("#"+this._id+" > .placeholder").data(this.widget()?[this.widget()]:[],function(t){return t._id});l.enter().append("div").attr("class","placeholder").each(function(t){t.target(this)}),l.style({left:o+"px",top:n+"px",width:s+"px",bottom:r+"px"}).each(function(t){t.resize({width:s,height:r})}),l.exit().each(function(t){t.target(null)}).remove()},o.prototype.exit=function(t,i){this.widget()&&(this.widget(null),this.render()),e.prototype.exit.apply(this,arguments)},o}),function(t,e){"function"==typeof define&&define.amd?define("layout/Accordion.js",["../common/HTMLWidget","../common/FAChar","css!./Accordion"],e):t.layout_Accordion=e(t.common_HTMLWidget,t.common_FAChar)}(this,function(t,e){function i(){t.call(this),this._tag="div",this._isClosed=!1}return i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.prototype._class+=" layout_Accordion",i.prototype.publish("content",[],"widgetArray","Array of widgets",null,{tags:["Basic"]}),i.prototype.publish("title","","string","Title of collapsible section",null,{tags:["Private"]}),i.prototype.publish("openIcon","","string","Icon to display when list is open",null,{tags:["Private"]}),i.prototype.publish("closedIcon","","string","Icon to display when list is closed",null,{tags:["Private"]}),i.prototype.publish("titleFontColor","#FFFFFF","html-color","Title font color",null,{tags:["Private"]}),i.prototype.publish("titleBackgroundColor","#333333","html-color","Title background color",null,{tags:["Private"]}),i.prototype.publish("defaultCollapsed",!1,"boolean","Collapsed by default if true",null,{tags:["Private"]}),i.prototype.pushListItem=function(t,e,i){var o=this.content();return t._protected=i,e?o.unshift(t):o.push(t),this.content(o),this},i.prototype.clearListItems=function(){var t=[];for(var e in this.content())this.content()[e]._protected&&t.push(this.content()[e]);return this.content(t),this},i.prototype.collapseClick=function(t){t.classed("closed")?(this._isClosed=!1,t.classed("open",!0),t.classed("closed",!1)):(this._isClosed=!0,t.classed("open",!1),t.classed("closed",!0))},i.prototype.enter=function(i,o){t.prototype.enter.apply(this,arguments);var n=this;this._isClosed=this.defaultCollapsed(),o.classed(this._isClosed?"closed":"open",!0),this.titleSpan=o.append("span").classed("collapsible-title",!0),this.iconDiv=o.append("div").classed("collapsible-icon",!0),this.ul=o.append("ul"),this.icon=(new e).size({height:24,width:24}).target(this.iconDiv.node()),this.iconDiv.on("click",function(){n.collapseClick(o),n.render()}),this.titleSpan.on("click",function(){n.collapseClick(o),n.render()})},i.prototype.update=function(e,i){t.prototype.update.apply(this,arguments);var o=this,n="";this.titleSpan.text(o.title().length>0?o.title()+n:"Accordion ["+o._id+"]"+n);var s=this.ul.selectAll("#"+o._id+" > ul > li").data(this.content(),function(t){return t._id});s.enter().append(function(t){var e=document.createElement("li");if(null!==t._target)return t._target;var i=t.size();if(0===i.width||0===i.height){var n=o.size();t.size({width:n.width,height:n.width})}return t.target(e),e}),s.exit().remove(),this.icon.text_colorFill(this.titleFontColor())["char"](this._isClosed?this.closedIcon():this.openIcon()).render()},i.prototype.exit=function(e,i){t.prototype.exit.apply(this,arguments)},i}),function(t,e){"function"==typeof define&&define.amd?define("layout/Surface.js",["d3","../common/HTMLWidget","../common/TextBox","css!./Surface","css!font-awesome"],e):t.layout_Surface=e(t.d3,t.common_HTMLWidget,t.common_TextBox)}(this,function(t,e,i){function o(){e.call(this),this._tag="div",this._surfaceButtons=[]}return o.prototype=Object.create(e.prototype),o.prototype.constructor=o,o.prototype._class+=" layout_Surface",o.prototype.publish("title","","string","Title",null,{tags:["Intermediate"]}),o.prototype.publish("widget",null,"widget","Widget",null,{tags:["Basic"]}),o.prototype.publish("surfaceTitlePadding",null,"number","Title Padding (px)",null,{tags:["Advanced"]}),o.prototype.publish("surfaceTitleFontSize",null,"number","Title Font Size (px)",null,{tags:["Advanced"]}),o.prototype.publish("surfaceTitleFontColor",null,"html-color","Title Font Color",null,{tags:["Advanced"]}),o.prototype.publish("surfaceTitleFontFamily",null,"string","Title Font Family",null,{tags:["Advanced"]}),o.prototype.publish("surfaceTitleFontBold",!0,"boolean","Enable Bold Title Font",null,{tags:["Advanced"]}),o.prototype.publish("surfaceTitleBackgroundColor",null,"html-color","Title Background Color",null,{tags:["Advanced"]}),o.prototype.publish("surfacePadding",null,"string","Surface Padding (px)",null,{tags:["Intermediate"]}),o.prototype.publish("surfaceBackgroundColor",null,"html-color","Surface Background Color",null,{tags:["Advanced"]}),o.prototype.publish("surfaceBorderWidth",null,"number","Surface Border Width (px)",null,{tags:["Advanced"]}),o.prototype.publish("surfaceBorderColor",null,"html-color","Surface Border Color",null,{tags:["Advanced"]}),o.prototype.publish("surfaceBorderRadius",null,"number","Surface Border Radius (px)",null,{tags:["Advanced"]}),o.prototype.publish("surfaceTitleAlignment","center","set","Title Alignment",["left","right","center"],{tags:["Basic"]}),o.prototype.publish("buttonAnnotations",[],"array","Button Array",null,{tags:["Private"]}),o.prototype.widgetSize=function(t,e){var i=this.clientWidth(),o=this.clientHeight();return this.title()&&(o-=this.calcHeight(t)),o-=this.calcFrameHeight(e),i-=this.calcFrameWidth(e),{width:i,height:o}},o.prototype.enter=function(t,i){e.prototype.enter.apply(this,arguments)},o.prototype.update=function(i,o){e.prototype.update.apply(this,arguments);var n=this;o.style("border-width",this.surfaceBorderWidth_exists()?this.surfaceBorderWidth()+"px":null).style("border-color",this.surfaceBorderColor()).style("border-radius",this.surfaceBorderRadius_exists()?this.surfaceBorderRadius()+"px":null).style("background-color",this.surfaceBackgroundColor());var s=o.selectAll(".surfaceTitle").data(this.title()?[this.title()]:[]);s.enter().insert("h3","div").attr("class","surfaceTitle"),s.text(function(t){return t}).style("text-align",this.surfaceTitleAlignment()).style("color",this.surfaceTitleFontColor()).style("font-size",this.surfaceTitleFontSize_exists()?this.surfaceTitleFontSize()+"px":null).style("font-family",this.surfaceTitleFontFamily()).style("font-weight",this.surfaceTitleFontBold()?"bold":"normal").style("background-color",this.surfaceTitleBackgroundColor()).style("padding",this.surfaceTitlePadding_exists()?this.surfaceTitlePadding()+"px":null),s.exit().remove();var r=o.select(".surfaceTitle"),l=r.append("div").attr("class","html-button-container").selectAll(".surface-button").data(this.buttonAnnotations());l.enter().append("button").classed("surface-button",!0).each(function(e,i){var o=n._surfaceButtons[i]=t.select(this).attr("class","surface-button"+(e["class"]?" "+e["class"]:"")).attr("id",e.id).style("padding",e.padding).style("width",e.width).style("height",e.height).style("cursor","pointer");"FontAwesome"===e.font?o.style("background","transparent").style("border","none").on("click",function(t){n.click(t)}).append("i").attr("class","fa").text(function(t){return e.label}):o.text(function(t){return e.label}).on("click",function(t){n.click(t)})}),l.exit().each(function(e,i){var o=t.select(this);delete n._surfaceButtons[i],o.remove()});var a=o.selectAll("#"+this._id+" > .surfaceWidget").data(this.widget()?[this.widget()]:[],function(t){return t._id});a.enter().append("div").attr("class","surfaceWidget").each(function(e){t.select(n.element().node().parentElement).classed("content-icon content-icon-"+e.classID().split("_")[1],!0),e.target(this)}),a.style("padding",this.surfacePadding_exists()?this.surfacePadding()+"px":null).each(function(e){var i=n.widgetSize(o.select("h3"),t.select(this));i.width<0&&(i.width=0),i.height<0&&(i.height=0),e.resize({width:i.width,height:i.height})}),a.exit().each(function(t){t.target(null)}).remove()},o.prototype.exit=function(t,i){this.widget()&&(this.widget(null),this.render()),e.prototype.exit.apply(this,arguments)},o.prototype.click=function(t){console.log("Clicked: "+t.id)},o}),function(t,e){"function"==typeof define&&define.amd?define("layout/Cell.js",["d3","./Surface","css!./Cell"],e):t.layout_Cell=e(t.d3,t.layout_Surface)}(this,function(t,e){function i(){e.call(this),this._dragHandles=["nw","n","ne","e","se","s","sw","w"],this._indicateTheseIds=[]}return i.prototype=Object.create(e.prototype),i.prototype.constructor=i,i.prototype._class+=" layout_Cell",i.prototype.publish("gridRow",0,"number","Grid Row Position",null,{tags:["Private"]}),i.prototype.publish("gridCol",0,"number","Grid Column Position",null,{tags:["Private"]}),i.prototype.publish("gridRowSpan",1,"number","Grid Row Span",null,{tags:["Private"]}),i.prototype.publish("gridColSpan",1,"number","Grid Column Span",null,{tags:["Private"]}),i.prototype.publish("handleSize",6,"number","Grid Row Position",null,{tags:["Private"]}),i.prototype.publish("indicatorGlowColor","#EEEE11","html-color","Glow color of update-indicator",null,{tags:["Basic"]}),i.prototype.publish("indicatorBorderColor","#F48A00","html-color","Border color of update-indicator",null,{tags:["Basic"]}),i.prototype.publish("indicatorOpacity",.8,"number","Opacity of update-indicator",null,{tags:["Basic"]}),i.prototype.indicateTheseIds=function(t){return arguments.length?(this._indicateTheseIds=t,this):this._indicateTheseIds},i.prototype.enter=function(t,i){e.prototype.enter.apply(this,arguments);var o=this;i.classed("layout_Surface",!0).on("mouseenter",function(t){o.onMouseEnter()}).on("mouseleave",function(t){o.onMouseLeave()})},i.prototype.update=function(i,o){e.prototype.update.apply(this,arguments);var n=o.selectAll("#"+this.id()+" > .dragHandle").data(this._dragHandles,function(t){return t});n.enter().append("div").attr("class",function(t){return"dragHandle dragHandle_"+t}).style({padding:"0px",margin:"0px",position:"absolute"}).each(function(e){switch(e){case"nw":t.select(this).style({width:"6px",height:"6px",left:"0px",top:"0px","z-index":1e3});break;case"ne":t.select(this).style({width:"6px",height:"6px",left:"calc(100% - 6px)",top:"0px","z-index":1e3});break;case"se":t.select(this).style({width:"6px",height:"6px",left:"calc(100% - 6px)",top:"calc(100% - 6px)","z-index":1e3});break;case"sw":t.select(this).style({width:"6px",height:"6px",left:"0px",top:"calc(100% - 6px)","z-index":1e3});break;case"n":t.select(this).style({width:"100%",height:"6px",left:"0px",top:"0px","z-index":900});break;case"e":t.select(this).style({width:"6px",height:"100%",left:"calc(100% - 6px)",top:"0px","z-index":900});break;case"s":t.select(this).style({width:"100%",height:"6px",left:"0px",top:"calc(100% - 6px)","z-index":900});break;case"w":t.select(this).style({width:"6px",height:"100%",left:"0px",top:"0px","z-index":900})}}),n.exit().remove()},i.prototype.onMouseEnter=function(e){for(var i=this.indicateTheseIds(),o=this.indicatorOpacity(),n=this.indicatorBorderColor(),s=this.indicatorGlowColor(),r=0;r<i.length;r++){var l=t.select("#"+i[r]),a=l.datum();l&&l.append("div").attr("class","update-indicator").style({width:a.width()+"px",height:a.height()+"px",opacity:o,"border-color":n,"-webkit-box-shadow":"inset 0px 0px 30px 0px "+s,"-moz-box-shadow":"inset 0px 0px 30px 0px "+s,"box-shadow":"inset 0px 0px 30px 0px "+s})}},i.prototype.onMouseLeave=function(){for(var e=this.indicateTheseIds(),i=0;i<e.length;i++)t.selectAll("#"+e[i]+" > div.update-indicator").remove()},i}),function(t,e){"function"==typeof define&&define.amd?define("layout/Border.js",["d3","../common/HTMLWidget","./Cell","../common/Text","css!./Border"],e):t.layout_Border=e(t.d3,t.common_HTMLWidget,t.layout_Cell,t.common_Text)}(this,function(t,e,i,o){function n(){e.call(this),this._tag="div",this._colCount=0,this._rowCount=0,this._colSize=0,this._rowSize=0,this._shrinkWrapBoxes={},this.content([]),this.sectionTypes([])}return n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.prototype._class+=" layout_Border",n.prototype.publish("designMode",!1,"boolean","Design Mode",null,{tags:["Basic"]}),n.prototype.publish("content",[],"widgetArray","widgets",null,{tags:["Intermediate"]}),n.prototype.publish("gutter",0,"number","Gap Between Widgets",null,{tags:["Basic"]}),n.prototype.publish("topShrinkWrap",!1,"boolean","'Top' Cell shrinks to fit content",null,{tags:["Intermediate"]}),n.prototype.publish("leftShrinkWrap",!1,"boolean","'Left' Cell shrinks to fit content",null,{tags:["Intermediate"]}),n.prototype.publish("rightShrinkWrap",!1,"boolean","'Right' Cell shrinks to fit content",null,{tags:["Intermediate"]}),n.prototype.publish("bottomShrinkWrap",!1,"boolean","'Bottom' Cell shrinks to fit content",null,{tags:["Intermediate"]}),n.prototype.publish("topSize",0,"number","Height of the 'Top' Cell (px)",null,{tags:["Private"]}),n.prototype.publish("leftSize",0,"number","Width of the 'Left' Cell (px)",null,{tags:["Private"]}),n.prototype.publish("rightSize",0,"number","Width of the 'Right' Cell (px)",null,{tags:["Private"]}),n.prototype.publish("bottomSize",0,"number","Height of the 'Bottom' Cell (px)",null,{tags:["Private"]}),n.prototype.publish("topPercentage",20,"number","Percentage (of parent) Height of the 'Top' Cell",null,{tags:["Private"]}),n.prototype.publish("leftPercentage",20,"number","Percentage (of parent) Width of the 'Left' Cell",null,{tags:["Private"]}),n.prototype.publish("rightPercentage",20,"number","Percentage (of parent) Width of the 'Right' Cell",null,{tags:["Private"]}),n.prototype.publish("bottomPercentage",20,"number","Percentage (of parent) Height of the 'Bottom' Cell",null,{tags:["Private"]}),n.prototype.publish("surfacePadding",0,"number","Cell Padding (px)",null,{tags:["Intermediate"]}),n.prototype.publish("sectionTypes",[],"array","Section Types sharing an index with 'content' - Used to determine position/size.",null,{tags:["Private"]}),n.prototype.watchWidget=function(t){if(void 0===this._watch&&(this._watch={}),this._watch[t.id()]&&(this._watch[t.id()].remove(),delete this._watch[t.id()]),t){var e=this;this._watch[t.id()]=t.monitor(function(t,i,o){o!==i&&e.lazyPostUpdate()})}},n.prototype.lazyPostUpdate=n.prototype.debounce(function(){this.postUpdate()},100),n.prototype.applyLayoutType=function(){var t=this.borderLayoutObject();this.content().forEach(function(e,i){e._fixedLeft=t[this.sectionTypes()[i]].left,e._fixedTop=t[this.sectionTypes()[i]].top,e._fixedWidth=t[this.sectionTypes()[i]].width,e._fixedHeight=t[this.sectionTypes()[i]].height,e._dragHandles=this.cellSpecificDragHandles(this.sectionTypes()[i])},this)},n.prototype.cellSpecificDragHandles=function(t){switch(t){case"top":return["s"];case"right":return["w"];case"bottom":return["n"];case"left":return["e"];case"center":return[]}},n.prototype.borderLayoutObject=function(t){function e(t){t.width.px="undefined"!=typeof t.width.px?t.width.px:0,t.width["%"]="undefined"!=typeof t.width["%"]?t.width["%"]:0,t.height.px="undefined"!=typeof t.height.px?t.height.px:0,t.height["%"]="undefined"!=typeof t.height["%"]?t.height["%"]:0;var e={width:t.width.px+t.width["%"]/100*y.width(),height:t.height.px+t.height["%"]/100*y.height(),top:t.top.px+t.top["%"]/100*y.height()+y.gutter()/2,left:t.left.px+t.left["%"]/100*y.width()+y.gutter()/2};return e}var i,o,n,s,r,l,a,d,h,p,c,u,g,f={},y=this,_=this.target().getBoundingClientRect(),b={};return b.top=_.top,b.left=_.left,b.bottom=_.bottom,b.right=_.right,this.target()instanceof SVGElement?(b.width=parseFloat(this.target().getAttribute("width")),b.height=parseFloat(this.target().getAttribute("height"))):(b.width=_.width,b.height=_.height),-1!==this.sectionTypes().indexOf("top")&&(l=this.topSize(),a=this.topPercentage(),"undefined"!=typeof this._shrinkWrapBoxes.top&&(l=this._shrinkWrapBoxes.top.height+this.gutter(),a=0)),-1!==this.sectionTypes().indexOf("bottom")&&(d=this.bottomSize(),h=this.bottomPercentage(),"undefined"!=typeof this._shrinkWrapBoxes.bottom&&(d=this._shrinkWrapBoxes.bottom.height+this.gutter(),h=0)),-1!==this.sectionTypes().indexOf("left")&&(p=this.leftSize(),c=this.leftPercentage(),"undefined"!=typeof this._shrinkWrapBoxes.left&&(p=this._shrinkWrapBoxes.left.width+this.gutter(),c=0)),-1!==this.sectionTypes().indexOf("right")&&(u=this.rightSize(),g=this.rightPercentage(),"undefined"!=typeof this._shrinkWrapBoxes.right&&(u=this._shrinkWrapBoxes.right.width+this.gutter(),g=0)),i=e({width:{px:0,"%":100},height:{px:l,"%":a},top:{px:0,"%":0},left:{px:0,"%":0}}),o=e({width:{px:0,"%":100},height:{px:d,"%":h},top:{px:0,"%":100},left:{px:0,"%":0}}),o.top-=o.height,s=e({width:{px:p,"%":c},height:{px:-i.height-o.height,"%":100},top:{px:i.height,"%":0},left:{px:0,"%":0}}),n=e({width:{px:u,"%":g},height:{px:-i.height-o.height,"%":100},top:{px:i.height,"%":0},left:{px:0,"%":100}}),n.left-=n.width,r=e({width:{px:-n.width-s.width,"%":100},height:{px:-i.height-o.height,"%":100},top:{px:i.height,"%":0},left:{px:s.width,"%":0}}),f.top=i,f.bottom=o,f.right=n,f.left=s,f.center=r,f},n.prototype.clearContent=function(e){if(e){var i=this.sectionTypes().indexOf(e);i>=0&&(this._watch&&this.content()[i]&&delete this._watch[this.content()[i].id()],this.content()[i].target(null),t.select("#"+this.id()+" > div.borderHandle_"+e).classed("borderHandleDisabled",!0),this.content().splice(i,1),this.sectionTypes().splice(i,1))}else this.content().forEach(function(t){return t.target(null),!1}),t.select("#"+this.id()+" > div.borderHandle").classed("borderHandleDisabled",!0),delete this._watch,this.content([]),this.sectionTypes([])},n.prototype.hasContent=function(t,e,i){return this.sectionTypes().indexOf(t)>=0},n.prototype.setContent=function(t,e,o){if(this.clearContent(t),o="undefined"!=typeof o?o:"",e){var n=(new i).surfaceBorderWidth(0).widget(e).title(o);this.watchWidget(e),this.content().push(n),this.sectionTypes().push(t)}return this},n.prototype.getContent=function(t){var e=this.sectionTypes().indexOf(t);return e>=0?this.content()[e].widget():null},n.prototype.setLayoutOffsets=function(){this._offsetX=this._element.node().getBoundingClientRect().left+this.gutter()/2,this._offsetY=this._element.node().getBoundingClientRect().top+this.gutter()/2},n.prototype.dragStart=function(e){t.event.sourceEvent.stopPropagation();var i=this;this._dragCell=e,this._dragCellStartSize=this[e+"Size"](),this[e+"ShrinkWrap"]()&&(this[e+"Percentage"](0),this[e+"ShrinkWrap"](!1));var o=t.select("#"+i.id()+" > div.borderHandle_"+e);i._handleTop=parseFloat(o.style("top").split("px")[0]),i._handleLeft=parseFloat(o.style("left").split("px")[0]),this._dragPrevX=t.event.sourceEvent.clientX,this._dragPrevY=t.event.sourceEvent.clientY},n.prototype.dragTick=function(e){function i(e,i){if(0!==i){var n=t.selectAll("#"+o.id()+" > div.borderHandle"),s=t.select("#"+o.id()+" > div.borderHandle_"+e);s.classed("borderHandle_top")?(s.style({top:o._handleTop-i+"px"}),o._cellSizes.topHeight=o._handleTop-i,o._cellSizes.leftHeight=o._cellSizes.height,o._cellSizes.leftHeight-=o._cellSizes.topHeight,o._cellSizes.leftHeight-=o._cellSizes.bottomHeight,o._cellSizes.rightHeight=o._cellSizes.leftHeight):s.classed("borderHandle_right")?(s.style({left:o._handleLeft-i+"px"}),o._cellSizes.rightWidth=o._cellSizes.width-o._handleLeft+i):s.classed("borderHandle_bottom")?(s.style({top:o._handleTop-i+"px"}),o._cellSizes.bottomHeight=o._cellSizes.height-o._handleTop+i,o._cellSizes.leftHeight=o._cellSizes.height,o._cellSizes.leftHeight-=o._cellSizes.bottomHeight,o._cellSizes.leftHeight-=o._cellSizes.topHeight,o._cellSizes.rightHeight=o._cellSizes.leftHeight):s.classed("borderHandle_left")&&(s.style({left:o._handleLeft-i+"px"}),o._cellSizes.leftWidth=o._handleLeft-i),n.each(function(){var e=t.select(this);e.classed("borderHandle_top")?e.style({width:o._cellSizes.width+"px",top:o._cellSizes.topHeight-3+"px"}):e.classed("borderHandle_right")?e.style({left:o._cellSizes.width-o._cellSizes.rightWidth+"px",top:o._cellSizes.topHeight+3+"px",height:o._cellSizes.rightHeight+"px"}):e.classed("borderHandle_bottom")?e.style({width:o._cellSizes.width+"px",top:o._cellSizes.height-o._cellSizes.bottomHeight-3+"px"}):e.classed("borderHandle_left")&&e.style({left:o._cellSizes.leftWidth+"px",height:o._cellSizes.leftHeight+"px",top:o._cellSizes.topHeight+3+"px"})})}}var o=this,n=this._dragPrevX-t.event.sourceEvent.clientX,s=this._dragPrevY-t.event.sourceEvent.clientY;switch(e){case"top":case"bottom":i(e,s);break;case"right":case"left":i(e,n)}},n.prototype.dragEnd=function(e){if(e){var i=this._dragPrevX-t.event.sourceEvent.clientX,o=this._dragPrevY-t.event.sourceEvent.clientY;switch(e){case"top":0!==o&&(this.topPercentage(0),this.topSize(0===this.topSize()?this.getContent("top").getBBox().height-o:this.topSize()-o));break;case"right":0!==i&&(this.rightPercentage(0),this.rightSize(0===this.rightSize()?this.getContent("right").getBBox().width+i:this.rightSize()+i));break;case"bottom":0!==o&&(this.bottomPercentage(0),this.bottomSize(0===this.bottomSize()?this.getContent("bottom").getBBox().height+o:this.bottomSize()+o));break;case"left":0!==i&&(this.leftPercentage(0),this.leftSize(0===this.leftSize()?this.getContent("left").getBBox().width-i:this.leftSize()-i))}this._dragPrevX=t.event.sourceEvent.clientX,this._dragPrevY=t.event.sourceEvent.clientY}this.render()},n.prototype.size=function(t){var i=e.prototype.size.apply(this,arguments);return arguments.length&&this.contentDiv&&this.contentDiv.style("width",this._size.width+"px").style("height",this._size.height+"px"),i},n.prototype.enter=function(i,o){e.prototype.enter.apply(this,arguments);var n=this;o.style("position","relative"),this.contentDiv=o.append("div").classed("border-content",!0),this._scrollBarWidth=this.getScrollbarWidth(),this._borderHandles=["top","left","right","bottom"];var s=o.selectAll("div.borderHandle").data(this._borderHandles);s.enter().append("div").classed("borderHandle",!0).each(function(e){var i=t.select(this);i.classed("borderHandle_"+e,!0).classed("borderHandleDisabled",null===n.getContent(e))})},n.prototype.update=function(i,o){e.prototype.update.apply(this,arguments),this._sectionTypeArr=this.sectionTypes();var n=this;o.classed("design-mode",this.designMode()),this.setLayoutOffsets();var s=this.contentDiv.selectAll(".cell_"+this._id).data(this.content(),function(t){return t._id});s.enter().append("div").classed("cell_"+this._id,!0).style("position","absolute").each(function(e,i){t.select(this).classed("border-cell border-cell-"+n._sectionTypeArr[i],!0),e.target(this),t.select("#"+n.id()+" > div.borderHandle_"+n._sectionTypeArr[i]).classed("borderHandleDisabled",!1)}),s.each(function(t,e){var i=n.sectionTypes()[e];"undefined"!=typeof n[i+"ShrinkWrap"]&&n[i+"ShrinkWrap"]()?(t.render(),n._shrinkWrapBoxes[i]=t.widget().getBBox(!0)):delete n._shrinkWrapBoxes[i]});var r=t.behavior.drag().on("dragstart",function(t,e){n.dragStart.call(n,t,e)}).on("drag",function(t,e){n.dragTick.call(n,t,e)}).on("dragend",function(t,e){n.dragEnd.call(n,t,e)});this.designMode()?o.selectAll("#"+this.id()+" > div.borderHandle").call(r):o.selectAll("#"+this.id()+" > div.borderHandle").on(".drag",null);var l=this.borderLayoutObject();this.content().forEach(function(t,e){t._fixedLeft=l[this.sectionTypes()[e]].left,t._fixedTop=l[this.sectionTypes()[e]].top,t._fixedWidth=l[this.sectionTypes()[e]].width,t._fixedHeight=l[this.sectionTypes()[e]].height,t._dragHandles=[]},this),s.style("left",function(t){return t._fixedLeft+"px"}).style("top",function(t){return t._fixedTop+"px"}).style("width",function(t){return t._fixedWidth-n.gutter()+"px"}).style("height",function(t){return t._fixedHeight-n.gutter()+"px"}).each(function(t){t._parentElement.attr("draggable",n.designMode()).selectAll(".dragHandle").attr("draggable",n.designMode()),t.surfacePadding(n.surfacePadding()).resize()}),s.exit().each(function(t){t.target(null)}).remove(),this.getCellSizes(),o.selectAll("#"+this.id()+" > div.borderHandle").each(function(){var e=t.select(this);e.classed("borderHandle_top")?e.style({width:n._cellSizes.width+"px",top:n._cellSizes.topHeight-3+"px"}):e.classed("borderHandle_right")?e.style({left:n._cellSizes.width-n._cellSizes.rightWidth+"px",top:n._cellSizes.topHeight+3+"px",height:n._cellSizes.rightHeight+"px"}):e.classed("borderHandle_bottom")?e.style({width:n._cellSizes.width+"px",top:n._cellSizes.height-n._cellSizes.bottomHeight-3+"px"}):e.classed("borderHandle_left")&&e.style({left:n._cellSizes.leftWidth+"px",height:n._cellSizes.leftHeight+"px",top:n._cellSizes.topHeight+3+"px"})})},n.prototype.getCellSizes=function(){var e=this;e._cellSizes={};var i=this.element().node().getBoundingClientRect();e._cellSizes.width=i.width,e._cellSizes.height=i.height,this.element().selectAll("#"+this.id()+" > div > div.border-cell").each(function(){var i=t.select(this);if("function"==typeof i.node){var o=i.node().getBoundingClientRect();i.classed("border-cell-top")?e._cellSizes.topHeight=o.height:i.classed("border-cell-left")?(e._cellSizes.leftWidth=o.width,e._cellSizes.leftHeight=o.height):i.classed("border-cell-right")?(e._cellSizes.rightWidth=o.width,e._cellSizes.rightHeight=o.height):i.classed("border-cell-bottom")&&(e._cellSizes.bottomHeight=o.height)}});var o=["height","width","topHeight","bottomHeight","leftHeight","rightHeight","leftWidth","rightWidth"];o.forEach(function(t){e._cellSizes[t]=void 0===e._cellSizes[t]?0:e._cellSizes[t]})},n.prototype.postUpdate=function(t,e){var i=this;this.content().forEach(function(t){if(null!==t._element.node()){var e=t.widget().getBBox(!1,!0),o=t.widget().getBBox(!0,!0);(e.width!==o.width||e.height!==o.height)&&i.lazyRender()}})},n.prototype.exit=function(t,i){e.prototype.exit.apply(this,arguments)},n}),function(t,e){"function"==typeof define&&define.amd?define("layout/Grid.js",["d3","../common/HTMLWidget","./Cell","../common/TextBox","../common/Utility","css!./Grid"],e):t.layout_Grid=e(t.d3,t.common_HTMLWidget,t.layout_Cell,t.common_TextBox,t.common_Utility)}(this,function(t,e,i,o,n){function s(){e.call(this),this._tag="div",this._colCount=0,this._rowCount=0,this._colSize=0,this._rowSize=0,this._selectionBag=new n.Selection,this.content([])}return s.prototype=Object.create(e.prototype),s.prototype.constructor=s,s.prototype._class+=" layout_Grid",s.prototype.publish("designMode",!1,"boolean","Design Mode",null,{tags:["Basic"]}),s.prototype.publish("designModeOpacity",1,"number","Opacity of Cells and drag handles in Design Mode",null,{tags:["Basic"]}),s.prototype.publish("hideDragHandles",!1,"boolean","Hide Drag Handles in Design Mode",null,{tags:["Basic"]}),s.prototype.publish("hideDesignGrid",!1,"boolean","Hide Design Mode Grid",null,{tags:["Basic"]}),s.prototype.publish("disableCellSelection",!1,"boolean","Disable the ability to 'select' cells while in designMode",null,{tags:["Basic"]}),s.prototype.publish("restrictDraggingOut",!1,"boolean","Restrict Cell dragging to the bounds of the Grid",null,{tags:["Basic"]}),s.prototype.publish("gutter",4,"number","Gap Between Widgets",null,{tags:["Basic"]}),s.prototype.publish("fitTo","all","set","Sizing Strategy",["all","width"],{tags:["Basic"]}),s.prototype.publish("designGridColor","#dddddd","html-color","Color of grid lines in Design Mode",null,{tags:["Private"]}),s.prototype.publish("designGridColorExtra","#333333","html-color","Color of excess grid lines in Design Mode",null,{tags:["Private"]}),s.prototype.publish("surfacePadding",null,"string","Cell Padding (px)",null,{tags:["Intermediate"]}),s.prototype.publish("surfaceBorderWidth",1,"number","Width (px) of Cell Border",null,{tags:["Intermediate"]}),s.prototype.publish("extraDesignModeWidth",0,"number","Number of additional columns added when in Design Mode.",null,{tags:["Private"]}),s.prototype.publish("extraDesignModeHeight",0,"number","Number of additional rows added when in Design Mode.",null,{tags:["Private"]}),s.prototype.publish("cellDensity",3,"string","Increase the cell density with this multiplier (Ex: 3 results in 3 cols per col and 3 rows per row)",null,{tags:["Intermediate"]}),s.prototype.publish("content",[],"widgetArray","widgets",null,{tags:["Basic"]}),s.prototype.getDimensions=function(){var t={width:0,height:0};return this.content().forEach(function(e){t.width<e.gridCol()+e.gridColSpan()&&(t.width=e.gridCol()+e.gridColSpan()),t.height<e.gridRow()+e.gridRowSpan()&&(t.height=e.gridRow()+e.gridRowSpan())},this),t},s.prototype.clearContent=function(t){this.content(this.content().filter(function(e){if(!t)return e.target(null),!1;for(var i=e;i;){if(t===i)return e.target(null),!1;i=i.widget?i.widget():null}return!0}))},s.prototype.setContent=function(t,e,o,n,s,r){s=s||1,r=r||1,n=n||"";var l=this.cellDensity();if(this.content(this.content().filter(function(i){return i.gridRow()===t*l&&i.gridCol()===e*l?(i.target(null),!1):!0})),o){var a=(new i).gridRow(t*l).gridCol(e*l).widget(o).title(n).gridRowSpan(s*l).gridColSpan(r*l);this.prevDensity=l,this.content().push(a)}return this},s.prototype.sortedContent=function(){return this.content().sort(function(t,e){return t.gridRow()===e.gridRow()?t.gridCol()-e.gridCol():t.gridRow()-e.gridRow()})},s.prototype.getCell=function(t,e){var i=null;return this.content().some(function(o){return t>=o.gridRow()&&t<o.gridRow()+o.gridRowSpan()&&e>=o.gridCol()&&e<o.gridCol()+o.gridColSpan()?(i=o,!0):!1}),i},s.prototype.getWidgetCell=function(t){var e=null;return this.content().some(function(i){return i.widget()._id===t?(e=i,!0):!1}),e},s.prototype.getContent=function(t){var e=null;return this.content().some(function(i){return i.widget()._id===t?(e=i.widget(),!0):!1}),e},s.prototype.updateCellMultiples=function(){var t=this;this.prevDensity!==this.cellDensity()&&(this.content().forEach(function(e){if(t.prevDensity&&t.cellDensity()){var i=t.prevDensity,o=t.cellDensity();e.gridRow(Math.floor(e.gridRow()*o/i)),e.gridCol(Math.floor(e.gridCol()*o/i)),e.gridRowSpan(Math.floor(e.gridRowSpan()*o/i)),e.gridColSpan(Math.floor(e.gridColSpan()*o/i))}}),this.prevDensity=this.cellDensity())},s.prototype.childMoved=s.prototype.debounce(function(t,e){this.render()},250),s.prototype.resizeContent=function(){return this.content().forEach(function(t){t.resize()}),this},s.prototype.renderContent=function(t){var e=0;if(this.content().forEach(function(t){e++,t.render(function(){--e})}),t)var i=setInterval(function(){0>=e&&(clearInterval(i),t())},20);return this},s.prototype.enter=function(t,i){e.prototype.enter.apply(this,arguments),
i.style("position","relative"),this.dropDiv=i.append("div"),this.contentDiv=i.append("div"),this._scrollBarWidth=this.getScrollbarWidth()},s.prototype.findCurrentLocation=function(t){this._currLoc=[Math.floor((t.clientX-this._offsetX)/this._colSize),Math.floor((t.clientY-this._offsetY)/this._rowSize)]},s.prototype.overHandle=function(t){var e="",i=this._dragCell.handleSize(),o=this._dragCell.gridRowSpan()===this._currLoc[1]-this._dragCell.gridRow()+1,n=this._dragCell.gridRow()===this._currLoc[1],s=this._dragCell.gridColSpan()===this._currLoc[0]-this._dragCell.gridCol()+1,r=this._dragCell.gridCol()===this._currLoc[0],l=this._offsetY+this._currLoc[1]*this._rowSize,a=this._offsetX+this._currLoc[0]*this._colSize,d=this._colSize-this.gutter(),h=this._rowSize-this.gutter();return Math.ceil(l+h)>=t.clientY&&Math.floor(l+h-i)<=t.clientY&&o?e="s":Math.floor(l)<=t.clientY&&Math.ceil(l+i)>=t.clientY&&n&&(e="n"),Math.ceil(a+d)>=t.clientX&&Math.floor(a+d-i)<=t.clientX&&s?e+="e":Math.floor(a)<=t.clientX&&Math.ceil(a+i)>=t.clientX&&r&&(e+="w"),e},s.prototype.createDropTarget=function(t,e){var i=t[0]-this._dragCellOffsetX,o=t[1]-this._dragCellOffsetY,n=this._dragCell.gridColSpan(),s=this._dragCell.gridRowSpan(),r=document.createElement("div");r.id="grid-drop-target"+this.id(),r.className="grid-drop-target grid-drag-handle-"+e,this._element.node().appendChild(r),this.updateDropTarget(i,o,n,s)},s.prototype.setGridOffsets=function(){this._offsetX=this._element.node().getBoundingClientRect().left+this.gutter()/2,this._offsetY=this._element.node().getBoundingClientRect().top+this.gutter()/2},s.prototype.updateDropTarget=function(t,e,i,o){if(this.restrictDraggingOut()){var n=0>e,s=t+i>this._colCount,r=e+o>this._rowCount,l=0>t;if(s){var a=t+i-this._colCount;t-=a}if(r){var d=e+o-this._rowCount;e-=d}l&&(t=0),n&&(e=0)}var h,p,c,u;h=this._offsetY+e*this._rowSize,p=this._offsetX+t*this._colSize,c=i*this._colSize-this.gutter(),u=o*this._rowSize-this.gutter();var g=document.getElementById("grid-drop-target"+this.id());g.style.top=h+"px",g.style.left=p+"px",g.style.width=c+"px",g.style.height=u+"px"},s.prototype.moveDropTarget=function(t){if(this.restrictDraggingOut()&&(t[0]=t[0]>this._colCount-1?this._colCount-1:t[0],t[0]=t[0]<0?0:t[0],t[1]=t[1]>this._rowCount-1?this._rowCount-1:t[1],t[1]=t[1]<0?0:t[1]),this._handle){var e=[];switch(this._handle){case"nw":e=[this._dragCell.gridCol()+this._dragCell.gridColSpan()-1,this._dragCell.gridRow()+this._dragCell.gridRowSpan()-1];break;case"n":case"ne":e=[this._dragCell.gridCol(),this._dragCell.gridRow()+this._dragCell.gridRowSpan()-1];break;case"e":case"se":case"s":e=[this._dragCell.gridCol(),this._dragCell.gridRow()];break;case"sw":case"w":e=[this._dragCell.gridCol()+this._dragCell.gridColSpan()-1,this._dragCell.gridRow()]}switch(this._handle){case"e":case"w":this._locY=e[1];break;default:this._locY=t[1]<=e[1]?t[1]:e[1]}switch(this._handle){case"n":case"s":this._locX=e[0];break;default:this._locX=t[0]<=e[0]?t[0]:e[0]}switch(this._handle){case"n":case"s":this._sizeX=this._dragCell.gridColSpan();break;default:this._sizeX=Math.abs(t[0]-e[0])+1}switch(this._handle){case"e":case"w":this._sizeY=this._dragCell.gridRowSpan();break;default:this._sizeY=Math.abs(t[1]-e[1])+1}}else if(null!==document.getElementById("grid-drop-target"+this.id())){var i=this.getCell(t[1],t[0]);null!==i&&this._dragCell._id!==i._id?(document.getElementById("grid-drop-target"+this.id()).className="grid-drop-target drop-target-over",this._locX=i.gridCol(),this._locY=i.gridRow(),this._sizeX=i.gridColSpan(),this._sizeY=i.gridRowSpan()):(document.getElementById("grid-drop-target"+this.id()).className="grid-drop-target",this._locX=t[0]-this._dragCellOffsetX,this._locY=t[1]-this._dragCellOffsetY,this._sizeX=this._dragCell.gridColSpan(),this._sizeY=this._dragCell.gridRowSpan())}this.updateDropTarget(this._locX,this._locY,this._sizeX,this._sizeY)},s.prototype.updateCells=function(e,i){var o=this;this.updateCellMultiples();var n=this.contentDiv.selectAll(".cell_."+this._id).data(this.content(),function(t){return t._id});n.enter().append("div").attr("class","cell_ "+this._id).style("position","absolute").each(function(t){t.target(this),t.__grid_watch=t.monitor(function(t,e,i){o._renderCount&&0===t.indexOf("grid")&&e!==i&&o.childMoved()})});var s=t.behavior.drag().on("dragstart",function(e){t.event.sourceEvent.stopPropagation(),o._dragCell=e,o.setGridOffsets(),o.findCurrentLocation(t.event.sourceEvent),o._startLoc=[o._currLoc[0],o._currLoc[1]],o._element.selectAll(".dragHandle").style("visibility","hidden"),o._handle=o.overHandle(t.event.sourceEvent),-1===o._dragCell._dragHandles.indexOf(o._handle)&&(o._handle=void 0),o._dragCellOffsetX=o._currLoc[0]-e.gridCol(),o._dragCellOffsetY=o._currLoc[1]-e.gridRow(),o.createDropTarget(o._currLoc,o._handle),setTimeout(function(){o.contentDiv.selectAll(".cell_."+o._id).classed("dragItem",function(t){return e._id===t._id}).classed("notDragItem",function(t){return e._id!==t._id})},0),o._initSelection=!0}).on("drag",function(e){o._initSelection=!1,o._dragCell=e,o.findCurrentLocation(t.event.sourceEvent),("undefined"==typeof o._currLocation||o._currLocation[0]!==o._currLoc[0]||o._currLocation[1]!==o._currLoc[1])&&(o._currLocation=o._currLoc,o.moveDropTarget(o._currLoc))}).on("dragend",function(){if(t.event.sourceEvent.stopPropagation(),(o._initSelection||o._startLoc[0]===o._currLoc[0]||o._startLoc[1]===o._currLoc[1])&&(o.disableCellSelection()||o.selectionBagClick(o.getCell(o._currLoc[1],o._currLoc[0]))),o._element.selectAll(".dragHandle").style("visibility",null),o._handle)if(o.restrictDraggingOut()){var e=o._locY>0?o._locY:0,i=o._locX>0?o._locX:0;e=o._locY+o._sizeY<o._rowCount?o._locY:o._rowCount-o._sizeY,i=o._locX+o._sizeX<o._colCount?o._locX:o._colCount-o._sizeX,o._dragCell.gridRow(e),o._dragCell.gridRowSpan(o._sizeY),o._dragCell.gridCol(i),o._dragCell.gridColSpan(o._sizeX)}else o._dragCell.gridRow(o._locY),o._dragCell.gridRowSpan(o._sizeY),o._dragCell.gridCol(o._locX),o._dragCell.gridColSpan(o._sizeX);else{var n=o._currLoc[1],s=o._currLoc[0],r=o._dragCell.gridRowSpan(),l=o._dragCell.gridColSpan(),a=o.getCell(o._currLoc[1],o._currLoc[0]);a===o._dragCell&&(r=a.gridRowSpan(),l=a.gridColSpan(),a=null);var d,h;if(a)n=a.gridRow(),s=a.gridCol(),r=a.gridRowSpan(),l=a.gridColSpan(),a.gridCol(o._dragCell.gridCol()).gridColSpan(o._dragCell.gridColSpan()).gridRow(o._dragCell.gridRow()).gridRowSpan(o._dragCell.gridRowSpan()),d=s,h=n;else if(d=s-o._dragCellOffsetX,h=n-o._dragCellOffsetY,o.restrictDraggingOut()){r=o._dragCell.gridRowSpan(),l=o._dragCell.gridColSpan();var p=d+l-o._colCount,c=h+r-o._rowCount;d-=p>0?p:0,h-=c>0?c:0,d=d>0?d:0,h=h>0?h:0}o._dragCell.gridCol(d).gridRow(h).gridColSpan(l).gridRowSpan(r)}var u=document.getElementById("grid-drop-target"+o.id());u.parentNode.removeChild(u),setTimeout(function(){o.contentDiv.selectAll(".cell_."+o._id).classed("dragItem",!1).classed("notDragItem",!1)},0),o._dragCell=null});this.designMode()?(this.contentDiv.selectAll(".cell_."+this._id).call(s),t.select(o._target).on("click",function(){o._selectionBag.clear(),o.postSelectionChange()})):(this.contentDiv.selectAll(".cell_."+this._id).on(".drag",null),this._selectionBag.clear()),n.style("left",function(t){return t.gridCol()*e+o.gutter()/2+"px"}).style("top",function(t){return t.gridRow()*i+o.gutter()/2+"px"}).style("width",function(t){return t.gridColSpan()*e-o.gutter()+"px"}).style("height",function(t){return t.gridRowSpan()*i-o.gutter()+"px"}).each(function(t){t._parentElement.attr("draggable",o.designMode()).selectAll(".dragHandle").attr("draggable",o.designMode()),t.surfacePadding_default(o.surfacePadding()).surfaceBorderWidth_default(o.surfaceBorderWidth()).resize()}),n.exit().each(function(t){t.target(null),t.__grid_watch&&t.__grid_watch.remove()}).remove()},s.prototype.postSelectionChange=function(){},s.prototype.updateDropCells=function(t,e,i){function o(t){return parseInt(t)-.5}function n(t,e,i,o,n){h.beginPath(),h.strokeStyle=n,h.moveTo(t,i),h.lineTo(e,o),h.stroke()}function s(){var o=!1;return"undefined"==typeof r.prevDimensions?o=!0:r.prevDimensions.width!==t.width||r.prevDimensions.height!==t.height?o=!0:r.prevCellWidth!==e||r.prevCellHeight!==i?o=!0:""===r._target.style.backgroundImage&&r.designMode()&&!r.hideDesignGrid()?o=!0:""===r._target.style.backgroundImage||r.designMode()?""!==r._target.style.backgroundImage&&r.hideDesignGrid()&&(o=!0):o=!0,o}var r=this;if(s())if(this.designMode()&&!this.hideDesignGrid()){var l=document.createElement("canvas");l.width=t.width*e,l.height=t.height*i;for(var a=(t.width-this.extraDesignModeWidth())*e,d=(t.height-this.extraDesignModeHeight())*i,h=l.getContext("2d"),p=0,c=.5+e;c<l.width;c+=e)p++,p<t.width-this.extraDesignModeWidth()?n(o(c),o(c),0,d,this.designGridColor()):n(o(c),o(c),0,l.height,this.designGridColorExtra());for(var u=0,g=.5+i;g<l.height;g+=i)u++,u<t.height-this.extraDesignModeHeight()?n(0,a,o(g),o(g),this.designGridColor()):n(0,l.width,o(g),o(g),this.designGridColorExtra());p=0;for(var f=.5+e;f<l.width;f+=e)p<t.width-this.extraDesignModeWidth()&&n(o(f),o(f),d,l.height,this.designGridColorExtra());u=0;for(var y=.5+i;y<l.height;y+=i)u<t.height-this.extraDesignModeHeight()&&n(a,l.width,o(y),o(y),this.designGridColorExtra());this._target&&(this._target.style.backgroundImage="url("+l.toDataURL()+")"),this.prevDimensions={width:t.width,height:t.height},this.prevCellWidth=e,this.prevCellHeight=i}else this._target&&(this._target.style.backgroundImage="")},s.prototype.update=function(t,i){e.prototype.update.apply(this,arguments),this._parentElement.style("overflow-x","width"===this.fitTo()?"hidden":null),this._parentElement.style("overflow-y","width"===this.fitTo()?"scroll":null);var o=this.getDimensions();this.designMode()&&(o.width+=this.extraDesignModeWidth(),o.height+=this.extraDesignModeHeight());var n=(this.width()-("width"===this.fitTo()?this._scrollBarWidth:0))/o.width,s="all"===this.fitTo()?this.height()/o.height:n;this._colCount=o.width,this._rowCount=o.height,this._colSize=n,this._rowSize=s,i.selectAll("#"+this.id()+" > div > div.cell_ > div[draggable=true]").style({opacity:this.designModeOpacity()}),i.selectAll("#"+this.id()+" > div > div.cell_ > div[draggable=true] > div > div.dragHandle").style({opacity:this.designModeOpacity()}),i.selectAll("#"+this.id()+" > div > div.cell_ > div[draggable=false]").style({opacity:1}),i.selectAll("#"+this.id()+" > div > div.cell_ > div[draggable=false] > div > div.dragHandle").style({opacity:1}),this.updateCells(n,s),this.updateDropCells(o,n,s),i.classed("hideHandles",this.hideDragHandles())},s.prototype.exit=function(t,i){e.prototype.exit.apply(this,arguments)},s.prototype._createSelectionObject=function(t){return{_id:t._id,element:function(){return t._element},widget:t}},s.prototype.selection=function(t){return arguments.length?(this._selectionBag.set(t.map(function(t){return this._createSelectionObject(t)},this)),this):this._selectionBag.get().map(function(t){return t._id})},s.prototype.selectionBagClick=function(e){if(null!==e){var i=this._createSelectionObject(e);t.event.sourceEvent.ctrlKey?this._selectionBag.isSelected(i)?(this._selectionBag.remove(i),this.postSelectionChange()):(this._selectionBag.append(i),this.postSelectionChange()):(this._selectionBag.set([i]),this.postSelectionChange())}},s}),function(t,e){"function"==typeof define&&define.amd?define("layout/Layered.js",["d3","../common/HTMLWidget","../layout/AbsoluteSurface","../common/TextBox","../common/Text","css!./Layered"],e):t.layout_Layered=e(t.d3,t.common_HTMLWidget,t.layout_AbsoluteSurface,t.common_TextBox,t.common_Text)}(this,function(t,e,i,o,n){function s(){e.call(this),this._tag="div"}return s.prototype=Object.create(e.prototype),s.prototype.constructor=s,s.prototype._class+=" layout_Layered",s.prototype.publish("surfacePadding",0,"number","Padding"),s.prototype.publish("widgets",[],"widgetArray","widgets",null,{tags:["Private"]}),s.prototype.addLayer=function(t){var e=this.widgets();return e.push(t?t:(new n).text("No widget defined for layer.")),this.widgets(e),this},s.prototype.enter=function(t,i){e.prototype.enter.apply(this,arguments),this._contentContainer=i.append("div").attr("class","container")},s.prototype.update=function(t,i){e.prototype.update.apply(this,arguments);var o=this;i.style("padding",this.surfacePadding()+"px");var n=this._contentContainer.selectAll(".content.id"+this.id()).data(this.widgets(),function(t){return t.id()});n.enter().append("div").attr("class","content id"+this.id()).each(function(t,e){t.target(this)}),n.each(function(t,e){t.resize({width:o.clientWidth(),height:o.clientHeight()}).render()}),n.exit().each(function(t,e){t.target(null)}).remove(),n.order()},s}),function(t,e){"function"==typeof define&&define.amd?define("layout/Popup.js",["d3","../common/HTMLWidget","../layout/Surface","../common/Icon"],e):t.layout_Popup=e(t.d3,t.common_HTMLWidget,t.layout_Surface,t.common_Icon)}(this,function(t,e,i,o){function n(){e.call(this),this._tag="div",this._surfaceButtons=[]}return n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.prototype._class+=" layout_Popup",n.prototype.publish("popupState",!1,"boolean","State of the popup, visible (true) or hidden (false)",null,{}),n.prototype.publish("shrinkWrap",!1,"boolean","The popup parent container either shrinks to the size of its contents (true) or expands to fit thge popup's parentDiv (false)",null,{}),n.prototype.publish("centerPopup","none","set","Center the widget in its container element (target) or in the window",["none","container","window"],{}),n.prototype.publish("top",null,"number","Top position property of popup",null,{}),n.prototype.publish("bottom",null,"number","Bottom position property of popup",null,{}),n.prototype.publish("left",null,"number","Left position property of popup",null,{}),n.prototype.publish("right",null,"number","Right position property of popup",null,{}),n.prototype.publish("position","relative","set","Value of the 'position' property",["absolute","relative","fixed","static","initial","inherit"],{tags:["Private"]}),n.prototype.publish("widget",null,"widget","Widget",null,{tags:["Private"]}),n.prototype.updateState=function(t){t=t||!this.popupState(),this.popupState(t).render()},n.prototype.enter=function(t,i){e.prototype.enter.apply(this,arguments),this.widget().target(t),this._originalPosition=this.position()},n.prototype.update=function(t,i){e.prototype.update.apply(this,arguments),i.style({visibility:this.popupState()?null:"hidden",opacity:this.popupState()?null:0,width:this.shrinkWrap()?this.widget().width()+"px":this._size.width+"px",height:this.shrinkWrap()?this.widget().height()+"px":this._size.height+"px"}),0===this.widget().size().height&&this.widget().resize(this.size())},n.prototype.postUpdate=function(t,i){var o,n;switch(this.centerPopup()){case"container":this._parentElement&&(o=parseInt(this._parentElement.style("width"))/2-this.widget().width()/2,n=parseInt(this._parentElement.style("height"))/2-this.widget().height()/2),this.position("absolute");break;case"window":o=window.innerWidth/2-this.widget().width()/2,n=window.innerHeight/2-this.widget().height()/2,this.position("fixed");break;default:o=0,n=0,this.position(this._originalPosition)}this.pos({x:o,y:n}),e.prototype.postUpdate.apply(this,arguments),i.style("position",this.position()).style("left",this.left()+"px").style("right",this.right()+"px").style("top",this.top()+"px").style("bottom",this.bottom()+"px")},n.prototype.exit=function(t,i){this.widget()&&(this.widget(null),this.render()),e.prototype.exit.apply(this,arguments)},n.prototype.click=function(t){console.log("Clicked: "+t.id)},n}),function(t,e){"function"==typeof define&&define.amd?define("layout/Tabbed.js",["d3","../common/HTMLWidget","../layout/Surface","../common/Text","css!./Tabbed"],e):t.layout_Tabbed=e(t.d3,t.common_HTMLWidget,t.layout_Surface,t.common_Text)}(this,function(t,e,i,o){function n(){e.call(this),this._tag="div"}return n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.prototype._class+=" layout_Tabbed",n.prototype.publish("showTabs",!0,"boolean","Show Tabs",null,{}),n.prototype.publish("surfacePadding",4,"number","Padding"),n.prototype.publish("activeTabIdx",0,"number","Index of active tab",null,{}),n.prototype.publish("labels",[],"array","Array of tab labels sharing an index with ",null,{tags:["Private"]}),n.prototype.publish("tabLocation","top","set","Position the tabs at the bottom of the widget",["top","bottom"],{tags:["Private"]}),n.prototype.publish("widgets",[],"widgetArray","widgets",null,{tags:["Private"]}),n.prototype.clearTabs=function(){return this.labels([]),this.widgets([]),this},n.prototype.addTab=function(t,e,n,s){var r=t.size();0===r.width&&0===r.height&&t.size({width:"100%",height:"100%"});var l=this.labels(),a=this.widgets();n&&this.activeTabIdx(this.widgets().length),l.push(e);var d=(new i).widget(t?t:(new o).text("No widget defined for tab"));return a.push(d),this.labels(l),this.widgets(a),s&&s(d),this},n.prototype.widgetSize=function(t){var e=this.clientWidth(),i=this.clientHeight(),o=this._tabContainer.node().getBoundingClientRect();return"undefined"!=typeof o.height&&(i-=o.height),{width:e,height:i}},n.prototype.enter=function(t,i){e.prototype.enter.apply(this,arguments),this._tabContainer=i.append("div"),this._contentContainer=i.append("div")},n.prototype.update=function(i,o){e.prototype.update.apply(this,arguments);var n=this;o.style("padding",this.surfacePadding_exists()?this.surfacePadding()+"px":null);var s=this._tabContainer.selectAll(".tab-button.id"+this.id()).data(this.showTabs()?this.labels():[],function(t){return t});s.enter().append("span").attr("class","tab-button id"+this.id()).style("cursor","pointer").on("click",function(t,e){n.click(n.widgets()[e].widget(),t,e),n.activeTabIdx(e).render()}),s.classed("active",function(t,e){return n.activeTabIdx()===e}).text(function(t){return t}),s.exit().remove();var r=this._contentContainer.selectAll(".tab-content.id"+this.id()).data(this.widgets(),function(t){return t.id()});switch(r.enter().append("div").attr("class","tab-content id"+this.id()).each(function(t,e){t.target(this)}),r.classed("active",function(t,e){return n.activeTabIdx()===e}).style("display",function(t,e){return n.activeTabIdx()===e?"block":"none"}).each(function(e,i){if(e.visible(n.activeTabIdx()===i),n.activeTabIdx()===i){var o=n.widgetSize(t.select(this));e.surfaceBorderWidth(n.showTabs()?null:0).surfacePadding(n.showTabs()?null:0).resize(o)}}),r.exit().each(function(t,e){t.target(null)}).remove(),this.tabLocation()){case"bottom":this._tabContainer.attr("class","on_bottom").style("top",this._contentContainer.node().offsetHeight+this.surfacePadding()+"px").style("position","absolute"),this._contentContainer.style("top",this.surfacePadding_exists()?this.surfacePadding()+"px":null).style("position","absolute");break;default:this._tabContainer.attr("class","on_top").style("top",null).style("position","relative"),this._contentContainer.style("top",this._tabContainer.node().offsetHeight+this.surfacePadding()+"px").style("position","absolute")}},n.prototype.click=function(t,e,i){},n}),function(t,e){"function"==typeof define&&define.amd?define("layout/Toolbar.js",["d3","../common/HTMLWidget","css!./Toolbar"],e):t.layout_Toolbar=e(t.d3,t.common_HTMLWidget)}(this,function(t,e){function i(){e.call(this),this._tag="div"}return i.prototype=Object.create(e.prototype),i.prototype.constructor=i,i.prototype._class+=" layout_Toolbar",i.prototype.publish("title","","string","Title",null,{tags:["Intermediate"]}),i.prototype.publish("fontSize",null,"number","Title Font Size (px)",null,{tags:["Advanced"],optional:!0}),i.prototype.publish("fontColor",null,"html-color","Title Font Color",null,{tags:["Advanced"],optional:!0}),i.prototype.publish("fontFamily",null,"string","Title Font Family",null,{tags:["Advanced"],optional:!0}),i.prototype.publish("fontBold",!0,"boolean","Enable Bold Title Font",null,{tags:["Advanced"],optional:!0}),i.prototype.publish("backgroundColor",null,"html-color","Background Color",null,{tags:["Intermediate"],optional:!0}),i.prototype.publish("responsive",!0,"boolean","Adapts to pixel width",null,{tags:["Basic"]}),i.prototype.publish("widgets",[],"widgetArray","Child widgets of the toolbar",null,{tags:["Basic"]}),i.prototype.publish("widgetClasses",[],"array","Array of Html Element classes to be assigned to the child widgets (shares index with widgets param)",null,{tags:["Basic"]}),i.prototype.enter=function(t,i){e.prototype.enter.apply(this,arguments)},i.prototype.update=function(i,o){e.prototype.update.apply(this,arguments);var n=this;o.attr("title",n.title()).style("background-color",this.backgroundColor());var s=o.selectAll("div.toolbar-title").data(this.title()?[this.title()]:[]);s.enter().append("div").classed("toolbar-title",!0).append("span"),s.selectAll("div.toolbar-title > span").style("font-size",this.fontSize_exists()?this.fontSize()+"px":null).style("color",this.fontColor_exists()?this.fontColor():null).style("font-family",this.fontFamily_exists()?this.fontFamily():null).style("font-weight",this.fontBold_exists()?this.fontBold()?"bold":"normal":null).style("background-color",this.backgroundColor_exists()?this.backgroundColor():null).text(n.title()),s.exit().remove();var r=o.selectAll("div.toolbar-child").data(null!==this.widgets()?this.widgets():[],function(t){return t.id()});r.enter().insert("div","div.toolbar-title").each(function(e,i){var o=n.widgetClasses()[i]?n.widgetClasses()[i]+" toolbar-child":"toolbar-child";t.select(this).classed(o,!0),e.target(this)}),r.exit().each(function(t){t.target(null)}).remove(),r.order()},i.prototype.render=function(t){var i=this;e.prototype.render.call(this,function(e){var o=i.element().node().getBoundingClientRect(),n=o.left+o.width;i.element().selectAll("div.toolbar-child").each(function(t,e){var i=this.getBoundingClientRect();n>i.left&&(n=i.left)}),i.element().select(".toolbar-title").style("width",n-o.left-4+"px"),t&&t(e)})},i.prototype.exit=function(t,i){e.prototype.exit.apply(this,arguments),this.widgets().forEach(function(t){t.target(null)})},i});