"function"==typeof define&&define.amd&&define("css",[],function(){return{load:function(t,e,n){n()}}}),function(t,e){"function"==typeof define&&define.amd?define("tree/CirclePacking.js",["d3","../common/SVGWidget","../api/ITree","../common/Text","../common/FAChar","css!./CirclePacking"],e):t.tree_CirclePacking=e(t.d3,t.common_SVGWidget,t.api_ITree,t.common_Text,t.common_FAChar)}(this,function(t,e,n,i,r){function o(t){e.call(this),n.call(this)}return o.prototype=Object.create(e.prototype),o.prototype.constructor=o,o.prototype._class+=" tree_CirclePacking",o.prototype["implements"](n.prototype),o.prototype.publish("paletteID","default","set","Palette ID",o.prototype._palette["switch"](),{tags:["Basic","Shared"]}),o.prototype.publish("useClonedPalette",!1,"boolean","Enable or disable using a cloned palette",null,{tags:["Intermediate","Shared"]}),o.prototype.enter=function(e,n){this.diameter=Math.min(this.width(),this.height()),this.pack=t.layout.pack().size([this.diameter-4,this.diameter-4]).value(function(t){return 1}),this.svg=n.append("g").attr("transform","rotate(30)")},o.prototype.update=function(e,n){var i=this;this._palette=this._palette["switch"](this.paletteID()),this.useClonedPalette()&&(this._palette=this._palette.cloneNotExists(this.paletteID()+"_"+this.id())),this.svg.selectAll("circle").remove(),this.svg.selectAll("text").remove();var r=this.data(),o=r,a=this.pack.nodes(r);this.circle=this.svg.selectAll("circle").data(a).enter().append("circle").attr("class",function(t){return t.parent?t.children?"node":"node leaf":"node root"}).style("fill",function(t){return i._palette(t.label)}).on("click",function(t){i.click(t)}).on("dblclick",function(e){o!==e&&i.zoom(e),t.event.stopPropagation()}),this.circle.append("title").text(function(t){return t.label}),this.svg.selectAll("text").data(a).enter().append("text").attr("class","label").style("fill-opacity",function(t){return t.parent===r?1:0}).style("display",function(t){return t.parent===r?null:"none"}).text(function(t){return t.label}),this.node=this.svg.selectAll("circle,text"),this.zoomTo([r.x,r.y,2*r.r])},o.prototype.zoom=function(e){var n=this,i=e;this.svg.selectAll("circle").filter(function(t){return t===i});var r=this.svg.selectAll("text").filter(function(t){return t!==i&&"inline"===this.style.display});r.transition().duration(500).style("opacity",0).each("end",function(e){e!==i&&t.select(this).style("display","none").style("opacity",1)});var o=this.svg.transition().duration(1e3).tween("zoom",function(e){var r=t.interpolateZoom(n.view,[i.x,i.y,2*i.r]);return function(t){n.zoomTo(r(t))}});o.selectAll("text").filter(function(t){return t.parent===i||"inline"===this.style.display}).style("fill-opacity",function(t){return t.parent===i?1:0}).each("start",function(t){t.parent===i&&(this.style.display="inline")}).each("end",function(t){t.parent!==i&&(this.style.display="none")})},o.prototype.zoomTo=function(t){var e=this.diameter/t[2];this.view=t,this.node.attr("transform",function(n){return"translate("+(n.x-t[0])*e+","+(n.y-t[1])*e+")rotate(-30)"}),this.circle.attr("r",function(t){return t.r*e})},o}),function(t,e){"function"==typeof define&&define.amd?define("tree/Dendrogram.js",["d3","../common/SVGZoomWidget","../common/PropertyExt","../api/ITree","css!./Dendrogram"],e):t.tree_Dendrogram=e(t.d3,t.common_SVGZoomWidget,t.common_PropertyExt,t.api_ITree)}(this,function(t,e,n,i){function r(t){n.call(this),this._owner=t}function o(n){e.call(this),i.call(this),this._drawStartPos="origin";var r=this;this._d3LayoutCluster=t.layout.cluster(),this._d3LayoutTree=t.layout.tree(),this._d3Diagonal=t.svg.diagonal().projection(function(t){return"horizontal"===r.orientation()?[t.y,t.x]:[t.x,t.y]}),this._d3DiagonalRadial=t.svg.diagonal.radial().projection(function(t){return[t.y,t.x/180*Math.PI]})}return r.prototype=Object.create(n.prototype),r.prototype.constructor=r,r.prototype._class+=" tree_Dendrogram.Column",r.prototype.publish("column",null,"set","Field",function(){return this._owner?this._owner.columns():[]},{optional:!0}),o.prototype=Object.create(e.prototype),o.prototype.constructor=o,o.prototype._class+=" tree_Dendrogram",o.prototype["implements"](i.prototype),o.prototype.Column=r,o.prototype.publish("paletteID","default","set","Palette ID",o.prototype._palette["switch"](),{tags:["Basic","Shared"]}),o.prototype.publish("useClonedPalette",!1,"boolean","Enable or disable using a cloned palette",null,{tags:["Intermediate","Shared"]}),o.prototype.publish("mappings",[],"propertyArray","Source Columns",null,{autoExpand:r}),o.prototype.publish("circleRadius",4.5,"number","Text offset from circle"),o.prototype.publish("separation",240,"number","Leaf Separation"),o.prototype.publish("dendrogram",!0,"boolean","Dendrogram"),o.prototype.publish("radial",!1,"boolean","Radial"),o.prototype.publish("orientation","horizontal","set","Orientation",["horizontal","vertical"],{tags:["Private"],disabled:function(){return this.radial()}}),o.prototype.dendrogramData=function(){function t(e){return{label:e.key,children:e.values.filter(function(t){return!(t instanceof Array)}).map(function(e){return t(e)})}}if(!this.mappings().filter(function(t){return t.column()}).length)return this.data();var e=this._db.rollupView(this.mappings().map(function(t){return t.column()})),n={key:"root",values:e.entries()};return t(n)},o.prototype.enter=function(t,n){e.prototype.enter.apply(this,arguments),this._renderElement.attr("opacity",0)},o.prototype.update=function(n,i,r){function o(t){return a.radial()?"rotate("+(t.x-90)+")translate("+t.y+")":"horizontal"===a.orientation()?"translate("+t.y+","+t.x+")":"translate("+t.x+","+t.y+")"}e.prototype.update.apply(this,arguments);var a=this;this._palette=this._palette["switch"](this.paletteID()),this.useClonedPalette()&&(this._palette=this._palette.cloneNotExists(this.paletteID()+"_"+this.id())),this._renderElement.transition().duration(500).attr("opacity",1),this._d3Layout=this.dendrogram()?this._d3LayoutCluster:this._d3LayoutTree,this.radial()?(this._d3Layout.size([360,2*this.separation()]),this._d3Layout.separation(function(t,e){return(t.parent===e.parent?1:2)/t.depth})):(this._d3Layout.nodeSize([14,this.separation()]),this._d3Layout.separation(function(t,e){return t.parent===e.parent?1:2}));var l=this.dendrogramData(),s=this._d3Layout.nodes(l),p=this._d3Layout.links(s),u=this._renderCount?500:0,c=this._renderElement.selectAll(".link").data(p);c.enter().append("path").attr("class","link").attr("d",this.radial()?this._d3DiagonalRadial:this._d3Diagonal),c.transition().duration(u).attr("d",this.radial()?this._d3DiagonalRadial:this._d3Diagonal),c.exit().remove();var h=this.circleRadius()+2,d=this._renderElement.selectAll(".node").data(s);d.transition().duration(u).attr("transform",o),d.enter().append("g").attr("class","node").attr("transform",o).on("click",function(t){a.click(t)}).each(function(e,n){var i=t.select(this);i.append("circle"),i.append("text")}),d.select("circle").attr("r",this.circleRadius()).style("fill",function(t){return a._palette(t.label)}).append("title").text(function(t){return t.label}),d.select("text").attr("dx",function(t){return a.radial()?t.children?t.x<180?-h:h:t.x<180?h:-h:"vertical"===a.orientation()?t.children?h:-h:t.children?-h:h}).attr("dy","0.25em").style("text-anchor",function(t){return a.radial()?t.children?t.x<180?"end":"start":t.x<180?"start":"end":"vertical"===a.orientation()?t.children?"start":"end":t.children?"end":"start"}).attr("transform",function(t){return a.radial()?t.x<180?null:"rotate(180)":"vertical"===a.orientation()?"rotate(-66)":null}).text(function(t){return t.label}),d.exit().remove(),this._renderCount||a.zoomToFit()},o}),function(t,e){"function"==typeof define&&define.amd?define("tree/SunburstPartition.js",["d3","../common/SVGWidget","../api/ITree","../common/Text","../common/FAChar","css!./SunburstPartition"],e):t.tree_SunburstPartition=e(t.d3,t.common_SVGWidget,t.api_ITree,t.common_Text,t.common_FAChar)}(this,function(t,e,n,i,r){function o(t){e.call(this),n.call(this)}return o.prototype=Object.create(e.prototype),o.prototype.constructor=o,o.prototype._class+=" tree_SunburstPartition",o.prototype["implements"](n.prototype),o.prototype.publish("paletteID","default","set","Palette ID",o.prototype._palette["switch"](),{tags:["Basic","Shared"]}),o.prototype.publish("useClonedPalette",!1,"boolean","Enable or disable using a cloned palette",null,{tags:["Intermediate","Shared"]}),o.prototype.root=function(t){return arguments.length?(this._root=t,this.svg&&this.svg.selectAll("path").transition().duration(750).attrTween("d",this.arcTweenFunc(this._root)),this):this._root||this.data()},o.prototype.data=function(){var t=e.prototype.data.apply(this,arguments);return arguments.length&&(this._resetRoot=!0),t},o.prototype.enter=function(e,n){var i=this;this.radius=Math.min(this.width(),this.height())/2,this._xScale=t.scale.linear().range([0,2*Math.PI]),this._yScale=t.scale.sqrt().range([0,this.radius]),this.partition=t.layout.partition().value(function(t){return void 0!==t.value?t.value:1}),this.arc=t.svg.arc().startAngle(function(t){return Math.max(0,Math.min(2*Math.PI,i._xScale(t.x)))}).endAngle(function(t){return Math.max(0,Math.min(2*Math.PI,i._xScale(t.x+t.dx)))}).innerRadius(function(t){return Math.max(0,i._yScale(t.y))}).outerRadius(function(t){return Math.max(0,i._yScale(t.y+t.dy))}),this.svg=n.append("g")},o.prototype.update=function(e,n){function i(e){t.event&&t.event.stopPropagation(),r.root(e)}var r=this;this._palette=this._palette["switch"](this.paletteID()),this.useClonedPalette()&&(this._palette=this._palette.cloneNotExists(this.paletteID()+"_"+this.id())),this.radius=Math.min(this.width(),this.height())/2,this._xScale.range([0,2*Math.PI]),this._yScale.range([0,this.radius]),this._dataNodes=this.partition.nodes(this.data());var o=this.svg.selectAll("path").data(this._dataNodes,function(t,e){return void 0!==t.id?t.id:e});o.enter().append("path").on("click",function(t){r.click(t)}).on("dblclick",i).append("title"),o.attr("d",this.arc).style("fill",function(t){return t.__viz_fill?t.__viz_fill:r._palette(t.label)}).style("stroke",function(t){return t.value>16?"white":"none"}).select("title").text(function(t){return t.label}),o.exit().remove(),this._resetRoot&&(this._resetRoot=!1,this.root(this._dataNodes[0]))},o.prototype.arcTweenFunc=function(e){var n=t.interpolate(this._xScale.domain(),[e.x,e.x+e.dx]),i=t.interpolate(this._yScale.domain(),[e.y,1]),r=t.interpolate(this._yScale.range(),[e.y?20:0,this.radius]),o=this;return function(t,e){return e?function(e){return o.arc(t)}:function(e){return o._xScale.domain(n(e)),o._yScale.domain(i(e)).range(r(e)),o.arc(t)}}},o}),function(t,e){"function"==typeof define&&define.amd?define("tree/Treemap.js",["d3","../common/HTMLWidget","../common/PropertyExt","../api/ITree","css!./Treemap"],e):t.tree_Treemap=e(t.d3,t.common_HTMLWidget,t.common_PropertyExt,t.api_ITree)}(this,function(t,e,n,i){function r(t){n.call(this),this._owner=t}function o(t){e.call(this),i.call(this)}return r.prototype=Object.create(n.prototype),r.prototype.constructor=r,r.prototype._class+=" tree_Dendrogram.Column",r.prototype.publish("column",null,"set","Field",function(){return this._owner?this._owner.columns():[]},{optional:!0}),o.prototype=Object.create(e.prototype),o.prototype.constructor=o,o.prototype._class+=" tree_Treemap",o.prototype["implements"](i.prototype),o.prototype.Column=r,o.prototype.publish("paletteID","default","set","Palette ID",o.prototype._palette["switch"](),{tags:["Basic","Shared"]}),o.prototype.publish("useClonedPalette",!1,"boolean","Enable or disable using a cloned palette",null,{tags:["Intermediate","Shared"]}),o.prototype.publish("mappings",[],"propertyArray","Source Columns",null,{autoExpand:r}),o.prototype.publish("aggrType",null,"set","Aggregation Type",[null,"mean","median","sum","min","max"],{optional:!0}),o.prototype.publish("aggrColumn",null,"set","Aggregation Field",function(){return this.columns()},{optional:!0,disable:function(t){return!t.aggrType()}}),o.prototype.publish("fontSize",null,"number","Font Size",null,{optional:!0}),o.prototype.publish("transitionDuration",250,"number","Transition Duration"),o.prototype.treemapData=function(){function t(e){if("number"==typeof e.values)return{label:e.key,size:e.values};var n=e.values.filter(function(t){return!(t instanceof Array)}).map(function(e){return t(e)}),i={label:e.key};return n.length?i.children=n:i.size=22,i}if(!this.mappings().filter(function(t){return t.column()}).length)return this.data();var e=this._db.aggregateView(this.mappings().map(function(t){return t.column()}),this.aggrType(),this.aggrColumn()),n={key:"root",values:e.entries()};return t(n)},o.prototype.enter=function(n,i){e.prototype.enter.apply(this,arguments),this._d3Treemap=t.layout.treemap().value(function(t){return t.size||50}),this._elementDIV=i.append("div")},o.prototype.update=function(t,n){function i(t){if(t.children)return null;for(var e=t.label+" ("+t.value+")";t.parent&&t.parent.parent;)e=t.parent.label+" -> "+e,t=t.parent;return e}function r(t){this.style("left",function(t){return t.x+Math.max(0,t.dx-1)/2+"px"}).style("top",function(t){return t.y+Math.max(0,t.dy-1)/2+"px"}).style("width",function(t){return"0px"}).style("height",function(t){return"0px"})}function o(){this.style("left",function(t){return t.x+"px"}).style("top",function(t){return t.y+"px"}).style("width",function(t){return Math.max(0,t.dx-1)+"px"}).style("height",function(t){return Math.max(0,t.dy-1)+"px"})}e.prototype.update.apply(this,arguments),this._palette=this._palette["switch"](this.paletteID()),this.useClonedPalette()&&(this._palette=this._palette.cloneNotExists(this.paletteID()+"_"+this.id()));var a=this._d3Treemap.size([this.width(),this.height()]).nodes(this.treemapData());this._elementDIV.style("font-size",this.fontSize_exists()?this.fontSize()+"px":null).style("line-height",this.fontSize_exists()?this.fontSize()+2+"px":null);var l=this,s=this._elementDIV.selectAll(".node").data(a);s.enter().append("div").attr("class","node").call(r),s.attr("title",i).text(function(t){return t.children?null:t.label}).style("background",function(t){return t.children?l._palette(t.label):null}).transition().duration(this.transitionDuration()).style("opacity",function(t){return t.children?1:null}).call(o),s.exit().transition().duration(this.transitionDuration()).style("opacity",0).remove()},o.prototype.exit=function(t,n){e.prototype.exit.apply(this,arguments)},o});