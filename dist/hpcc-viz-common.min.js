(function(e,t){typeof define=="function"&&define.amd?define("common/Class.js",[],t):e.common_Class=t()})(this,function(){function e(){}return e.prototype.constructor=e,e.prototype._class="common_Class",e.prototype.class=function(e){return arguments.length?(this._class=e,this):this._class},e.prototype.classID=function(){return this._class.split(" ").pop()},e.prototype.implements=function(e){for(var t in e)this[t]===undefined&&e.hasOwnProperty(t)&&(this[t]=e[t])},e.prototype.mixin=function(e){this.implements(e.prototype);for(var t in e.prototype)t==="_class"&&e.prototype.hasOwnProperty(t)&&(this[t]+=" "+e.prototype[t].split(" ").pop())},e}),function(e,t){typeof define=="function"&&define.amd?define("common/Platform.js",["d3","es6-promise"],t):(e.require=e.require||function(t,n){typeof t=="function"&&(n=t,t=[]);var r=t.map(function(t){var n=t.indexOf("src/")===0?"src/".length:0,r=t.substring(n).split("/").join("_");return e[r]});n.apply(null,r)},e.common_Platform=t(e.d3))}(this,function(e){function n(){}var t="1.10.12";return n.prototype.version=function(){return t},n.prototype.ieVersion=function(){var e=navigator.userAgent,t,n=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(t=/\brv[ :]+(\d+)/g.exec(e)||[],parseFloat(t[1])):/msie/i.test(n[1])?parseFloat(n[2]):null}(),n.prototype.isIE=n.prototype.ieVersion!==null,n.prototype.svgMarkerGlitch=n.prototype.isIE&&n.prototype.ieVersion<=12,n.prototype.MutationObserver=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver||function(e){this.callback=e,this.listeners=[];var t=function(e,t,n){this.callback=e,this.domNode=t,this.type=n};t.prototype={handleEvent:function(e){var t={type:this.type,target:this.domNode,addedNodes:[],removedNodes:[],previousSibling:e.target.previousSibling,nextSibling:e.target.nextSibling,attributeName:null,attributeNamespace:null,oldValue:null};this.callback([t])}},this.observe=function(e,n){var r=null;n.attributes&&(r=new t(this.callback,e,"attributes"),this.listeners.push(r),e.addEventListener("DOMAttrModified",r,!0)),n.characterData&&(r=new t(this.callback,e,"characterData"),this.listeners.push(r),e.addEventListener("DOMCharacterDataModified",r,!0)),n.childList&&(r=new t(this.callback,e,"childList"),this.listeners.push(r),e.addEventListener("DOMNodeInserted",r,!0),e.addEventListener("DOMNodeRemoved",r,!0))},this.disconnect=function(){this.listeners.forEach(function(e){switch(e.type){case"attributes":e.domNode.removeEventListener("DOMAttrModified",e,!0);break;case"characterData":e.domNode.removeEventListener("DOMCharacterDataModified",e,!0);break;case"childList":e.domNode.removeEventListener("DOMNodeRemoved",e,!0),e.domNode.removeEventListener("DOMNodeInserted",e,!0)}}),this.listeners=[]}},window.MutationObserver||(window.MutationObserver=n.prototype.MutationObserver),n.prototype._scrollBarWidth=null,n.prototype.getScrollbarWidth=function(){if(n.prototype._scrollBarWidth===null){var e=document.createElement("div");e.style.visibility="hidden",e.style.width="100px",e.style.msOverflowStyle="scrollbar",document.body.appendChild(e);var t=e.offsetWidth;e.style.overflow="scroll";var r=document.createElement("div");r.style.width="100%",e.appendChild(r);var i=r.offsetWidth;e.parentNode.removeChild(e),n.prototype._scrollBarWidth=t-i}return n.prototype._scrollBarWidth},n.prototype.debounce=function(e,t,n){return function(){function o(){n||e.apply(i,s),i.timeout=null}var i=this||{},s=arguments;i.timeout?clearTimeout(i.timeout):n&&e.apply(i,s),i.timeout=setTimeout(o,t||100)}},n}),function(e,t){typeof define=="function"&&define.amd?define("common/PropertyExt.js",["./Class"],t):e.common_PropertyExt=t(e.common_Class)}(this,function(e){function s(e){return e.indexOf(t)===0}function o(e,t){return e[n+t]}function u(e,t,n,r,i,s){s=s||{},this.id=e,this.type=n,this.origDefaultValue=t,this.defaultValue=s.optional&&t===null?undefined:t,this.description=r,this.set=i,this.ext=s;switch(n){case"set":this.checkedAssign=function(t){var r=typeof i=="function"?i.call(this):i;return(!r||r.indexOf(t)<0)&&console.error("Invalid value for '"+e+"':  "+t+" expected "+n),t};break;case"html-color":this.checkedAssign=function(t){if(window.__hpcc_debug&&t&&t!=="red"){var r="red",i=document.createElement("div");i.style.color=r,i.style.color=t,(i.style.color===r||i.style.color==="")&&console.error("Invalid value for '"+e+"':  "+t+" expected "+n)}return t};break;case"boolean":this.checkedAssign=function(e){return typeof e=="string"&&["false","off","0"].indexOf(e.toLowerCase())>=0?!1:Boolean(e)};break;case"number":this.checkedAssign=function(e){return Number(e)};break;case"string":this.checkedAssign=function(e){return String(e)};break;case"array":this.checkedAssign=function(t){return t instanceof Array||console.error("Invalid value for '"+e+"':  "+t+" expected "+n),t};break;case"object":this.checkedAssign=function(t){return t instanceof Object||console.error("Invalid value for '"+e+"':  "+t+" expected "+n),t};break;case"widget":this.checkedAssign=function(t){return(!t._class||t._class.indexOf("common_PropertyExt")<0)&&console.error("Invalid value for '"+e+"':  "+t+" expected "+n),t};break;case"widgetArray":this.checkedAssign=function(t){return t.some(function(e){return!e._class||e._class.indexOf("common_Widget")<0})&&console.error("Invalid value for '"+e+"':  "+t+" expected "+n),t};break;case"propertyArray":this.checkedAssign=function(t){return t.some(function(e){return!e.publishedProperties})&&console.log("Invalid value for '"+e+"':  "+t+" expected "+n),t};break;default:this.checkedAssign=function(t){return window.__hpcc_debug&&console.error("Unchecked property type for '"+e+"':  "+t+" expected "+n),t}}}function a(e,t,n,r,i){this.id=e,this.type="proxy",this.proxy=t,this.method=n,this.defaultValue=r,this.ext=i||{}}function l(){e.call(this),this._id="_pe"+ ++f,this._watchArr=[],this.publishedProperties(!0).forEach(function(e){switch(e.type){case"array":case"widgetArray":case"propertyArray":this[e.id+"_reset"]()}},this)}var t="__meta_",n="__private_",r="__prop_",i="__default_",f=0;return l.prototype=Object.create(e.prototype),l.prototype._class+=" common_PropertyExt",l.prototype.id=function(){return this._id},l.prototype.publishedProperties=function(e){var t=[];for(var n in this)s(n)&&(e||!o(this,n))&&t.push(this[n]);return t},l.prototype.publishedProperty=function(e){return this[t+e]},l.prototype.publishedModified=function(e){return this.publishedProperties().some(function(e){return this[e.id+"_modified"]()},this)},l.prototype.publishReset=function(e,r){e=(e||[]).map(function(e){return t+e}),r=(r||[]).map(function(e){return t+e});for(var i in this)if(s(i)){var o=!e.length||e.length&&e.indexOf(i)>=0,u=r.indexOf(i)>=0;o&&!u&&(this[n+i]=!0)}},l.prototype.publish=function(e,s,o,a,f,l){l=l||{};if(this[t+e]!==undefined&&!l.override)throw e+" is already published.";var c=this[t+e]=new u(e,s,o,a,f,l);c.ext.internal&&(this[n+e]=!0),this[e]=function(t){return arguments.length?(t===undefined?t=null:t===""&&c.ext.optional?t=null:t!==null&&(t=c.checkedAssign.call(this,t)),this.broadcast(e,t,this[r+e]),t===null?delete this[r+e]:this[r+e]=t,this):this[e+"_disabled"]()?this[e+"_default"]():this[r+e]!==undefined?this[r+e]:this[e+"_default"]()},this[e+"_disabled"]=function(){return l&&l.disable?l.disable(this):!1},this[e+"_modified"]=function(){return this[r+e]!==undefined},this[e+"_exists"]=function(){return this[r+e]!==undefined||this[e+"_default"]()!==undefined},this[e+"_default"]=function(t){return arguments.length?(t===""&&(t=null),t===null?delete this[i+e]:this[i+e]=t,this):this[i+e]!==undefined?this[i+e]:c.defaultValue},this[e+"_reset"]=function(){switch(o){case"widget":this[r+e]&&this[r+e].target(null);break;case"widgetArray":this[r+e]&&this[r+e].forEach(function(e){e.target(null)})}switch(o){case"array":case"widgetArray":case"propertyArray":this[i+e]=this[e+"_default"]().map(function(e){return e})}return delete this[r+e],this},this[e+"_options"]=function(){if(typeof f=="function"){var e=c.ext.optional?[null]:[];return e.concat(f.apply(this,arguments))}return f}},l.prototype.publishWidget=function(e,t,n){for(var i in t.prototype)if(i.indexOf("__meta")===0){var s=t.prototype[i];this.publishProxy(e+r+s.id,n,s.method||s.id)}},l.prototype.publishProxy=function(e,n,r,i){r=r||e;if(this[t+e]!==undefined)throw e+" is already published.";this[t+e]=new a(e,n,r,i),this[e]=function(t){return arguments.length?(i!==undefined&&t===i?this[n][r+"_reset"]():this[n][r](t),this):i===undefined||this[e+"_modified"]()?this[n][r]():i},this[e+"_disabled"]=function(){return this[n][r+"_disabled"]()},this[e+"_modified"]=function(){return this[n][r+"_modified"]()&&(i===undefined||this[n][r]()!==i)},this[e+"_exists"]=function(){return this[n][r+"_exists"]()},this[e+"_default"]=function(e){return arguments.length?(this[n][r+"_default"](e),this):this[n][r+"_default"]()},this[e+"_reset"]=function(){return this[n][r+"_reset"](),this},this[e+"_options"]=function(){return this[n][r+"_options"]()}},l.prototype._monitorProperty=function(e,t){var n=this,r=this._watchArr.push({propertyID:e,callback:t})-1;return{remove:function(){delete n._watchArr[r]}}},l.prototype.monitor=function(e){var t=this;return this._watchArr.length===0&&this.publishedProperties().forEach(function(e){switch(e.type){case"proxy":this[e.proxy]&&this[e.proxy]._monitorProperty(e.id,function(e,n,r){t.broadcast(e,n,r)})}},this),this._monitorProperty(undefined,e)},l.prototype.broadcast=function(e,t,n,r){r=r||this,this._watchArr.length&&t!==n&&this._watchArr.forEach(function(i){(i.propertyID===undefined||i.propertyID===e)&&i.callback&&setTimeout(function(){i.callback(e,t,n,r)},0)})},l.prototype.applyTheme=function(e){if(!e)return;var t=this._class.split(" ");for(var n in t)if(e[t[n]])for(var r in e[t[n]]){if(r==="overrideTags"&&e[t[n]][r]instanceof Object){for(var i in e[t[n]][r])this.publishedProperty(r).ext&&(this.publishedProperty(r).ext.tags=e[t[n]][r][i]);continue}this.publishedProperty(r)&&(this.publishedProperty(r).defaultValue=e[t[n]][r])}},l}),function(e,t){typeof define=="function"&&define.amd?define("common/Utility.js",["d3","require","es6-promise"],t):e.common_Utility=t(e.d3,e.require)}(this,function(e,t){function n(e,t,n,r,i){var s=/(^([+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?)?$|^0x[0-9a-f]+$|\d+)/gi,o=/(^[ ]*|[ ]*$)/g,u=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,a=/^0x[0-9a-f]+$/i,f=/^0/,l=function(e){return!i&&(""+e).toLowerCase()||""+e},c=l(r?e[r]:e).replace(o,"")||"",h=l(r?t[r]:t).replace(o,"")||"",p=c.replace(s,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),d=h.replace(s,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),v=parseInt(c.match(a),16)||p.length!==1&&c.match(u)&&Date.parse(c),m=parseInt(h.match(a),16)||v&&h.match(u)&&Date.parse(h)||null,g,y;if(m){if(v<m)return n==="ascending"?-1:1;if(v>m)return n==="ascending"?1:-1}for(var b=0,w=Math.max(p.length,d.length);b<w;b++){g=!(p[b]||"").match(f)&&parseFloat(p[b])||p[b]||0,y=!(d[b]||"").match(f)&&parseFloat(d[b])||d[b]||0;if(isNaN(g)!==isNaN(y))return isNaN(g)?1:-1;typeof g!=typeof y&&(g+="",y+="");if(g<y)return n==="ascending"?-1:1;if(g>y)return n==="ascending"?1:-1}return 0}function r(){this.items={}}function i(e,t){this._widgetElement=e,this._skipBringToTop=t}r.prototype.clear=function(){for(var e in this.items)this.items[e].element().classed("selected",!1);this.items={}},r.prototype.isEmpty=function(){for(var e in this.items)return!1;return!0},r.prototype.append=function(e){this.items[e._id]=e,e.element().classed("selected",!0)},r.prototype.remove=function(e){this.items[e._id].element().classed("selected",!1),delete this.items[e._id]},r.prototype.isSelected=function(e){return this.items[e._id]!==undefined},r.prototype.get=function(){var e=[];for(var t in this.items)e.push(this.items[t]);return e},r.prototype.set=function(e){this.clear(),e.forEach(function(e,t){this.append(e)},this)},r.prototype.click=function(e,t){t.ctrlKey?this.items[e._id]?this.remove(e):this.append(e):(this.clear(),this.append(e))},i.prototype.enter=function(t,n){var r=this;t.on("click.SimpleSelection",function(t,n){r._skipBringToTop||this.parentNode.appendChild(this);var i=e.select(this),s=i.classed("selected");r._widgetElement.selectAll(".selected").classed("selected",null),s||i.classed("selected",!0)}).on("mouseover.SimpleSelection",function(t,n){e.select(this).classed("over",!0)}).on("mouseout.SimpleSelection",function(t,n){e.select(this).classed("over",null)})},i.prototype.selected=function(t){return e.select(t).classed("selected")};var s=window.performance,o=s&&(s.now||s.mozNow||s.msNow||s.oNow||s.webkitNow);return{naturalSort:function(e,t,r,i){return e.slice(0).sort(function(e,s){return n(e,s,t,r,i)})},multiSort:function(t,n){return t.sort(function(t,r){for(var i=0;i<n.length;++i){var s=t[n[i].idx],o=r[n[i].idx];if(s!==o)return n[i].reverse?e.descending(s,o):e.ascending(s,o)}return 0}),t},Selection:r,SimpleSelection:i,urlParams:function(){var e=window.location.search.split("?")[1],t={};return e&&e.split("&").forEach(function(e,n){var r=e.split("=");switch(r.length){case 1:t[decodeURIComponent(r[0])]=undefined;break;case 2:t[decodeURIComponent(r[0])]=decodeURIComponent(r[1]);break;default:throw"Invalid URL Param:  "+e}}),t},endsWith:function(e,t,n){var r=e.toString();if(typeof n!="number"||!isFinite(n)||Math.floor(n)!==n||n>r.length)n=r.length;n-=t.length;var i=r.indexOf(t,n);return i!==-1&&i===n},d3ArrayAdapter:function(e){return{ownerDocument:{createElement:function(t){return{get __data__(){return this.row},set __data__(t){this.row=e[this.index]=t}}},createElementNS:function(e,t){return this.createElement(t)}},querySelectorAll:function(t){if(t)throw"unsupported";var n=this;return e.map(function(t,r){return{ownerDocument:n.ownerDocument,parentNode:n,get __data__(){return t},set __data__(t){e[r]=t}}})},appendChild:function(t){return t.parentNode=this,t.index=e.length,e.push(null),t},insertBefore:function(t,n){var r=e.indexOf(t.__data__),i=e.indexOf(n.__data__);return r>i?e.splice(i,0,e.splice(r,1)[0]):r<i-1&&e.splice(i-1,0,e.splice(r,1)[0]),t},removeChild:function(t){return e.splice(e.indexOf(t.__data__),1),t}}},downloadBlob:function(t,n,r){r=r||"data";var i=new Date,s=e.time.format("%Y-%m-%dT%H_%M_%S"),o=s(i),u=r+"_"+o+"."+t.toLowerCase(),a="";switch(t){case"TSV":a="text/tab-seperated-values";break;case"JSON":a="application/json";break;default:a="text/csv"}var f=document.createElement("a");if(navigator.msSaveBlob)return f=null,navigator.msSaveBlob(new Blob([n],{type:a}),u);if("download"in f)return f.href="data:"+a+","+encodeURIComponent(n),f.setAttribute("download",u),document.body.appendChild(f),setTimeout(function(){f.click(),document.body.removeChild(f)},10),!0;f=null;var l=document.createElement("iframe");return document.body.appendChild(l),l.src="data:"+a+","+encodeURIComponent(n),setTimeout(function(){document.body.removeChild(l)},100),!0},parseClassID:function(e){var t=e.split(".");return{path:"src/"+t[0].split("_").join("/"),memberWidgetID:t.length>1?t[1]:null}},requireWidget:function(e){var n=this;return new Promise(function(r,i){var s=n.parseClassID(e);t([s.path],function(e){r(s.memberWidgetID?e.prototype?e.prototype[s.memberWidgetID]:e[s.memberWidgetID]:e)})})},checksum:function(e){e instanceof Array&&(e=e.join("")+e.length);switch(typeof e){case"string":break;default:e=""+e}var t=305419896;for(var n=0,r=e.length;n<r;++n)t+=e.charCodeAt(n)*(n+1);return(t&4294967295).toString(16)},getTime:function(){return o&&o.call(s)||(new Date).getTime()}}}),function(e,t){typeof define=="function"&&define.amd?define("common/Database.js",["d3","./Class","./PropertyExt","./Utility"],t):e.common_Database=t(e.d3,e.common_Class,e.common_PropertyExt,e.common_Utility)}(this,function(e,t,n,r){function i(e,r){t.call(this),n.call(this),this._id=e||this._id,r=r||{},this.label(r.label||""),this.type(r.type||""),this.mask(r.mask||null),this.format(r.format||null)}function a(e){e=e||!1,t.call(this),n.call(this),this._dataChecksum=e,this._dataVersion=0,this.clear()}function l(t){this._grid=t,e.rebind(this,this._grid,"checksum","fields")}function c(e,t,n){l.call(this,e),t instanceof Array||(t=[t]),this._columnIndicies=t.filter(function(e){return e}).map(function(e){switch(typeof e){case"string":return this._grid.fieldByLabel(e).idx}return e},this),n=n||function(e){return e},this._rollup=n}function p(e,t){return e instanceof Array||(e=[e]),e.filter(function(e){return e!==""}).every(t)}function d(e){return typeof e=="boolean"}function v(e){return typeof e=="number"||!isNaN(e)}function m(e){return typeof e=="string"}function w(t,n){for(var r=0;r<t.length;++r){var i=e.time.format(t[r]).parse(n);if(i)return h=t[r],t[r]}return null}function E(e){return w(g,e)}function S(e){return w(y,e)}function x(e){return w(b,e)}function T(e){return["AL","AK","AZ","AR","CA","CO","CT","DE","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY","AS","DC","FM","GU","MH","MP","PW","PR","VI"].indexOf(String(e).toUpperCase())>=0}i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.prototype.mixin(n),i.prototype._class+=" common_Database.Field",i.prototype.id=function(){return this._id},i.prototype.checksum=function(){return r.checksum(this.label()+this.type()+this.mask()+this.format())},i.prototype.publish("label","","string","Label"),i.prototype.publish("type","","set","Type",["","string","number","boolean","time"]);var s=i.prototype.type;i.prototype.type=function(e){var t=s.apply(this,arguments);if(arguments.length)switch(this.type()){case"number":this._typeTransformer=function(e){return Number(e)};break;case"string":this._typeTransformer=function(e){return String(e)};break;case"boolean":this._typeTransformer=function(e){return typeof e=="string"&&["false","off","0"].indexOf(e.toLowerCase())>=0?!1:Boolean(e)};break;case"time":case"date":this._typeTransformer=function(e){return this._maskTransformer.parse(e)};break;default:this._typeTransformer=function(e){return e}}return t},i.prototype.publish("mask","","string","Time Mask");var o=i.prototype.mask;i.prototype.mask=function(e){var t=o.apply(this,arguments);return arguments.length&&(this._maskTransformer=this.formatter(e)),t},i.prototype.publish("format","","string","Format");var u=i.prototype.format;i.prototype.format=function(e){var t=u.apply(this,arguments);return arguments.length&&(this._formatTransformer=this.formatter(e)),t},i.prototype.parse=function(e){if(!e)return e;try{return this._typeTransformer(e)}catch(t){return console.log("Unable to parse:  "+e),null}},i.prototype.transform=function(e){if(!e)return e;try{return this._formatTransformer(this._typeTransformer(e))}catch(t){return console.log("Unable to transform:  "+e),null}},i.prototype.clone=function(){return new i(this._id,{label:this.label(),type:this.type(),mask:this.mask(),format:this.format()})},i.prototype.formatter=function(t){var n;if(!t)return n=function(e){return e},n.parse=function(e){return e},n;switch(this.type()){case"time":case"date":return e.time.format(t)}return n=e.format(t),n.parse=function(e){return e},n},a.prototype=Object.create(t.prototype),a.prototype.constructor=a,a.prototype.mixin(n),a.prototype._class+=" common_Database.Grid",a.prototype.publish("fields",[],"propertyArray","Fields"),a.prototype.clear=function(){return this.fields([]),this._data=[],this._dataChecksums=[],++this._dataVersion,this},a.prototype.legacyColumns=function(e){return arguments.length?(this.row(0,e),this):this.row(0)},a.prototype.legacyData=function(e,t){return a.prototype.data.apply(this,arguments)},a.prototype.field=function(e){return this.fields()[e]};var f=a.prototype.fields;a.prototype.fields=function(e,t){return arguments.length?f.call(this,t?e.map(function(e){return e.clone()}):e):f.apply(this,arguments)},a.prototype.fieldByLabel=function(e,t){return this.fields().filter(function(n,r){return n.idx=r,t?n.label().toLowerCase()===e.toLowerCase():n.label()===e})[0]},a.prototype.data=function(e,t){return arguments.length?(this._data=t?e.map(function(e){return e.map(function(e){return e})}):e,this._dataCalcChecksum(),this):this._data},a.prototype.parsedData=function(){var e=this;return this._data.map(function(t){return t.map(function(t,n){return e.fields()[n].parse(t)})})},a.prototype.formattedData=function(){var e=this;return this._data.map(function(t){return t.map(function(t,n){return e.fields()[n].transform(t)})})},a.prototype.fieldsChecksum=function(){return r.checksum(this.fields().map(function(e){return e.checksum()}))},a.prototype.dataChecksum=function(){return r.checksum(this._dataChecksum?this._dataChecksums:this._dataVersion)},a.prototype.checksum=function(){return r.checksum([this.dataChecksum(),this.fieldsChecksum()])},a.prototype._dataCalcChecksum=function(e){return++this._dataVersion,this._dataChecksum&&(arguments.length?this._dataChecksums[e]=r.checksum(this._data[e]):this._dataChecksums=this._data.map(function(e){return r.checksum(e)})),this},a.prototype.row=function(t,n){if(arguments.length<2)return t===0?this.fields().map(function(e){return e.label()}):this._data[t-1];if(t===0){var r=e.map(this.fields(),function(e){return e.label()});this.fields(n.map(function(e){return r.get(e)||(new i).label(e)},this))}else this._data[t-1]=n,this._dataCalcChecksum(t-1);return this},a.prototype.rows=function(e){return arguments.length?(this.row(0,e[0]),this._data=e.filter(function(e,t){return t>0}),this._dataCalcChecksum(),this):[this.row(0)].concat(this._data)},a.prototype.column=function(e,t){return arguments.length<2?[this.fields()[e].label()].concat(this._data.map(function(t,n){return t[e]})):(t.forEach(function(n,r){r===0?this.fields()[e]=(new i).label(t[0]):(this._data[r-1][e]=n,this._dataCalcChecksum(r-1))},this),this)},a.prototype.columnData=function(e,t){return arguments.length<2?this._data.map(function(t,n){return t[e]}):(t.forEach(function(t,n){this._data[n][e]=t,this._dataCalcChecksum(n)},this),this)},a.prototype.columns=function(e){return arguments.length?(e.forEach(function(t,n){this.column(n,e[n])},this),this):this.fields().map(function(e,t){return this.column(t)},this)},a.prototype.cell=function(e,t,n){return arguments.length<3?this.row(e)[t]:(e===0?this.fields()[t]=(new i).label(n):(this._data[e][t]=n,this._dataCalcChecksum(e)),this)},a.prototype.grid=function(e){return a.prototype.rows.apply(this,arguments)},a.prototype.hipieMapSortArray=function(e){return e.map(function(e){var t=!1;e.indexOf("-")===0&&(e=e.substring(1),t=!0);var n=this.fieldByLabel(e,!0);return n||console.log("Grid.prototype.hipieMapSortArray:  Invalid sort array - "+e),{idx:n?n.idx:-1,reverse:t}},this).filter(function(e){return e.idx>=0})},a.prototype.hipieMappings=function(t,n){function a(e,t,n,r){var i=n.map(function(e){return e});i[t]=e.key,e.values instanceof Array?e.values.forEach(function(e){a(e,t+1,i,r)}):(i[t+1]=e.values,r.push(i))}n=n||"";if(!this.fields().length||!this._data.length)return[];var r=-1,i=[],s=[],o=-1,u=[];t.forEach(function(e,t){if(e instanceof Object)switch(e.function){case"SUM":case"AVE":case"MIN":case"MAX":r>=0&&console.log("Rollup field already exists - there should only be one?"),r=t,e.params.forEach(function(e){var t=this.fieldByLabel(e.param1,!0);t?i.push(t.idx):console.log("Grid.prototype.hipieMappings:  Invalid rollup field - "+e.param1)},this);break;case"SCALE":o>=0&&console.log("Scale field already exists - there should only be one?"),o=t,e.params.forEach(function(e){var t=this.fieldByLabel(e.param1,!0);if(!t)console.log("Grid.prototype.hipieMappings:  Invalid scale field - "+e.param1);else{var n=t.idx,r=e.param2;u.push(function(e){return e[n]/r})}},this);break;default:console.log("Unknown field function - "+e.function)}else if(e.indexOf("_AVE")===e.length-4&&this.fieldByLabel(e.substring(0,e.length-4)+"_SUM",!0)&&this.fieldByLabel("base_count",!0)){console.log("Deprecated - Symposium AVE Hack");var a=this.fieldByLabel(e.substring(0,e.length-4)+"_SUM",!0),f=this.fieldByLabel("base_count",!0);s.push(a.idx),u.push(function(e){return e[a.idx]/e[f.idx]})}else{var l=this.fieldByLabel(e,!0);l?(s.push(l.idx),u.push(function(e){return e[l.idx]})):(console.log("Unable to locate '"+e+"' in server response."),u.push(function(e){return n}))}},this);if(r>=0){var f=t[r],l=[];for(var c in f.params)l.push(f.params[c]);var h=this.rollup(s,function(t){switch(f.function){case"SUM":return e.sum(t,function(e){return e[i[0]]});case"AVE":return e.mean(t,function(e){return e[i[0]]});case"MIN":return e.min(t,function(e){return e[i[0]]});case"MAX":return e.max(t,function(e){return e[i[0]]})}return console.log("Unsupported Mapping Function:  "+f.function),0}),p=[];return h instanceof Array?h.forEach(function(e){a(e,0,[],p)}):p.push([h]),p}return this._data.map(function(e){var t=[];return u.forEach(function(n){t.push(n(e))}),t})},l.prototype.constructor=l,l.prototype.grid=function(){return this._grid},l.prototype.columns=function(e){return arguments.length?(this._grid.legacyColumns(e),this):this._grid.legacyColumns()},l.prototype.rawData=function(e){return arguments.length?(this._grid.legacyData(e),this):this._grid.legacyData()},l.prototype.formattedData=function(){return this._formattedDataChecksum!==this._grid.checksum()&&(this._formattedDataChecksum=this._grid.checksum(),this._formattedData=this._grid.formattedData()),this._formattedData},l.prototype.parsedData=function(){return this._parsedDataChecksum!==this._grid.checksum()&&(this._parsedDataChecksum=this._grid.checksum(),this._parsedData=this._grid.parsedData()),this._parsedData},l.prototype._whichData=function(e){if(e){if(e.parsed)return this.formattedData();if(e.formatted)return this.formattedData()}return this.rawData()},l.prototype.data=function(e){return l.prototype.rawData.apply(this,arguments)},c.prototype=Object.create(l.prototype),c.prototype.constructor=c,c.prototype.nest=function(){if(this._nestChecksum!==this._grid.checksum()){this._nestChecksum=this._grid.checksum();var t=e.nest();this._columnIndicies.forEach(function(e){t.key(function(t){return t[e]})}),this._nest=t.rollup(this._rollup)}return this._nest},c.prototype.entries=function(e){return this.nest().entries(this._whichData(e))},c.prototype.map=function(e){return this.nest().map(this._whichData(e))},c.prototype.d3Map=function(t){return this.nest().map(this._whichData(t),e.map)},c.prototype._walkData=function(e,t){t=t||[];var n=[];return e.forEach(function(e){e instanceof Array?n.push(t.concat([e])):n=n.concat(this._walkData(e.values,t.concat([e.key])))},this),n},c.prototype.data=function(e){return this._walkData(this.entries(e))},a.prototype.legacyView=function(){return new l(this)},a.prototype.nestView=function(e){return new c(this,e)},a.prototype.rollupView=function(e,t){return new c(this,e,t)},a.prototype.aggregateView=function(t,n,r,i){var s=this;return new c(this,t,function(t){switch(n){case null:case undefined:case"":return t.aggregate=t.length,t;default:var o=s.legacyColumns(),u=o.indexOf(r),a=o.indexOf(i);return t.aggregate=e[n](t,function(e){return(+e[u]-(a>=0?+e[a]:0))/(a>=0?+e[a]:1)}),t}})},a.prototype._nest=function(t,n){t instanceof Array||(t=[t]);var r=e.nest();return t.forEach(function(e){r.key(function(t){return t[e]})}),r},a.prototype.nest=function(e){return this._nest(e).entries(this._data)},a.prototype.rollup=function(e,t){return this._nest(e).rollup(t).entries(this._data)},a.prototype.length=function(){return this._data.length+1},a.prototype.width=function(){return this.fields().length},a.prototype.pivot=function(){return this.rows(this.columns()),this},a.prototype.clone=function(e){return(new a).fields(this.fields(),e).data(this.data(),e)},a.prototype.filter=function(e){var t={};return this.row(0).forEach(function(e,n){t[e]=n}),(new a).fields(this.fields(),!0).data(this.data().filter(function(n){for(var r in e)if(e[r]!==n[t[r]])return!1;return!0}))};var h=null;a.prototype.analyse=function(e){e instanceof Array||(e=[e]);var t=[];return e.forEach(function(e){var n=this.rollup(e,function(e){return e.length});t.push(n);var r=n.map(function(e){return e.key});this.fields()[e].isBoolean=p(r,d),this.fields()[e].isNumber=p(r,v),this.fields()[e].isString=!this.fields()[e].isNumber&&p(r,m),this.fields()[e].isUSState=this.fields()[e].isString&&p(r,T),this.fields()[e].isDateTime=this.fields()[e].isString&&p(r,E),this.fields()[e].isDateTimeFormat=h,this.fields()[e].isDate=!this.fields()[e].isDateTime&&p(r,S),this.fields()[e].isDateFormat=h,this.fields()[e].isTime=this.fields()[e].isString&&!this.fields()[e].isDateTime&&!this.fields()[e].isDate&&p(r,x),this.fields()[e].isTimeFormat=h},this),t},a.prototype.jsonObj=function(e){return arguments.length?(this.clear(),this.data(e.map(function(e,t){var n=[];for(var r in e){var s=this.row(0).indexOf(r);s<0&&(s=this.fields().length,this.fields().push((new i).label(r))),n[s]=e[r]}return n},this)),this):this._data.map(function(e){var t={};return this.row(0).forEach(function(n,r){t[n]=e[r]}),t},this)},a.prototype.json=function(e){return arguments.length?(this.jsonObj(JSON.parse(e)),this):JSON.stringify(this.jsonObj(),null,"  ")},a.prototype.csv=function(t){return arguments.length?(this.jsonObj(e.csv.parse(t)),this):e.csv.formatRows(this.grid())},a.prototype.tsv=function(t){return arguments.length?(this.jsonObj(e.tsv.parse(t)),this):e.tsv.formatRows(this.grid())};var g=[],y=["%Y-%m-%d","%Y%m%d"],b=["%H:%M:%S.%LZ","%H:%M:%SZ","%H:%M:%S"];return y.forEach(function(e){b.forEach(function(t){g.push(e+"T"+t)})}),{Field:i,Grid:a}}),function(e,t){typeof define=="function"&&define.amd?define("common/Widget.js",["d3","./Class","./Platform","./PropertyExt","./Database"],t):e.common_Widget=t(e.d3,e.common_Class,e.common_Platform,e.common_PropertyExt,e.common_Database)}(this,function(e,t,n,r,i){function o(){t.call(this),n.call(this),r.call(this),this._class=Object.getPrototypeOf(this)._class,this._id=this._idSeed+s++,this._db=new i.Grid,this._pos={x:0,y:0},this._size={width:0,height:0},this._scale=1,this._visible=!0,this._target=null,this._parentElement=null,this._parentWidget=null,this._element=e.select(),this._renderCount=0,window.__hpcc_debug&&(window.g_all===undefined&&(window.g_all={}),window.g_all[this._id]=this),window.__hpcc_theme&&this.applyTheme(window.__hpcc_theme)}var s=0;return o.prototype=Object.create(t.prototype),o.prototype.constructor=o,o.prototype.mixin(n),o.prototype.mixin(r),o.prototype._class+=" common_Widget",o.prototype._idSeed="_w",o.prototype.publishProxy("fields","_db","fields"),o.prototype.publish("classed",{},"object","HTML Classes",null,{tags:["Private"]}),o.prototype.export=function(e){switch(e){case"TSV":return this._db.tsv();case"JSON":return this._db.json()}return this._db.csv()},o.prototype.leakCheck=function(e){var t=this,n=[e],r=new this.MutationObserver(function(e){var i=!1;e.forEach(function(e){for(var s=0;s<e.removedNodes.length;++s){var o=e.removedNodes.item(s);n.indexOf(o)>=0&&t._target&&(i=!0,r.disconnect())}}),i&&console.log("leak:  "+t.id()+" - "+t.classID()+"		widget.target(null); was not called for this widget before it was removed from the page.")}),i=e.parentNode;while(i)r.observe(i,{childList:!0}),n.push(i),i=i.parentNode},o.prototype.on=function(t,n,r){if(this[t]===undefined)throw"Method:  "+t+" does not exist.";var i=this[t];return this[t]=function(){r?e.event&&e.event.stopPropagation():i.apply(this,arguments),n.apply(this,arguments)},this},o.prototype.id=function(e){return arguments.length?(this._id=e,this):this._id},o.prototype.columns=function(e){return arguments.length?(this._db.legacyColumns(e),this):this._db.legacyColumns()},o.prototype.parsedData=function(){return this._db.parsedData()},o.prototype.formattedData=function(){return this._db.formattedData()},o.prototype.data=function(e){return arguments.length?(this._db.legacyData(e),this):this._db.legacyData()},o.prototype.cloneData=function(){return this.data().map(function(e){return e.slice(0)})},o.prototype.flattenData=function(){var e=[];return this.data().forEach(function(t,n){this.columns().filter(function(e,t){return t>0}).forEach(function(r,i){var s=t[i+1];if(s){var o={rowIdx:n,colIdx:i+1,label:t[0],value:s};e.push(o)}},this)},this),e},o.prototype.rowToObj=function(e){var t={};return this.columns().forEach(function(n,r){t[n]=e[r]}),e.length===this.columns().length+1&&(t.__lparam=e[this.columns().length]),t},o.prototype.pos=function(e){return arguments.length?(this._pos=e,this._overlayElement&&this._overlayElement.attr("transform","translate("+e.x+","+e.y+")scale("+this._scale+")"),this):this._pos},o.prototype.x=function(e){return arguments.length?(this.pos({x:e,y:this._pos.y}),this):this._pos.x},o.prototype.y=function(e){return arguments.length?(this.pos({x:this._pos.x,y:e}),this):this._pos.y},o.prototype.size=function(e){return arguments.length?(this._size=e,this._overlayElement&&this._overlayElement.attr("width",e.width).attr("height",e.height),this):this._size},o.prototype.width=function(e){return arguments.length?(this.size({width:e,height:this._size.height}),this):this._size.width},o.prototype.height=function(e){return arguments.length?(this.size({width:this._size.width,height:e}),this):this._size.height},o.prototype.resize=function(e,t){t=t||{width:0,height:0};var n,r;if(e&&e.width&&e.height)n=e.width,r=e.height;else{var i=window.getComputedStyle(this._target,null);n=parseFloat(i.getPropertyValue("width"))-t.width,r=parseFloat(i.getPropertyValue("height"))-t.height}return this.size({width:n,height:r}),this},o.prototype.scale=function(e){return arguments.length?(this._scale=e,this._overlayElement&&this._overlayElement.attr("transform","translate("+e.x+","+e.y+")scale("+this._scale+")"),this):this._scale},o.prototype.visible=function(e){return arguments.length?(this._visible=e,this._parentElement&&this._parentElement.style({visibility:this._visible?null:"hidden",opacity:this._visible?null:0}),this):this._visible},o.prototype.display=function(e){return arguments.length?(this._display=e,this._element&&this._element.style("display",this._display?null:"none"),this):this._display},o.prototype.calcSnap=function(e){function t(e,t){function n(e,t){var n=e%t;return Math.abs(n)>t-Math.abs(n)&&(n=(t-Math.abs(n))*(n<0?1:-1)),n}return e-n(e,t)}var n=t(this._pos.x-this._size.width/2,e),r=t(this._pos.y-this._size.height/2,e),i=t(this._pos.x+this._size.width/2,e),s=t(this._pos.y+this._size.height/2,e),o=i-n,u=s-r;return[{x:n+o/2,y:r+u/2},{width:o,height:u}]},o.prototype.toWidget=function(t){if(!t)return null;var n=e.select(t);if(n){var r=n.datum();if(r&&r instanceof o)return r}return null},o.prototype.locateParentWidget=function(e){e=e||this._target.parentNode;var t=this.toWidget(e);return t?t:this.locateParentWidget(e.parentNode)},o.prototype.locateSVGNode=function(e){return e?e.tagName==="svg"?e:this.locateSVGNode(e.parentNode):null},o.prototype.locateOverlayNode=function(){var e=this.locateParentWidget(this._target);while(e){if(e._parentOverlay)return e._parentOverlay;e=this.locateParentWidget(e._target.parentNode)}return null},o.prototype.getAbsolutePos=function(e,t,n){var r=this.locateSVGNode(e);if(!r)return null;var i=r.createSVGPoint(),s=e.getCTM();i=i.matrixTransform(s);var o={x:i.x,y:i.y};if(t!==undefined&&n!==undefined){var u=r.createSVGPoint();u.x=t,u.y=n,u=u.matrixTransform(s),o.width=u.x-i.x,o.height=u.y-i.y}return o},o.prototype.hasOverlay=function(){return this._overlayElement},o.prototype.syncOverlay=function(){if(this._size.width&&this._size.height){var e=this.getAbsolutePos(this._overlayElement.node(),this._size.width,this._size.height);if(e&&(this.oldPos===null||this.oldPos===undefined||e.x!==this.oldPos.x||e.y!==this.oldPos.y||e.width!==this.oldPos.width||e.height!==this.oldPos.height)){var t=e.width/this._size.width,n=e.height/this._size.height;this._parentElement.style({left:e.x-e.width/t/2+"px",top:e.y-e.height/n/2+"px",width:e.width/t+"px",height:e.height/n+"px"});var r="scale("+t+","+n+")";this._parentElement.style("transform",r).style("-moz-transform",r).style("-ms-transform",r).style("-webkit-transform",r).style("-o-transform",r)}this.oldPos=e}},o.prototype.element=function(){return this._element},o.prototype.node=function(){return this._element.node()},o.prototype.render=function(t){if(window.__hpcc_debug){var n=Date.now();n-this._prevNow<500&&console.log("Double Render:  "+(n-this._prevNow)+" - "+this.id()+" - "+this.classID()),this._prevNow=n}t=t||function(){};if(!this.visible())return t(this),this;if(this._parentElement){if(!this._tag)throw"No DOM tag specified";var r=this._parentElement.selectAll("#"+this._id).data([this],function(e){return e._id});r.enter().append(this._tag).classed(this._class,!0).attr("id",this._id).each(function(t){t._element=e.select(this),t.enter(this,t._element),window.__hpcc_debug&&t.leakCheck(this)}),r.classed(this.classed()).each(function(e){e.preUpdate(this,e._element),e.update(this,e._element),e.postUpdate(this,e._element)}),r.exit().each(function(t){e.select(this).datum(null),t.exit(this,t._element)}).remove(),this._renderCount++}var i=[];this.publishedProperties(!0).forEach(function(e){if(!e.ext||e.ext.render!==!1)switch(e.type){case"widget":var t=this[e.id]();t&&i.push(this[e.id]());break;case"widgetArray":i=i.concat(this[e.id]())}},this);var s=this;switch(i.length){case 0:t(this);break;case 1:i[0].render(function(){t(s)});break;default:var o=i.length;i.forEach(function(e,n){setTimeout(function(){e.render(function(){--o===0&&t(s)})},0)})}return this},o.prototype.lazyRender=o.prototype.debounce(function(){this.render()},100),o.prototype.enter=function(e,t){},o.prototype.preUpdate=function(e,t){},o.prototype.update=function(e,t){},o.prototype.postUpdate=function(e,t){},o.prototype.exit=function(e,t){},o}),function(e,t){typeof define=="function"&&define.amd?define("common/CanvasWidget.js",["d3","./Widget"],t):e.common_CanvasWidget=t(e.d3,e.common_Widget)}(this,function(e,t){function n(){t.call(this),this._tag="canvas"}return n.prototype=Object.create(t.prototype),n.prototype.constructor=n,n.prototype._class+=" common_CanvasWidget",n.prototype.resize=function(e){var n=t.prototype.resize.apply(this,arguments);return this._parentElement.style("width",this._size.width+"px").style("height",this._size.height+"px"),this._element.attr("width",this._size.width),this._element.attr("height",this._size.height),n},n.prototype.target=function(t){if(!arguments.length)return this._target;if(this._target&&t)throw"Target can only be assigned once.";this._target=t;if(typeof this._target=="string"||this._target instanceof String)this._target=document.getElementById(this._target);if(this._target){this._parentElement=e.select(this._target);if(!this._size.width&&!this._size.height){var n=parseFloat(this._parentElement.style("width")),r=parseFloat(this._parentElement.style("height"));this.size({width:n,height:r}),this.resize(this._size)}}else this.exit();return this},n.prototype.exit=function(){this._parentElement&&this._parentElement.remove(),t.prototype.exit.apply(this,arguments)},n}),function(e,t){typeof define=="function"&&define.amd?define("common/Transition.js",[],t):e.common_Transition=t()}(this,function(){function e(e){this._widget=e,this._duration=250,this._delay=0,this._ease="cubic-in-out"}return e.prototype.duration=function(e){return arguments.length?(this._duration=e,this._widget):this._duration},e.prototype.delay=function(e){return arguments.length?(this._delay=e,this._widget):this._delay},e.prototype.ease=function(e){return arguments.length?(this._ease=e,this._widget):this._ease},e.prototype.apply=function(e){return this._duration||this._delay?e.transition().duration(this._duration).delay(this._delay).ease(this._ease):e},e}),function(e,t){typeof define=="function"&&define.amd?define("common/SVGWidget.js",["d3","./Widget","./Transition"],t):e.common_SVGWidget=t(e.d3,e.common_Widget,e.common_Transition)}(this,function(e,t,n){function r(){t.call(this),this._tag="g",this._boundingBox=null,this.transition=new n(this),this._drawStartPos="center"}r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.prototype._class+=" common_SVGWidget",r.prototype.move=function(e,t){var n=this.pos.apply(this,arguments);return arguments.length&&(t?this._element.transition().duration(t):this._element).attr("transform","translate("+e.x+" "+e.y+")"),n},r.prototype.size=function(e){var n=t.prototype.size.apply(this,arguments);return arguments.length&&(this._boundingBox=null),n},r.prototype.resize=function(e){var n=t.prototype.resize.apply(this,arguments);if(this._parentRelativeDiv){this._parentRelativeDiv.style({width:this._size.width+"px",height:this._size.height+"px"});switch(this._drawStartPos){case"origin":this.pos({x:0,y:0});break;case"center":default:this.pos({x:this._size.width/2,y:this._size.height/2})}}return this._parentElement.attr("width",this._size.width).attr("height",this._size.height),n},r.prototype.target=function(t){if(!arguments.length)return this._target;if(this._target&&t&&this._target.__data__.id!==t.__data__.id)throw"Target can only be assigned once.";this._target=t;if(typeof this._target=="string"||this._target instanceof String)this._target=document.getElementById(this._target);if(this._target instanceof SVGElement){this._parentElement=e.select(this._target),this._parentWidget=this._parentElement.datum();if(!this._parentWidget||this._parentWidget._id===this._id)this._parentWidget=this.locateParentWidget(this._target.parentNode);this._parentOverlay=this.locateOverlayNode()}else this._target?(this._parentRelativeDiv=e.select(this._target).append("div").style({position:"relative"}),this._parentElement=this._parentRelativeDiv.append("svg").style({position:"absolute",top:0,left:0}),this._parentOverlay=this._parentRelativeDiv.append("div").style({position:"absolute",top:0,left:0}),this.resize(this._size)):this.exit();return this},r.prototype.enter=function(e,n){t.prototype.enter.apply(this,arguments)},r.prototype.update=function(e,n){t.prototype.update.apply(this,arguments)},r.prototype.postUpdate=function(e,n){t.prototype.postUpdate.apply(this,arguments),this._drawStartPos==="origin"&&this._target instanceof SVGElement?this._element.attr("transform","translate("+(this._pos.x-this._size.width/2)+","+(this._pos.y-this._size.height/2)+")scale("+this._scale+")"):this._element.attr("transform","translate("+this._pos.x+","+this._pos.y+")scale("+this._scale+")")},r.prototype.exit=function(e,n){this._parentRelativeDiv&&(this._parentOverlay.remove(),this._parentElement.remove(),this._parentRelativeDiv.remove()),t.prototype.exit.apply(this,arguments)},r.prototype.getOffsetPos=function(){var e={x:0,y:0};return this._parentWidget?(e=this._parentWidget.getOffsetPos(),e.x+=this._pos.x,e.y+=this._pos.y,e):e},r.prototype.getBBox=function(e,t){if(e||this._boundingBox===null){var n=this._element.node();n instanceof SVGElement&&(this._boundingBox=n.getBBox())}return this._boundingBox===null?{x:0,y:0,width:0,height:0}:{x:(t?Math.round(this._boundingBox.x):this._boundingBox.x)*this._scale,y:(t?Math.round(this._boundingBox.y):this._boundingBox.y)*this._scale,width:(t?Math.round(this._boundingBox.width):this._boundingBox.width)*this._scale,height:(t?Math.round(this._boundingBox.height):this._boundingBox.height)*this._scale}},r.prototype.intersection=function(e,t){return this.intersectRect(e,t)};var i=function(e,t,n){return{x:e.x+(t.x-e.x)*n,y:e.y+(t.y-e.y)*n}},s=function(e,t,n,r){var i={type:"",points:[]},s=(r.x-n.x)*(e.y-n.y)-(r.y-n.y)*(e.x-n.x),o=(t.x-e.x)*(e.y-n.y)-(t.y-e.y)*(e.x-n.x),u=(r.y-n.y)*(t.x-e.x)-(r.x-n.x)*(t.y-e.y);if(u!==0){var a=s/u,f=o/u;0<=a&&a<=1&&0<=f&&f<=1?(i.type="Intersection",i.points.push({x:e.x+a*(t.x-e.x),y:e.y+a*(t.y-e.y)})):i.type="No Intersection"}else s===0||o===0?i.type="Coincident":i.type="Parallel";return i};r.prototype.intersectRect=function(e,t){var n=this.getOffsetPos(),r=this.getBBox();if(e.x===t.x&&e.y===t.y)return e;var i={x:n.x-r.width/2,y:n.y-r.height/2},o={x:n.x+r.width/2,y:n.y-r.height/2},u={x:n.x+r.width/2,y:n.y+r.height/2},a={x:n.x-r.width/2,y:n.y+r.height/2},f=s(i,o,e,t);return f.points.length?{x:f.points[0].x,y:f.points[0].y}:(f=s(o,u,e,t),f.points.length?{x:f.points[0].x,y:f.points[0].y}:(f=s(u,a,e,t),f.points.length?{x:f.points[0].x,y:f.points[0].y}:(f=s(a,i,e,t),f.points.length?{x:f.points[0].x,y:f.points[0].y}:null)))};var o=function(e,t,n,r){var s={type:"",points:[]},o=(r.x-n.x)*(r.x-n.x)+(r.y-n.y)*(r.y-n.y),u=2*((r.x-n.x)*(n.x-e.x)+(r.y-n.y)*(n.y-e.y)),a=e.x*e.x+e.y*e.y+n.x*n.x+n.y*n.y-2*(e.x*n.x+e.y*n.y)-t*t,f=u*u-4*o*a;if(f<0)s.type="Outside";else if(f===0)s.type="Tangent";else{var l=Math.sqrt(f),c=(-u+l)/(2*o),h=(-u-l)/(2*o);(c<0||c>1)&&(h<0||h>1)?c<0&&h<0||c>1&&h>1?s.type="Outside":s.type="Inside":(s.type="Intersection",0<=c&&c<=1&&s.points.push(i(n,r,c)),0<=h&&h<=1&&s.points.push(i(n,r,h)))}return s};return r.prototype.intersectCircle=function(e,t){var n=this.getOffsetPos(),r=this.radius(),i=o(n,r,e,t);return i.points.length?{x:i.points[0].x,y:i.points[0].y}:null},r.prototype.distance=function(e,t){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y))},r.prototype._pushMarkers=function(e,t){this.svgMarkerGlitch&&(e=e||this._element,e.selectAll("path[marker-start],path[marker-end]").attr("fixme-start",function(e){return this.getAttribute("marker-start")}).attr("fixme-end",function(e){return this.getAttribute("marker-end")}).attr("marker-start",null).attr("marker-end",null))},r.prototype._popMarkers=function(e,t){this.svgMarkerGlitch&&(e=e||this._element,e.selectAll("path[fixme-start],path[fixme-end]").attr("marker-start",function(e){return this.getAttribute("fixme-start")}).attr("marker-end",function(e){return this.getAttribute("fixme-end")}).attr("fixme-start",null).attr("fixme-end",null))},r.prototype._popMarkersDebounced=t.prototype.debounce(function(e,t){this.svgMarkerGlitch&&this._popMarkers(e,t)},250),r.prototype._fixIEMarkers=function(e,t){this.svgMarkerGlitch&&(this._pushMarkers(e,t),this._popMarkersDebounced(e,t))},r}),typeof define=="function"&&define.amd&&define("css",[],function(){return{load:function(e,t,n){n()}}}),function(e,t){typeof define=="function"&&define.amd?define("common/Text.js",["./SVGWidget","css!./Text"],t):e.common_Text=t(e.common_SVGWidget)}(this,function(e){function t(){e.call(this)}return t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.prototype._class+=" common_Text",t.prototype.publish("text","","string","Display Text",null,{tags:["Basic"]}),t.prototype.publish("fontFamily",null,"string","Font Family",null,{tags:["Intermediate"],optional:!0}),t.prototype.publish("fontSize",null,"number","Font Size (px)",null,{tags:["Intermediate"]}),t.prototype.publish("anchor","middle","set","Anchor Position",["start","middle","end"],{tags:["Intermediate"]}),t.prototype.publish("colorFill",null,"html-color","Fill Color",null,{tags:["Basic"]}),t.prototype.publish("rotation",0,"number","Degrees of rotation",null,{tags:["Basic"]}),t.prototype.enter=function(t,n){e.prototype.enter.apply(this,arguments),this._textElement=n.append("text")},t.prototype.update=function(t,n){e.prototype.update.apply(this,arguments);var r=this;this._textElement.attr("font-family",this.fontFamily()).attr("font-size",this.fontSize());var i=this.text().split("\n"),s=this._textElement.selectAll("tspan").data(i);s.enter().append("tspan").attr("class",function(e,t){return"tspan_"+t}).attr("dy","1em").attr("x","0"),s.style("fill",this.colorFill()).text(function(e){return e}),s.exit().remove();var o={width:0,height:0};try{o=this._textElement.node().getBBox()}catch(u){}var a=-(o.x+o.width/2),f=-(o.y+o.height/2);switch(this.anchor()){case"start":a=-o.x+o.width/2;break;case"end":a=o.x+o.width/2}var l=-this.rotation()*Math.PI/180;a=-1*Math.abs(a*Math.cos(l)+f*Math.sin(l)),f=-1*Math.abs(a*Math.sin(l)+f*Math.cos(l)),this._textElement.style("text-anchor",this.anchor()).attr("transform",function(e){return"translate("+a+","+f+")rotate("+r.rotation()+")"})},t}),function(e,t){typeof define=="function"&&define.amd?define("common/FAChar",["./SVGWidget","./Text","css!font-awesome","css!./FAChar"],t):e.common_FAChar=t(e.common_SVGWidget,e.common_Text)}(this,function(e,t){function n(){e.call(this),this._text=(new t).fontFamily("FontAwesome")}return n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.prototype._class+=" common_FAChar",n.prototype.publish("char","","string","Font Awesome Item",null,{tags:["Private"]}),n.prototype.publish("fontSize",null,"number","Font Size",null,{tags:["Private"]}),n.prototype.publishProxy("text_colorFill","_text","colorFill"),n.prototype.enter=function(t,n){e.prototype.enter.apply(this,arguments),this._text.target(t)},n.prototype.update=function(t,n){e.prototype.update.apply(this,arguments),this._text.text(this.char()).scale((this.fontSize()||14)/14).render()},n.prototype.exit=function(t,n){this._text.target(null),e.prototype.exit.apply(this,arguments)},n}),function(e,t){typeof define=="function"&&define.amd?define("common/HTMLWidget.js",["d3","./Widget","./Transition"],t):e.common_HTMLWidget=t(e.d3,e.common_Widget,e.common_Transition)}(this,function(e,t,n){function r(){t.call(this),this._drawStartPos="origin",this._tag="div",this._boundingBox=null}return r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.prototype._class+=" common_HTMLWidget",r.prototype.calcFrameWidth=function(e){var t=parseFloat(e.style("padding-left"))+parseFloat(e.style("padding-right"))+parseFloat(e.style("margin-left"))+parseFloat(e.style("margin-right"))+parseFloat(e.style("border-left-width"))+parseFloat(e.style("border-right-width"));return t},r.prototype.calcWidth=function(e){return parseFloat(e.style("width"))-this.calcFrameWidth(e)},r.prototype.calcFrameHeight=function(e){var t=parseFloat(e.style("padding-top"))+parseFloat(e.style("padding-bottom"))+parseFloat(e.style("margin-top"))+parseFloat(e.style("margin-bottom"))+parseFloat(e.style("border-top-width"))+parseFloat(e.style("border-bottom-width"));return t},r.prototype.calcHeight=function(e){return parseFloat(e.style("height"))+this.calcFrameHeight(e)},r.prototype.hasHScroll=function(e){return e=e||this._element,e.property("scrollWidth")>e.property("clientWidth")},r.prototype.hasVScroll=function(e){return e=e||this._element,e.property("scrollHeight")>e.property("clientHeight")},r.prototype.clientWidth=function(){return this._size.width-this.calcFrameWidth(this._element)},r.prototype.clientHeight=function(){return this._size.height-this.calcFrameHeight(this._element)},r.prototype.getBBox=function(e,t){if(e||this._boundingBox===null){var n=this._element.node()?this._element.node().firstElementChild:null;if(n instanceof Element){var r=n.getBoundingClientRect();this._boundingBox={x:r.left,y:r.top,width:r.width,height:r.height}}}return this._boundingBox===null?{x:0,y:0,width:0,height:0}:{x:(t?Math.round(this._boundingBox.x):this._boundingBox.x)*this._scale,y:(t?Math.round(this._boundingBox.y):this._boundingBox.y)*this._scale,width:(t?Math.round(this._boundingBox.width):this._boundingBox.width)*this._scale,height:(t?Math.round(this._boundingBox.height):this._boundingBox.height)*this._scale}},r.prototype.resize=function(e){var n=t.prototype.resize.apply(this,arguments);return this._parentElement.style("width",this._size.width+"px").style("height",this._size.height+"px"),n},r.prototype.target=function(t){if(!arguments.length)return this._target;if(this._target&&t)throw"Target can only be assigned once.";this._target=t;if(typeof this._target=="string"||this._target instanceof String)this._target=document.getElementById(this._target);if(this._target instanceof SVGElement){var n=this.locateOverlayNode();this._parentElement=n.append("div").style({position:"absolute",top:0,left:0,overflow:"hidden"}),this._overlayElement=e.select(this._target);var r=this;this.oldPos=null,this.observer=new this.MutationObserver(function(e){r.syncOverlay()});var i=this._overlayElement.node();while(i)this.observer.observe(i,{attributes:!0}),i=i.parentNode}else if(this._target){this._parentElement=e.select(this._target);if(!this._size.width&&!this._size.height){var s=parseFloat(this._parentElement.style("width")),o=parseFloat(this._parentElement.style("height"));this.size({width:s,height:o})}this._parentElement=e.select(this._target).append("div")}else this.exit();return this},r.prototype.postUpdate=function(e,n){t.prototype.postUpdate.apply(this,arguments);if(this._drawStartPos==="origin")this._element.style({position:"relative",left:this._pos.x+"px",top:this._pos.y+"px"});else{var r=this.getBBox(!0);this._element.style({position:"relative","float":"left",left:this._pos.x+(this._size.width-r.width)/2+"px",top:this._pos.y+(this._size.height-r.height)/2+"px"})}},r.prototype.exit=function(e,n){this.observer&&this.observer.disconnect(),this.oldPos=null,this._parentElement&&this._parentElement.remove(),t.prototype.exit.apply(this,arguments)},r}),function(e,t){typeof define=="function"&&define.amd?define("common/Shape.js",["d3","./SVGWidget","css!./Shape"],t):e.common_Shape=t(e.d3,e.common_SVGWidget)}(this,function(e,t){function n(){t.call(this)}return n.prototype=Object.create(t.prototype),n.prototype.constructor=n,n.prototype._class+=" common_Shape",n.prototype.publish("shape","circle","set","Shape Type",["circle","square","rect","ellipse"],{tags:["Private"]}),n.prototype.publish("width",24,"number","Width",null,{tags:["Private"]}),n.prototype.publish("height",24,"number","Height",null,{tags:["Private"]}),n.prototype.publish("colorStroke",null,"html-color","Stroke Color",null,{tags:["Private"]}),n.prototype.publish("colorFill",null,"html-color","Fill Color",null,{tags:["Private"]}),n.prototype.publish("radius",null,"number","Radius",null,{tags:["Private"]}),n.prototype.publish("tooltip","","string","Tooltip",null,{tags:["Private"]}),n.prototype._origRadius=n.prototype.radius,n.prototype.radius=function(e){var t=n.prototype._origRadius.apply(this,arguments);return arguments.length?(this.width(e),this.height(e),t):Math.max(this.width(),this.height())/2},n.prototype.intersection=function(e,n){switch(this.shape()){case"circle":return this.intersectCircle(e,n)}return t.prototype.intersection.apply(this,arguments)},n.prototype.update=function(t,n){var r=n.selectAll("rect,circle,ellipse").data([this.shape()],function(e){return e}),i=this;r.enter().append(this.shape()==="square"?"rect":this.shape()).attr("class","common_Shape").each(function(t){var n=e.select(this);i._tooltipElement=n.append("title")}),r.style("fill",this.colorFill()).style("stroke",this.colorStroke()).each(function(t){var n=e.select(this);i._tooltipElement.text(i.tooltip());switch(i.shape()){case"circle":var r=i.radius();n.attr("r",r);break;case"square":var s=Math.max(i.width(),i.height());n.attr("x",-s/2).attr("y",-s/2).attr("width",s).attr("height",s);break;case"rect":n.attr("x",-i.width()/2).attr("y",-i.height()/2).attr("width",i.width()).attr("height",i.height());break;case"ellipse":n.attr("rx",i.width()/2).attr("ry",i.height()/2)}}),r.exit().remove()},n}),function(e,t){typeof define=="function"&&define.amd?define("common/Icon",["./SVGWidget","./Shape","./FAChar","css!./Icon"],t):e.common_Icon=t(e.common_SVGWidget,e.common_Shape,e.common_FAChar)}(this,function(e,t,n){function r(){e.call(this),this._shapeWidget=new t,this._faChar=new n}return r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.prototype._class+=" common_Icon",r.prototype.publish("shape","circle","set","Shape Type",["circle","square"],{tags:["Private"]}),r.prototype.publishProxy("faChar","_faChar","char"),r.prototype.publishProxy("image_colorFill","_faChar","text_colorFill"),r.prototype.publish("tooltip","","string","Tooltip",null,{tags:["Private"]}),r.prototype.publish("diameter",24,"number","Diameter",null,{tags:["Private"]}),r.prototype.publish("paddingPercent",45,"number","Padding Percent",null,{tags:["Private"]}),r.prototype.publishProxy("shape_colorFill","_shapeWidget","colorFill"),r.prototype.publishProxy("shape_colorStroke","_shapeWidget","colorStroke"),r.prototype.intersection=function(e,t){return this._shapeWidget.intersection(e,t)},r.prototype.enter=function(t,n){e.prototype.enter.apply(this,arguments),this._shapeWidget.target(t).render(),this._faChar.target(t).render(),this._tooltipElement=n.append("title");var r=this;n.on("click",function(e){r.click(e)})},r.prototype.click=function(e){console.log("Clicked the icon")},r.prototype.update=function(t,n){e.prototype.update.apply(this,arguments),this._faChar.fontSize(this.diameter()*(100-this.paddingPercent())/100).render(),this._shapeWidget.shape(this.shape()).width(this.diameter()).height(this.diameter()).render(),this._tooltipElement.text(this.tooltip())},r.prototype.exit=function(t,n){e.prototype.exit.apply(this,arguments),this._shapeWidget.target(null),this._faChar.target(null)},r}),function(e,t){typeof define=="function"&&define.amd?define("common/IList",[],t):e.common_IList=t()}(this,function(){function e(){}return e.prototype.click=function(e){console.log("Click:  "+e)},e}),function(e,t){typeof define=="function"&&define.amd?define("common/IMenu",[],t):e.common_IMenu=t()}(this,function(){function e(){}return e.prototype.click=function(e){console.log("Click:  "+e)},e.prototype.preShowMenu=function(){console.log("preShowMenu")},e.prototype.postHideMenu=function(e){console.log("postHideMenu")},e}),function(e,t){typeof define=="function"&&define.amd?define("common/TextBox.js",["./SVGWidget","./Shape","./Text","css!./TextBox"],t):e.common_TextBox=t(e.common_SVGWidget,e.common_Shape,e.common_Text)}(this,function(e,t,n){function r(){e.call(this),this._shape=(new t).shape("rect"),this._text=new n}return r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.prototype._class+=" common_TextBox",r.prototype.publishProxy("text","_text"),r.prototype.publishProxy("shape_colorStroke","_shape","colorStroke"),r.prototype.publishProxy("shape_colorFill","_shape","colorFill"),r.prototype.publishProxy("text_colorFill","_text","colorFill"),r.prototype.publish("paddingLeft",4,"number","Padding:  Left",null,{tags:["Private"]}),r.prototype.publish("paddingRight",4,"number","Padding:  Right",null,{tags:["Private"]}),r.prototype.publish("paddingTop",4,"number","Padding:  Top",null,{tags:["Private"]}),r.prototype.publish("paddingBottom",4,"number","Padding:  Bottom",null,{tags:["Private"]}),r.prototype.publishProxy("anchor","_text"),r.prototype.publish("fixedSize",null),r.prototype.publish("tooltip","","string","Tooltip",null,{tags:["Private"]}),r.prototype.padding=function(e){return this.paddingLeft(e),this.paddingRight(e),this.paddingTop(e),this.paddingBottom(e),this},r.prototype.enter=function(t,n){e.prototype.enter.apply(this,arguments),this._tooltipElement=n.append("title"),this._shape.target(t).render(),this._text.target(t).render()},r.prototype.update=function(t,n){e.prototype.update.apply(this,arguments),this._tooltipElement.text(this.tooltip()),this._text.render();var r=this._text.getBBox(!0),i={width:this.fixedSize()?this.fixedSize().width:r.width+this.paddingLeft()+this.paddingRight(),height:this.fixedSize()?this.fixedSize().height:r.height+this.paddingTop()+this.paddingBottom()};this._shape.width(i.width).height(i.height).render();if(this.fixedSize())switch(this.anchor()){case"start":this._text.x(-this.fixedSize().width/2+r.width/2+(this.paddingLeft()+this.paddingRight())/2).render();break;case"end":this._text.x(this.fixedSize().width/2-r.width/2-(this.paddingLeft()+this.paddingRight())/2).render()}},r.prototype.exit=function(t,n){this._shape.target(null),this._text.target(null),e.prototype.exit.apply(this,arguments)},r}),function(e,t){typeof define=="function"&&define.amd?define("common/List",["d3","../common/SVGWidget","./IList","../common/TextBox","css!./List"],t):e.common_List=t(e.d3,e.common_SVGWidget,e.common_IList,e.common_TextBox)}(this,function(e,t,n,r){function i(e){t.call(this),n.call(this),this._listWidgets={}}return i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.prototype._class+=" common_List",i.prototype.implements(n.prototype),i.prototype.publish("anchor","start","set","Anchor Position",["","start","middle","end"],{tags:["Private"]}),i.prototype.update=function(e,n){t.prototype.update.apply(this,arguments);var i=this,s=n.selectAll(".line").data(this.data(),function(e){return e});s.enter().append("g").attr("class","line").each(function(e){var t=(new r).target(this).paddingTop(0).paddingBottom(0).paddingLeft(8).paddingRight(8).text(e).render();t.element().on("click",function(e){i.click(e.text())}),i._listWidgets[e]=t});var o=0,u=0,a=0;for(var f in this._listWidgets){if(!this._listWidgets.hasOwnProperty(f))continue;var l=this._listWidgets[f].getBBox();o+=l.height,u<l.width&&(u=l.width),++a}var c=-o/2;s.each(function(e){var t=i._listWidgets[e],n=t.getBBox();t.pos({x:0,y:c+n.height/2}).anchor(i.anchor()).fixedSize({width:u,height:n.height}).render(),c+=n.height}),s.exit().remove().each(function(e){i._listWidgets[e].target(null),delete i._listWidgets[e]})},i.prototype.exit=function(e,n){for(var r in this._listWidgets)this._listWidgets[r].target(null);t.prototype.exit.apply(this,arguments)},i}),function(e,t){typeof define=="function"&&define.amd?define("common/Menu",["d3","./SVGWidget","./IMenu","./Icon","./List","css!./Menu"],t):e.common_Menu=t(e.d3,e.common_SVGWidget,e.common_IMenu,e.common_Icon,e.common_List)}(this,function(e,t,n,r,i){function s(){t.call(this),n.call(this),this._icon=(new r).shape("square").diameter(14),this._list=new i;var s=this;this._list.click=function(t){e.event.stopPropagation(),s.hideMenu(),s.click(t)},this._open=!1}return s.prototype=Object.create(t.prototype),s.prototype.constructor=s,s.prototype._class+=" common_Menu",s.prototype.implements(n.prototype),s.prototype.publishProxy("faChar","_icon",null,""),s.prototype.publishProxy("paddingPercent","_icon",null,10),s.prototype.toggleMenu=function(){this._open?this.hideMenu():this.showMenu()},s.prototype.showMenu=function(){this.preShowMenu(),this._open=!0,this._list.data(this.data()).render();var t=this._icon.getBBox(!0),n=this._list.getBBox(!0),r={x:t.width/2-n.width/2,y:t.height/2+n.height/2};this._list.move(r);var i=this;e.select("body").on("click."+this._id,function(){console.log("click:  body - "+i._id),i._open&&i.hideMenu()})},s.prototype.hideMenu=function(){e.select("body").on("click."+this._id,null),this._open=!1,this._list.data([]).render(),this.postHideMenu()},s.prototype.enter=function(n,r){t.prototype.enter.apply(this,arguments),this._icon.target(n).render(),this._list.target(n).render();var i=this;this._icon.element().on("click",function(t){e.event.stopPropagation(),i.toggleMenu()})},s.prototype.update=function(e,n){t.prototype.update.apply(this,arguments),n.classed("disabled",this.data().length===0),this._icon.faChar(this.faChar()).paddingPercent(this.paddingPercent()).render()},s.prototype.exit=function(e,n){this._icon.target(null),this._list.target(null),t.prototype.exit.apply(this,arguments)},s}),function(e,t){typeof define=="function"&&define.amd?define("common/Palette.js",["d3","colorbrewer"],t):e.common_Palette=t(e.d3)}(this,function(e){function s(e,t){if(!e)return o();var n=i[e];return n||(n=o(e,t),i[e]=n),n}function o(u,a){function p(e){return f(e)}if(!u)return["default"].concat(t.concat(n).concat(r));var f=null;if(a)f=e.scale.ordinal().range(a);else{if(t.indexOf(u)>=0)f=new e.scale[u];else if(r.indexOf(u)>=0){var l=[];switch(u){case"hpcc10":var c=o("default").colors();l=c.filter(function(e,t){return t%2?!0:!1});break;case"hpcc20":l=o("category10").colors().concat(o("hpcc10").colors())}f=e.scale.ordinal().range(l)}else if(n.indexOf(u)>0){var h=12;while(h>0){if(colorbrewer[u][h]){f=e.scale.ordinal().range(colorbrewer[u][h]);break}--h}}f||(f=e.scale.category20()),a=f.range()}return p.type=function(){return"ordinal"},p.id=function(e){return arguments.length?(u=e,p):u},p.colors=function(e){return arguments.length?(a=e,p):a},p.clone=function(e){return i[e]=o(e,this.colors()),i[e]},p.cloneNotExists=function(e){return i[e]?i[e]:this.clone(e)},p.switch=function(e,t){return u===e?this:arguments.length?s(e,t):s()},p}function a(e,t,n){if(!e)return f();var r=u[e];return r||(r=f(e,t,n),u[e]=r),r}function f(t,r,i){function d(e,t,n){return t===n?l.domain([t-1,n+1])(e):l.domain([t,n])(e)}if(!arguments.length){var s=["default"];for(var o in colorbrewer)n.indexOf(o)===-1&&s.push(o);return s}var l=null,c=r,h=function(t,n){n=n||32;var r=Math.ceil(n/(t.length-1)),i=[],s=null;return t.forEach(function(t){if(s){var n=e.scale.linear().domain([0,r]).range([s,t]).interpolate(e.interpolateLab);for(var o=0;o<r;++o)i.push(n(o))}s=t}),l=e.scale.quantize().domain([0,100]).range(i),l};if(r)l=h(r,i);else{if(colorbrewer[t]){var p=12;while(p>0){if(colorbrewer[t][p]){l=h(colorbrewer[t][p]);break}--p}}l||(l=h(colorbrewer.RdYlGn[11])),c=l.range()}return d.type=function(){return"rainbow"},d.id=function(e){return arguments.length?(t=e,d):t},d.colors=function(e){return arguments.length?(c=e,d):c},d.clone=function(e){return u[e]=f(e,this.color()),u[e]},d.cloneNotExists=function(e){return u[e]?u[e]:this.clone(e)},d.switch=function(e,n){return t===e?this:arguments.length?a(e,n):a()},d}var t=["category10","category20","category20b","category20c"],n=["Accent","Dark2","Paired","Pastel1","Pastel2","Set1","Set2","Set3"],r=["hpcc10","hpcc20"],i={},u={},l=function(t,n,r,i,s){e.select(t).selectAll(".palette").data(o(),function(e){return e}).enter().append("span").attr("class","palette").attr("title",function(e){return e}).on("click",function(t){console.log(e.values(t.value).map(JSON.stringify).join("\n"))}).selectAll(".swatch").data(function(e){return o(e).colors()}).enter().append("span").attr("class","swatch").style("background-color",function(e){return e}),e.select(n).selectAll(".palette").data(f(),function(e){return e}).enter().append("span").attr("class","palette").attr("title",function(e){return e}).on("click",function(t){console.log(e.values(t.value).map(JSON.stringify).join("\n"))}).selectAll(".swatch2").data(function(e){return f(e).colors()}).enter().append("span").attr("class","swatch2").style("height","8px").style("background-color",function(e){return e});var u={id:i.join("_")+s,scale:f("custom",i,s)};e.select(r).selectAll(".palette").data([u],function(e){return e.id}).enter().append("span").attr("class","palette").attr("title",function(e){return"aaa"}).on("click",function(t){console.log(e.values(t.value).map(JSON.stringify).join("\n"))}).selectAll(".swatch2").data(function(e){var t=[];for(var n=0;n<=255;++n)t.push(u.scale(n,0,255));return t}).enter().append("span").attr("class","swatch2").style("background-color",function(e){return e})};return colorbrewer.RdWhGr={3:["red","white","green"]},{ordinal:s,rainbow:a,test:l}}),function(e,t){typeof define=="function"&&define.amd?define("common/Surface.js",["d3","./SVGWidget","./Icon","./Shape","./Text","./FAChar","./Menu","css!./Surface"],t):e.common_Surface=t(e.d3,e.common_SVGWidget,e.common_Icon,e.common_Shape,e.common_Text,e.common_FAChar,e.common_Menu)}(this,function(e,t,n,r,i,s,o){function u(){t.call(this),this._icon=(new n).faChar("").paddingPercent(50),this._container=(new r).class("container").shape("rect"),this._titleRect=(new r).class("title").shape("rect"),this._text=(new i).class("title"),this._menu=(new o).paddingPercent(0);var e=this;this._menu.preShowMenu=function(){e.content()&&e.content().hasOverlay()&&e.content().visible(!1)},this._menu.postHideMenu=function(){e.content()&&e.content().hasOverlay()&&e.content().visible(!0)},this._surfaceButtons=[]}return u.prototype=Object.create(t.prototype),u.prototype.constructor=u,u.prototype._class+=" common_Surface",u.prototype.publish("showTitle",!0,"boolean","Show Title",null,{tags:["Basic"]}),u.prototype.publish("title","","string","Title",null,{tags:["Basic"]}),u.prototype.publishProxy("titleFontSize","_text","fontSize"),u.prototype.publish("showIcon",!0,"boolean","Show Title",null,{tags:["Advanced"]}),u.prototype.publishProxy("icon_faChar","_icon","faChar"),u.prototype.publishProxy("icon_shape","_icon","shape"),u.prototype.publish("content",null,"widget","Content",null,{tags:["Private"]}),u.prototype.publish("buttonAnnotations",[],"array","Button Array",null,{tags:["Intermediate"]}),u.prototype.publish("buttonGutter",25,"number","Space Between Menu and Buttons",null,{tags:["Intermediate"]}),u.prototype.publish("showContent",!0,"boolean","Show Content",null,{tags:["Intermediate"]}),u.prototype.publish("menu",[],"array","Menu List Data",null,{tags:["Intermediate"]}),u.prototype.publish("menuPadding",2,"number","Menu Padding",null,{tags:["Advanced"]}),u.prototype._origMenuParam=u.prototype.menu,u.prototype.menu=function(e){return u.prototype._origMenuParam.apply(this,arguments),arguments.length?(this._menu.data(e),this):this._menu.data()},u.prototype._origShowContent=u.prototype.showContent,u.prototype.showContent=function(e){var t=u.prototype._origShowContent.apply(this,arguments);return arguments.length&&this.content()&&this.content().visible(this.showContent()),t},u.prototype.enter=function(n,r){t.prototype.enter.apply(this,arguments);var i=r.append("g").attr("class","frame"),s=i.node();this._clipRect=i.append("defs").append("clipPath").attr("id",this.id()+"_clip").append("rect").attr("x",0).attr("y",0).attr("width",this._size.width).attr("height",this._size.height),this._titleRect.target(s).render().display(this.showTitle()&&this.showIcon()),this._icon.target(s).render(),this._menu.target(n),this._text.target(s),this._container.target(s),this.buttonContainer=e.select(this._target).append("div").attr("class","svg-button-container")},u.prototype.update=function(n,r){t.prototype.update.apply(this,arguments);var i=this,s=this.width()-1,o=this.height()-1;this._icon.display(this.showTitle()&&this.showIcon()).shape(this.icon_shape()).render(),this._menu.render(),this._text.text(this.title()).display(this.showTitle()).render();var u=this.buttonContainer.selectAll(".surface-button").data(this.buttonAnnotations());u.enter().append("button").attr("class","surface-button").each(function(t,n){var r=i._surfaceButtons[n]=e.select(this).attr("class","surface-button "+(t.class?t.class:"")).attr("id",t.id).style("padding",t.padding).style("width",t.width).style("height",t.height).style("cursor","pointer").on("click",function(e){i.click(e)});t.font==="FontAwesome"?r.append("i").attr("class","fa").text(function(e){return t.label}):r.text(function(e){return t.label})}),u.exit().each(function(t,n){var r=e.select(this);delete i._surfaceButtons[n],r.remove()});var a=this.showTitle()?Math.max.apply(null,this._surfaceButtons.map(function(e){return e.node().offsetHeight})):0,f=this.showTitle()&&this.showIcon()?this._icon.getBBox(!0):{width:0,height:0},l=this._text.getBBox(!0),c=this._menu.getBBox(!0),h=Math.max(f.height,l.height,c.height,a),p=this.showTitle()?h:0,d=(-o+h)/2,v=this.showTitle()?Math.max(l.height,c.height,a):0,m=p<=v?0:(p-v)/2,g=m;this._titleRect.pos({x:g,y:d}).width(s-g*2).height(v).display(this.showTitle()).render(),this._icon.move({x:-s/2+f.width/2,y:d}),this._menu.move({x:s/2-c.width/2-this.menuPadding(),y:d}),this._text.move({x:(f.width/2-c.width/2)/2,y:d});var y=i._titleRect.node().getBoundingClientRect().left+(i._size.width-g*2)-i.buttonGutter()-this.buttonContainer.node().offsetWidth,b=i._titleRect.node().getBoundingClientRect().top+(v-this.buttonContainer.node().offsetHeight)/2;isNaN(y)||this.buttonContainer.style("left",y+"px"),isNaN(b)||this.buttonContainer.style("top",b+"px"),this.showTitle()?this._container.pos({x:g/2,y:p/2-m/2}).width(s-g).height(o-p+m).render():this._container.pos({x:0,y:0}).width(s).height(o).render();if(this.showContent()){var w=g,E=p-m,S=r.selectAll(".content").data(this.content()?[this.content()]:[],function(e){return e._id});S.enter().append("g").attr("class","content").attr("clip-path","url(#"+this.id()+"_clip)").each(function(e){e.target(this)}),S.attr("transform","translate("+g/2+", "+(p/2-m/2)+")").each(function(e){var t={left:0,top:0,right:1,bottom:1};e.resize({width:s-w-(t.left+t.right),height:o-E-(t.top+t.bottom)})}),this.content()&&this._clipRect.attr("x",-(s-w)/2).attr("y",-(o-E)/2).attr("width",s-w).attr("height",o-E),S.exit().transition().each(function(e){e.target(null)}).remove()}this._menu.element()&&this._menu.element().node()&&this._menu.element().node().parentNode&&this._menu.element().node().parentNode.appendChild(this._menu.element().node())},u.prototype.exit=function(e,n){this._titleRect.target(null),this._icon.target(null),this._menu.target(null),this._text.target(null),this._container.target(null),this.content()&&this.content().target(null),t.prototype.exit.apply(this,arguments)},u.prototype.intersection=function(e,t){var n=[],r=this._icon.intersection(e,t,this._pos);r&&n.push({i:r,d:this.distance(r,t)});var i=this._titleRect.intersection(e,t);i&&n.push({i:i,d:this.distance(i,t)});var s=this._container.intersection(e,t);s&&n.push({i:s,d:this.distance(s,t)});var o=null;return n.forEach(function(e){if(o===null||o.d>e.d)o=e}),o&&o.i?o.i:null},u.prototype.click=function(e,t){console.log("Clicked: "+e.id)},u}),function(e,t){typeof define=="function"&&define.amd?define("common/ResizeSurface.js",["d3","./Surface","css!./ResizeSurface"],t):e.common_ResizeSurface=t(e.d3,e.common_Surface)}(this,function(e,t){function n(){t.call(this),this.handleWidth=8,this.handles=[{loc:"NW"},{loc:"N"},{loc:"NE"},{loc:"E"},{loc:"SE"},{loc:"S"},{loc:"SW"},{loc:"W"}];var n=this;this.dispatch=e.dispatch("sizestart","size","sizeend"),this.drag=e.behavior.drag().origin(function(e){return e}).on("dragstart",function(t){n.dispatch.sizestart(n,t.loc),n.allowResize()&&(e.event.sourceEvent.stopPropagation(),n._dragHandlePos={x:t.x,y:t.y},n._dragStartPos=n.pos(),n._dragStartSize=n.size(),n._prevPosSize={x:n._dragStartPos.x,y:n._dragStartPos.y,width:n._dragStartSize.width,height:n._dragStartSize.height},n._textPosSize=n._text.getBBox(!0),n._iconPosSize=n._icon.getBBox(!0),n.showContent(!1))}).on("drag",function(t){if(n.allowResize()){e.event.sourceEvent.stopPropagation();var r=e.event.x-n._dragHandlePos.x,i=e.event.y-n._dragHandlePos.y,s={x:0,y:0,w:0,h:0};switch(t.loc){case"NW":s.x=r/2,s.w=-r;case"N":s.y=i/2,s.h=-i;break;case"NE":s.y=i/2,s.h=-i;case"E":s.x=r/2,s.w=r;break;case"SE":s.x=r/2,s.w=r;case"S":s.y=i/2,s.h=i;break;case"SW":s.y=i/2,s.h=i;case"W":s.x=r/2,s.w=-r}var o={x:n._dragStartPos.x+s.x,y:n._dragStartPos.y+s.y,width:n._dragStartSize.width+s.w,height:n._dragStartSize.height+s.h};o.width<n._iconPosSize.width*2+n._textPosSize.width&&(o.x=n._prevPosSize.x,o.width=n._prevPosSize.width),o.height<n._textPosSize.height+48&&(o.y=n._prevPosSize.y,o.height=n._prevPosSize.height),n.pos({x:o.x,y:o.y},!1,!1).size({width:o.width,height:o.height}).render().getBBox(!0),n.dispatch.size(n,t.loc),n._prevPosSize=o}}).on("dragend",function(t){n.allowResize()&&(e.event.sourceEvent.stopPropagation(),n.showContent(!0).render(),n._container.getBBox(!0),n._titleRect.getBBox(!0),n.dispatch.sizeend(n,t.loc))})}return n.prototype=Object.create(t.prototype),n.prototype.constructor=n,n.prototype._class+=" common_ResizeSurface",n.prototype.publish("allowResize",!0,"boolean","Sets if surface can be resized",null,{tags:["Private","Shared"]}),n.prototype.move=function(e){var n=t.prototype.move.apply(this,arguments);return this.updateHandles(this._domNode,this._element),n},n.prototype.update=function(e,n){t.prototype.update.apply(this,arguments),this.updateHandles(e,n)},n.prototype.updateHandles=function(t,n){var r=this._parentElement.selectAll("rect").data(this.handles,function(e){return e.loc});r.enter().append("rect").attr("class",function(e){return"resize"+e.loc}).call(this.drag);var i=this._pos.x+this._container._pos.x-this._container.width()/2,s=this._pos.y+this._titleRect._pos.y-this._titleRect.height()/2,o=this._pos.x+this._container._pos.x+this._container.width()/2,u=this._pos.y+this._container._pos.y+this._container.height()/2,a=o-i,f=u-s,l=this;r.each(function(t){switch(t.loc){case"NW":t.x=i-l.handleWidth/2,t.y=s-l.handleWidth/2,t.width=l.handleWidth,t.height=l.handleWidth;break;case"N":t.x=i+l.handleWidth/2,t.y=s-l.handleWidth/2,t.width=a-l.handleWidth,t.height=l.handleWidth;break;case"NE":t.x=o-l.handleWidth/2,t.y=s-l.handleWidth/2,t.width=l.handleWidth,t.height=l.handleWidth;break;case"E":t.x=o-l.handleWidth/2,t.y=s+l.handleWidth/2,t.width=l.handleWidth,t.height=f-l.handleWidth;break;case"SE":t.x=o-l.handleWidth/2,t.y=u-l.handleWidth/2,t.width=l.handleWidth,t.height=l.handleWidth;break;case"S":t.x=i+l.handleWidth/2,t.y=u-l.handleWidth/2,t.width=a-l.handleWidth,t.height=l.handleWidth;break;case"SW":t.x=i-l.handleWidth/2,t.y=u-l.handleWidth/2,t.width=l.handleWidth,t.height=l.handleWidth;break;case"W":t.x=i-l.handleWidth/2,t.y=s+l.handleWidth/2,t.width=l.handleWidth,t.height=f-l.handleWidth}e.select(this).attr("x",t.x).attr("y",t.y).attr("width",t.width).attr("height",t.height)})},n}),function(e,t){typeof define=="function"&&define.amd?define("common/SVGZoomWidget.js",["d3","../common/SVGWidget","../common/Icon","css!./SVGZoomWidget"],t):e.common_SVGZoomWidget=t(e.d3,e.common_SVGWidget,e.common_Icon)}(this,function(e,t,n){function r(e){t.call(this)}return r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.prototype._class+=" common_SVGZoomWidget",r.prototype.publish("zoomToolbar",!0,"boolean","Show Zoom Toolbar"),r.prototype.publish("zoomDuration",250,"number","Transition Duration"),r.prototype.zoomTo=function(e,t,n){e=e||this._zoom.translate(),t=t||this._zoom.scale(),n=n===undefined?this.zoomDuration():0,this._zoomElement.transition().duration(n).call(this._zoom.translate(e).scale(t).event)},r.prototype.zoomToFit=function(e){var t=this._renderElement.node().getBBox();if(t.width&&t.height){var n=t.x+t.width/2,r=t.y+t.height/2,i=t.width,s=t.height,o=this.width(),u=this.height(),a=1/Math.max(i/o,s/u),f=[o/2-a*n,u/2-a*r];this.zoomTo(f,a,e)}},r.prototype.enter=function(n,r){t.prototype.enter.apply(this,arguments),this._zoomElement=r.append("g"),this._zoomGrab=this._zoomElement.append("rect").attr("class","background"),this._zoomG=this._zoomElement.append("g"),this._renderElement=this._zoomG.append("g");var i=this;this._zoom=e.behavior.zoom().scaleExtent([.05,20]).on("zoom",function(){i._zoomG.attr("transform","translate("+e.event.translate+")scale("+e.event.scale+")")}),this._zoomElement.call(this._zoom)},r.prototype.update=function(e,r){t.prototype.update.apply(this,arguments),this._zoomGrab.attr("width",this.width()).attr("height",this.height());var i=this,s=r.selectAll(".toolbar").data(this.zoomToolbar()?["dummy"]:[]),o=24,u=14;s.enter().append("g").attr("class","toolbar").each(function(e){i._buttonToFit=(new n).target(this).faChar("").shape("square").diameter(o).paddingPercent((1-u/o)*100).on("click",function(){i.zoomToFit()}),i._buttonPlus=(new n).target(this).faChar("").shape("square").diameter(o).paddingPercent((1-u/o)*100).on("click",function(){i.zoomTo(null,i._zoom.scale()*1.2)}),i._buttonMinus=(new n).target(this).faChar("").shape("square").diameter(o).paddingPercent((1-u/o)*100).on("click",function(){i.zoomTo(null,i._zoom.scale()/1.2)}),i._buttonLast=i._buttonMinus}),this.zoomToolbar()&&(this._buttonToFit.x(this.width()-o/2-4).y(o/2+4).render(),this._buttonPlus.x(this.width()-o/2-4).y(this._buttonToFit.y()+4+o).render(),this._buttonMinus.x(this.width()-o/2-4).y(this._buttonPlus.y()+o).render()),s.exit().each(function(){i._buttonToFit.target(null).render(),delete i._buttonToFit}).remove()},r.prototype.exit=function(e,n){t.prototype.exit.apply(this,arguments)},r}),function(e,t){typeof define=="function"&&define.amd?define("common/WidgetArray.js",["./Widget"],t):e.common_WidgetArray=t(e.common_Widget)}(this,function(e){function t(){e.call(this)}return t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.prototype._class+=" common_WidgetArray",t.prototype.publish("content",[],"widgetArray","Widget Array"),t.prototype.target=function(e){e||(this.content_reset(),this.exit())},t});